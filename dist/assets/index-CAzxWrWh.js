import{r as R,a as gi,u as ha,N as Rr,O as pi,L as Dt,b as Cn,d as yi,e as es,c as Js,g as wi,B as bi,f as Ni,h as qe,i as nr,R as Ci}from"./vendor-BVoAfGRL.js";import{R as ua,P as Ai,a as Ei,C as vi,T as fa,B as Si,X as ji,Y as Ii,b as kr}from"./charts-DvgJKZuN.js";import{f as xa,p as ge,a as ye,b as yn,i as As,s as Ti,e as _i,d as Mi,g as Di,h as Oi,j as Lr,k as Ri,l as Br,m as ki,n as Pr}from"./utils-DFn8dfxa.js";function Li(c,h){for(var d=0;d<h.length;d++){const x=h[d];if(typeof x!="string"&&!Array.isArray(x)){for(const g in x)if(g!=="default"&&!(g in c)){const f=Object.getOwnPropertyDescriptor(x,g);f&&Object.defineProperty(c,g,f.get?f:{enumerable:!0,get:()=>x[g]})}}}return Object.freeze(Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}))}(function(){const h=document.createElement("link").relList;if(h&&h.supports&&h.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))x(g);new MutationObserver(g=>{for(const f of g)if(f.type==="childList")for(const N of f.addedNodes)N.tagName==="LINK"&&N.rel==="modulepreload"&&x(N)}).observe(document,{childList:!0,subtree:!0});function d(g){const f={};return g.integrity&&(f.integrity=g.integrity),g.referrerPolicy&&(f.referrerPolicy=g.referrerPolicy),g.crossOrigin==="use-credentials"?f.credentials="include":g.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function x(g){if(g.ep)return;g.ep=!0;const f=d(g);fetch(g.href,f)}})();var ma={exports:{}},An={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bi=R,Pi=Symbol.for("react.element"),Fi=Symbol.for("react.fragment"),Ui=Object.prototype.hasOwnProperty,Hi=Bi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,zi={key:!0,ref:!0,__self:!0,__source:!0};function ga(c,h,d){var x,g={},f=null,N=null;d!==void 0&&(f=""+d),h.key!==void 0&&(f=""+h.key),h.ref!==void 0&&(N=h.ref);for(x in h)Ui.call(h,x)&&!zi.hasOwnProperty(x)&&(g[x]=h[x]);if(c&&c.defaultProps)for(x in h=c.defaultProps,h)g[x]===void 0&&(g[x]=h[x]);return{$$typeof:Pi,type:c,key:f,ref:N,props:g,_owner:Hi.current}}An.Fragment=Fi;An.jsx=ga;An.jsxs=ga;ma.exports=An;var n=ma.exports,Jn={},Fr=gi;Jn.createRoot=Fr.createRoot,Jn.hydrateRoot=Fr.hydrateRoot;const Vi="./api";class Gi{constructor(h){this.baseUrl=h}getHeaders(){const h={"Content-Type":"application/json"},d=localStorage.getItem("foxy_token");return d&&(h.Authorization=`Bearer ${d}`),h}async request(h,d={}){const x=`${this.baseUrl}${h}`,g={...d,headers:{...this.getHeaders(),...d.headers}};try{const f=await fetch(x,g),N=await f.json();if(!f.ok)throw new Error(N.error||"API request failed");return N}catch(f){throw console.error("API Error:",f),f}}get(h){return this.request(h,{method:"GET"})}post(h,d){return this.request(h,{method:"POST",body:JSON.stringify(d)})}put(h,d){return this.request(h,{method:"PUT",body:JSON.stringify(d)})}delete(h){return this.request(h,{method:"DELETE"})}async upload(h,d){const x=`${this.baseUrl}${h}`,g={},f=localStorage.getItem("foxy_token");f&&(g.Authorization=`Bearer ${f}`);try{return await(await fetch(x,{method:"POST",headers:g,body:d})).json()}catch(N){throw console.error("Upload Error:",N),N}}}const we=new Gi(Vi),Oe={getAll:(c={})=>{const h=new URLSearchParams(c).toString();return we.get(`/assets${h?`?${h}`:""}`)},getById:c=>we.get(`/assets/${c}`),create:c=>we.post("/assets",c),update:(c,h)=>we.put(`/assets/${c}`,h),delete:c=>we.delete(`/assets/${c}`),checkout:(c,h)=>we.post(`/assets/${c}/checkout`,h),checkin:(c,h)=>we.post(`/assets/${c}/checkin`,h),bulkCheckout:c=>we.post("/assets/bulk-checkout",c),uploadPhoto:(c,h)=>we.upload(`/assets/${c}/photos`,h),getCategories:()=>we.get("/assets/categories"),search:c=>we.get(`/assets/search?q=${encodeURIComponent(c)}`),getUsers:()=>we.get("/users"),getKits:()=>we.get("/kits"),getKit:c=>we.get(`/kits/${c}`),createKit:c=>we.post("/kits",c),updateKit:(c,h)=>we.put(`/kits/${c}`,h),deleteKit:c=>we.delete(`/kits/${c}`),getReservations:()=>we.get("/reservations"),createReservation:c=>we.post("/reservations",c),approveReservation:c=>we.post(`/reservations/${c}/approve`),rejectReservation:(c,h)=>we.post(`/reservations/${c}/reject`,h),cancelReservation:c=>we.delete(`/reservations/${c}`),getAuditLog:(c={})=>{const h=new URLSearchParams(c).toString();return we.get(`/audit${h?`?${h}`:""}`)}},rr={getAll:(c={})=>{const h=new URLSearchParams(c).toString();return we.get(`/transactions${h?`?${h}`:""}`)},getByAsset:c=>we.get(`/transactions/asset/${c}`)},Ls={getAll:()=>we.get("/users"),create:c=>we.post("/users",c),update:(c,h)=>we.put(`/users/${c}`,h),delete:c=>we.delete(`/users/${c}`),getBorrowers:()=>we.get("/users/borrowers")},pn={getAll:(c={})=>{const h=new URLSearchParams(c).toString();return we.get(`/requests${h?`?${h}`:""}`)},create:c=>we.post("/requests",c),approve:(c,h)=>we.post(`/requests/${c}/approve`,h),reject:(c,h)=>we.post(`/requests/${c}/reject`,h)},Kn={getSchedule:()=>we.get("/maintenance/schedule"),getIssues:()=>we.get("/maintenance/issues"),createIssue:c=>we.post("/maintenance/issues",c),updateIssue:(c,h)=>we.put(`/maintenance/issues/${c}`,h),scheduleTask:c=>we.post("/maintenance/schedule",c),completeTask:(c,h)=>we.post(`/maintenance/schedule/${c}/complete`,h)},pa={getDashboard:()=>we.get("/stats/dashboard"),getReports:(c={})=>{const h=new URLSearchParams(c).toString();return we.get(`/stats/reports${h?`?${h}`:""}`)}},ya=R.createContext(null);function Wi({children:c}){const[h,d]=R.useState(null),[x,g]=R.useState(!0);R.useEffect(()=>{f()},[]);const f=async()=>{try{const p=localStorage.getItem("foxy_user");if(p){const A=JSON.parse(p);(await we.get("/auth/verify")).success?d(A):(localStorage.removeItem("foxy_user"),localStorage.removeItem("foxy_token"))}}catch{localStorage.removeItem("foxy_user"),localStorage.removeItem("foxy_token")}finally{g(!1)}},N=async(p,A)=>{try{const S=await we.post("/auth/login",{username:p,password:A});return S.success?(d(S.user),localStorage.setItem("foxy_user",JSON.stringify(S.user)),localStorage.setItem("foxy_token",S.token),{success:!0}):{success:!1,error:S.error||"Login failed"}}catch{return{success:!1,error:"Login failed. Please try again."}}},M=()=>{d(null),localStorage.removeItem("foxy_user"),localStorage.removeItem("foxy_token")},j=()=>(h==null?void 0:h.role)==="admin";return n.jsx(ya.Provider,{value:{user:h,login:N,logout:M,loading:x,isAdmin:j},children:c})}function as(){const c=R.useContext(ya);if(!c)throw new Error("useAuth must be used within an AuthProvider");return c}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Yi={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xi=c=>c.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),le=(c,h)=>{const d=R.forwardRef(({color:x="currentColor",size:g=24,strokeWidth:f=2,absoluteStrokeWidth:N,className:M="",children:j,...p},A)=>R.createElement("svg",{ref:A,...Yi,width:g,height:g,stroke:x,strokeWidth:N?Number(f)*24/Number(g):f,className:["lucide",`lucide-${Xi(c)}`,M].join(" "),...p},[...h.map(([S,F])=>R.createElement(S,F)),...Array.isArray(j)?j:[j]]));return d.displayName=`${c}`,d};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qi=le("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const En=le("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=le("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zi=le("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=le("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=le("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $n=le("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=le("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=le("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=le("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=le("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=le("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=le("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=le("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sn=le("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qi=le("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ki=le("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ji=le("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $i=le("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=le("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=le("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=le("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=le("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=le("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const so=le("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=le("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=le("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=le("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=le("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const no=le("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=le("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=le("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=le("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=le("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=le("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=le("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=le("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=le("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=le("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=le("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=le("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lo=le("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=le("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cr=le("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=le("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=le("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=le("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ho=le("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=le("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=le("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jn=le("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=le("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=le("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=le("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fo=le("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=le("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xo=le("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=le("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=le("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const In=le("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=le("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mo=le("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=le("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=le("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=le("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),_a=R.createContext(null);function go({children:c}){const[h,d]=R.useState([]),x=R.useCallback((j,p="info",A=4e3)=>{const S=Date.now();d(F=>[...F,{id:S,message:j,type:p}]),A>0&&setTimeout(()=>{d(F=>F.filter(Q=>Q.id!==S))},A)},[]),g=R.useCallback(j=>{d(p=>p.filter(A=>A.id!==j))},[]),f={success:j=>x(j,"success"),error:j=>x(j,"error"),warning:j=>x(j,"warning"),info:j=>x(j,"info")},N=j=>{switch(j){case"success":return n.jsx(Ct,{className:"w-5 h-5"});case"error":return n.jsx(En,{className:"w-5 h-5"});case"warning":return n.jsx(xs,{className:"w-5 h-5"});default:return n.jsx(ro,{className:"w-5 h-5"})}},M=j=>{switch(j){case"success":return"bg-green-600 text-white";case"error":return"bg-red-600 text-white";case"warning":return"bg-yellow-500 text-black";default:return"bg-blue-600 text-white"}};return n.jsxs(_a.Provider,{value:f,children:[c,n.jsx("div",{className:"fixed bottom-4 right-4 z-50 flex flex-col gap-2",children:h.map(j=>n.jsxs("div",{className:`flex items-center gap-3 px-4 py-3 rounded-lg shadow-2xl animate-slide-in ${M(j.type)}`,children:[N(j.type),n.jsx("span",{className:"font-medium",children:j.message}),n.jsx("button",{onClick:()=>g(j.id),className:"ml-2 opacity-70 hover:opacity-100 transition-opacity",children:n.jsx(it,{className:"w-4 h-4"})})]},j.id))})]})}function $e(){const c=R.useContext(_a);if(!c)throw new Error("useToast must be used within a ToastProvider");return c}const po=[{name:"Dashboard",href:"/",icon:ao,roles:"all"},{name:"Equipment",href:"/assets",icon:Ee,roles:"all"},{name:"Equipment Status",href:"/status",icon:qi,roles:"manager"},{name:"Kits",href:"/kits",icon:er,roles:"manager"},{name:"Calendar",href:"/calendar",icon:Nt,roles:"all"},{name:"QR Scanner",href:"/scanner",icon:jn,roles:"manager"},{name:"Check Out",href:"/checkout",icon:ms,roles:"manager"},{name:"Check In",href:"/checkin",icon:Fs,roles:"manager"},{name:"Crew Checkout",href:"/crew-checkout",icon:mo,roles:"manager"},{name:"Requests",href:"/requests",icon:Ca,roles:"all"},{name:"Maintenance",href:"/maintenance",icon:Es,roles:"manager"},{name:"Reports",href:"/reports",icon:Aa,roles:"manager"},{name:"Analytics",href:"/analytics",icon:$n,roles:"manager"},{name:"Audit Log",href:"/audit-log",icon:or,roles:"manager"},{name:"Users",href:"/users",icon:hr,roles:"admin"},{name:"Settings",href:"/settings",icon:Ia,roles:"all"}];function yo(){const[c,h]=R.useState(!1),[d,x]=R.useState(!1),{user:g,logout:f,isAdmin:N}=as(),M=ha();R.useEffect(()=>{h(!1)},[M.pathname]);const j=po.filter(p=>{const A=(g==null?void 0:g.role)||"team_member";return p.roles==="all"?!0:p.roles==="admin"?A==="admin":p.roles==="manager"?A==="admin"||A==="equipment_manager":!1});return n.jsxs("div",{className:"min-h-screen bg-neofox-darker",children:[c&&n.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>h(!1)}),n.jsxs("aside",{className:`fixed top-0 left-0 z-50 h-full w-64 bg-neofox-dark border-r border-neofox-gray transform transition-transform duration-200 ease-in-out lg:translate-x-0 ${c?"translate-x-0":"-translate-x-full"}`,children:[n.jsxs("div",{className:"flex items-center justify-between h-16 px-6 border-b border-neofox-gray",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-8 h-8 bg-neofox-yellow rounded-lg flex items-center justify-center",children:n.jsx(Ee,{className:"w-5 h-5 text-black"})}),n.jsx("span",{className:"text-xl font-bold text-neofox-yellow",children:"FOXY"})]}),n.jsx("button",{onClick:()=>h(!1),className:"lg:hidden text-gray-400 hover:text-white",children:n.jsx(it,{className:"w-5 h-5"})})]}),n.jsxs("nav",{className:"p-4 space-y-1 overflow-y-auto h-[calc(100%-4rem)]",children:[j.map(p=>n.jsxs(Rr,{to:p.href,className:({isActive:A})=>`nav-link ${A?"active":""}`,children:[n.jsx(p.icon,{className:"w-5 h-5"}),n.jsx("span",{children:p.name})]},p.name)),n.jsx("div",{className:"pt-4 mt-4 border-t border-neofox-gray",children:n.jsxs("button",{onClick:f,className:"nav-link w-full text-red-400 hover:text-red-300 hover:bg-red-500/10",children:[n.jsx(ms,{className:"w-5 h-5"}),n.jsx("span",{children:"Sign Out"})]})})]})]}),n.jsxs("div",{className:"lg:pl-64",children:[n.jsx("header",{className:"sticky top-0 z-30 h-16 bg-neofox-dark/95 backdrop-blur border-b border-neofox-gray",children:n.jsxs("div",{className:"flex items-center justify-between h-full px-4 lg:px-6",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("button",{onClick:()=>h(!0),className:"lg:hidden text-gray-400 hover:text-white",children:n.jsx(lo,{className:"w-6 h-6"})}),n.jsxs("div",{className:"hidden sm:flex items-center gap-2 bg-neofox-darker rounded-lg px-3 py-2 w-64",children:[n.jsx(Ft,{className:"w-4 h-4 text-gray-500"}),n.jsx("input",{type:"text",placeholder:"Search equipment...",className:"bg-transparent border-none outline-none text-sm w-full text-white placeholder-gray-500"})]})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("button",{className:"relative p-2 text-gray-400 hover:text-white rounded-lg hover:bg-neofox-gray transition-colors",children:[n.jsx(ba,{className:"w-5 h-5"}),n.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-neofox-yellow rounded-full"})]}),n.jsxs("div",{className:"relative",children:[n.jsxs("button",{onClick:()=>x(!d),className:"flex items-center gap-2 p-2 rounded-lg hover:bg-neofox-gray transition-colors",children:[n.jsx("div",{className:"w-8 h-8 bg-neofox-yellow/20 rounded-full flex items-center justify-center",children:n.jsx($i,{className:"w-5 h-5 text-neofox-yellow"})}),n.jsx("span",{className:"hidden sm:block text-sm font-medium",children:g==null?void 0:g.username}),n.jsx(Sn,{className:"w-4 h-4 text-gray-400"})]}),d&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>x(!1)}),n.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-neofox-dark border border-neofox-gray rounded-lg shadow-xl z-20",children:[n.jsxs("div",{className:"p-3 border-b border-neofox-gray",children:[n.jsx("p",{className:"font-medium",children:g==null?void 0:g.username}),n.jsx("p",{className:"text-sm text-gray-400",children:g==null?void 0:g.email}),n.jsx("span",{className:"inline-block mt-1 px-2 py-0.5 bg-neofox-yellow/20 text-neofox-yellow text-xs rounded-full",children:g==null?void 0:g.role})]}),n.jsxs("div",{className:"p-2",children:[n.jsxs(Rr,{to:"/settings",className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-300 hover:bg-neofox-gray rounded-lg",onClick:()=>x(!1),children:[n.jsx(Ia,{className:"w-4 h-4"}),"Settings"]}),n.jsxs("button",{onClick:()=>{x(!1),f()},className:"flex items-center gap-2 w-full px-3 py-2 text-sm text-red-400 hover:bg-red-500/10 rounded-lg",children:[n.jsx(ms,{className:"w-4 h-4"}),"Sign Out"]})]})]})]})]})]})]})}),n.jsx("main",{className:"p-4 lg:p-6",children:n.jsx(pi,{})})]})]})}function wo(){const[c,h]=R.useState(""),[d,x]=R.useState(""),[g,f]=R.useState(!1),[N,M]=R.useState(!1),{login:j}=as(),p=$e(),A=async S=>{if(S.preventDefault(),!c||!d){p.error("Please enter username and password");return}M(!0);try{const F=await j(c,d);F.success||p.error(F.error)}catch{p.error("Login failed. Please try again.")}finally{M(!1)}};return n.jsx("div",{className:"min-h-screen bg-neofox-darker flex items-center justify-center p-4",children:n.jsxs("div",{className:"w-full max-w-md",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-neofox-yellow rounded-2xl mb-4",children:n.jsx(Ee,{className:"w-8 h-8 text-black"})}),n.jsx("h1",{className:"text-3xl font-bold text-neofox-yellow",children:"FOXY"}),n.jsx("p",{className:"text-gray-400 mt-2",children:"NeoFox Media Inventory"})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h2",{className:"text-xl font-semibold text-center",children:"Sign In"})}),n.jsx("div",{className:"card-body",children:n.jsxs("form",{onSubmit:A,className:"space-y-5",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-300 mb-2",children:"Username"}),n.jsx("input",{id:"username",type:"text",value:c,onChange:S=>h(S.target.value),className:"input-field",placeholder:"Enter your username",autoComplete:"username",autoFocus:!0})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{id:"password",type:g?"text":"password",value:d,onChange:S=>x(S.target.value),className:"input-field pr-10",placeholder:"Enter your password",autoComplete:"current-password"}),n.jsx("button",{type:"button",onClick:()=>f(!g),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white",children:g?n.jsx(ar,{className:"w-5 h-5"}):n.jsx(Ps,{className:"w-5 h-5"})})]})]}),n.jsx("button",{type:"submit",disabled:N,className:"btn-primary w-full flex items-center justify-center gap-2",children:N?n.jsxs(n.Fragment,{children:[n.jsx(Ye,{className:"w-5 h-5 animate-spin"}),"Signing in..."]}):"Sign In"})]})})]}),n.jsx("p",{className:"text-center text-sm text-gray-500 mt-6",children:"Contact your admin if you need access"})]})})}const mn=["#FFD700","#4CAF50","#2196F3","#FF5722","#9C27B0","#00BCD4"];function gn({title:c,value:h,icon:d,color:x,subtext:g,link:f}){const N=n.jsxs("div",{className:`stat-card group ${f?"cursor-pointer":""}`,children:[n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-400 mb-1",children:c}),n.jsx("p",{className:"text-3xl font-bold",children:h}),g&&n.jsx("p",{className:"text-sm text-gray-500 mt-1",children:g})]}),n.jsx("div",{className:`p-3 rounded-xl ${x}`,children:n.jsx(d,{className:"w-6 h-6"})})]}),f&&n.jsxs("div",{className:"mt-4 flex items-center gap-1 text-sm text-neofox-yellow opacity-0 group-hover:opacity-100 transition-opacity",children:["View all ",n.jsx(wa,{className:"w-4 h-4"})]})]});return f?n.jsx(Dt,{to:f,children:N}):N}function bo({transactions:c}){return c!=null&&c.length?n.jsx("div",{className:"space-y-3",children:c.slice(0,5).map((h,d)=>n.jsxs("div",{className:"flex items-center gap-4 p-3 bg-neofox-darker rounded-lg",children:[n.jsx("div",{className:`p-2 rounded-lg ${h.transaction_type==="checkout"?"bg-yellow-500/20 text-yellow-400":"bg-green-500/20 text-green-400"}`,children:h.transaction_type==="checkout"?n.jsx(ns,{className:"w-4 h-4"}):n.jsx(Ct,{className:"w-4 h-4"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium truncate",children:h.asset_name||h.asset_id}),n.jsxs("p",{className:"text-sm text-gray-400",children:[h.transaction_type==="checkout"?"Checked out by":"Returned by"," ",h.borrower_name]})]}),n.jsx("div",{className:"text-right text-sm text-gray-500",children:xa(ge(h.transaction_date),{addSuffix:!0})})]},d))}):n.jsx("div",{className:"text-center py-8 text-gray-500",children:"No recent activity"})}function No({items:c}){return c!=null&&c.length?n.jsx("div",{className:"space-y-3",children:c.map((h,d)=>n.jsxs(Dt,{to:`/assets/${h.asset_id}`,className:"flex items-center gap-4 p-3 bg-red-500/10 border border-red-500/30 rounded-lg hover:bg-red-500/20 transition-colors",children:[n.jsx("div",{className:"p-2 rounded-lg bg-red-500/20 text-red-400",children:n.jsx(xs,{className:"w-4 h-4"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium truncate",children:h.asset_name}),n.jsxs("p",{className:"text-sm text-gray-400",children:[n.jsx(Rt,{className:"w-3 h-3 inline mr-1"}),h.current_borrower]})]}),n.jsx("div",{className:"text-right",children:n.jsxs("p",{className:"text-sm text-red-400 font-medium",children:[xa(ge(h.expected_return_date))," overdue"]})})]},d))}):n.jsxs("div",{className:"text-center py-8 text-gray-500",children:[n.jsx(Ct,{className:"w-12 h-12 mx-auto mb-2 text-green-500/50"}),n.jsx("p",{children:"No overdue items"})]})}function Co(){const[c,h]=R.useState(null),[d,x]=R.useState(!0),g=$e();R.useEffect(()=>{f()},[]);const f=async()=>{try{const p=await pa.getDashboard();h(p)}catch{g.error("Failed to load dashboard")}finally{x(!1)}};if(d)return n.jsx("div",{className:"space-y-6",children:n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(p=>n.jsxs("div",{className:"card p-6",children:[n.jsx("div",{className:"skeleton h-4 w-24 mb-3"}),n.jsx("div",{className:"skeleton h-8 w-16"})]},p))})});const N=(c==null?void 0:c.categoryBreakdown)||[],M=(c==null?void 0:c.recentTransactions)||[],j=(c==null?void 0:c.overdueItems)||[];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Dashboard"}),n.jsx("p",{className:"text-gray-400",children:"Welcome back! Here's your inventory overview."})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(Dt,{to:"/checkout",className:"btn-primary",children:"Quick Checkout"}),n.jsx(Dt,{to:"/scanner",className:"btn-secondary",children:"Scan QR"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[n.jsx(gn,{title:"Total Equipment",value:(c==null?void 0:c.totalAssets)||0,icon:Ee,color:"bg-blue-500/20 text-blue-400",link:"/assets"}),n.jsx(gn,{title:"Available",value:(c==null?void 0:c.available)||0,icon:Ct,color:"bg-green-500/20 text-green-400",subtext:`${Math.round((c==null?void 0:c.available)/(c==null?void 0:c.totalAssets)*100)||0}% of total`}),n.jsx(gn,{title:"Checked Out",value:(c==null?void 0:c.checkedOut)||0,icon:ns,color:"bg-yellow-500/20 text-yellow-400",link:"/reports"}),n.jsx(gn,{title:"Overdue",value:(c==null?void 0:c.overdue)||0,icon:xs,color:"bg-red-500/20 text-red-400"})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"card lg:col-span-1",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"font-semibold",children:"Equipment by Category"})}),n.jsxs("div",{className:"card-body",children:[N.length>0?n.jsx(ua,{width:"100%",height:250,children:n.jsxs(Ai,{children:[n.jsx(Ei,{data:N,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"count",nameKey:"category",children:N.map((p,A)=>n.jsx(vi,{fill:mn[A%mn.length]},p.category))}),n.jsx(fa,{contentStyle:{backgroundColor:"#1a1a1a",border:"1px solid #333",borderRadius:"8px"}})]})}):n.jsx("div",{className:"h-[250px] flex items-center justify-center text-gray-500",children:"No data available"}),n.jsx("div",{className:"grid grid-cols-2 gap-2 mt-4",children:N.slice(0,6).map((p,A)=>n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:mn[A%mn.length]}}),n.jsx("span",{className:"text-gray-400 truncate",children:p.category}),n.jsx("span",{className:"ml-auto font-medium",children:p.count})]},p.category))})]})]}),n.jsxs("div",{className:"card lg:col-span-2",children:[n.jsxs("div",{className:"card-header flex items-center justify-between",children:[n.jsx("h3",{className:"font-semibold",children:"Recent Activity"}),n.jsxs(Dt,{to:"/reports",className:"text-sm text-neofox-yellow hover:underline flex items-center gap-1",children:["View all ",n.jsx(wa,{className:"w-4 h-4"})]})]}),n.jsx("div",{className:"card-body",children:n.jsx(bo,{transactions:M})})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"card-header flex items-center justify-between",children:[n.jsxs("h3",{className:"font-semibold text-red-400",children:[n.jsx(xs,{className:"w-5 h-5 inline mr-2"}),"Overdue Equipment"]}),j.length>0&&n.jsxs("span",{className:"bg-red-500/20 text-red-400 px-2 py-0.5 rounded-full text-sm",children:[j.length," items"]})]}),n.jsx("div",{className:"card-body",children:n.jsx(No,{items:j})})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"font-semibold",children:"Quick Actions"})}),n.jsxs("div",{className:"card-body grid grid-cols-2 gap-4",children:[n.jsxs(Dt,{to:"/assets/add",className:"p-4 bg-neofox-darker rounded-lg hover:bg-neofox-gray transition-colors text-center",children:[n.jsx(Ee,{className:"w-8 h-8 mx-auto mb-2 text-neofox-yellow"}),n.jsx("p",{className:"font-medium",children:"Add Equipment"})]}),n.jsxs(Dt,{to:"/crew-checkout",className:"p-4 bg-neofox-darker rounded-lg hover:bg-neofox-gray transition-colors text-center",children:[n.jsx(Rt,{className:"w-8 h-8 mx-auto mb-2 text-blue-400"}),n.jsx("p",{className:"font-medium",children:"Crew Checkout"})]}),n.jsxs(Dt,{to:"/maintenance",className:"p-4 bg-neofox-darker rounded-lg hover:bg-neofox-gray transition-colors text-center",children:[n.jsx(Es,{className:"w-8 h-8 mx-auto mb-2 text-orange-400"}),n.jsx("p",{className:"font-medium",children:"Maintenance"})]}),n.jsxs(Dt,{to:"/reports",className:"p-4 bg-neofox-darker rounded-lg hover:bg-neofox-gray transition-colors text-center",children:[n.jsx(Ta,{className:"w-8 h-8 mx-auto mb-2 text-green-400"}),n.jsx("p",{className:"font-medium",children:"View Reports"})]})]})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"font-semibold",children:"Equipment Status Summary"})}),n.jsxs("div",{className:"card-body",children:[n.jsxs("div",{className:"flex gap-4 mb-4",children:[n.jsxs("div",{className:"flex-1 bg-green-500/20 rounded-lg p-4 border border-green-500/30",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Ct,{className:"w-5 h-5 text-green-400"}),n.jsx("span",{className:"text-green-400 font-medium",children:"Available"})]}),n.jsx("p",{className:"text-2xl font-bold",children:(c==null?void 0:c.available)||0})]}),n.jsxs("div",{className:"flex-1 bg-yellow-500/20 rounded-lg p-4 border border-yellow-500/30",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(ns,{className:"w-5 h-5 text-yellow-400"}),n.jsx("span",{className:"text-yellow-400 font-medium",children:"Checked Out"})]}),n.jsx("p",{className:"text-2xl font-bold",children:(c==null?void 0:c.checkedOut)||0})]}),n.jsxs("div",{className:"flex-1 bg-orange-500/20 rounded-lg p-4 border border-orange-500/30",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Es,{className:"w-5 h-5 text-orange-400"}),n.jsx("span",{className:"text-orange-400 font-medium",children:"Maintenance"})]}),n.jsx("p",{className:"text-2xl font-bold",children:(c==null?void 0:c.maintenance)||0})]}),n.jsxs("div",{className:"flex-1 bg-red-500/20 rounded-lg p-4 border border-red-500/30",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(xs,{className:"w-5 h-5 text-red-400"}),n.jsx("span",{className:"text-red-400 font-medium",children:"Lost"})]}),n.jsx("p",{className:"text-2xl font-bold",children:(c==null?void 0:c.lost)||0})]})]}),n.jsxs("div",{className:"h-3 bg-neofox-darker rounded-full overflow-hidden flex",children:[n.jsx("div",{className:"bg-green-500 h-full",style:{width:`${(c==null?void 0:c.available)/(c==null?void 0:c.totalAssets)*100}%`}}),n.jsx("div",{className:"bg-yellow-500 h-full",style:{width:`${(c==null?void 0:c.checkedOut)/(c==null?void 0:c.totalAssets)*100}%`}}),n.jsx("div",{className:"bg-orange-500 h-full",style:{width:`${(c==null?void 0:c.maintenance)/(c==null?void 0:c.totalAssets)*100}%`}}),n.jsx("div",{className:"bg-red-500 h-full",style:{width:`${(c==null?void 0:c.lost)/(c==null?void 0:c.totalAssets)*100}%`}})]})]})]})]})}const wn={Camera:Gt,Audio:cr,Lighting:lr,Lens:Gt,Storage:ir,Monitor:Gt,Tripod:Ee,Cables:Ee,Other:Ee,default:Ee},Ur={available:{label:"Available",class:"badge-available",icon:Ct},checked_out:{label:"Checked Out",class:"badge-checked-out",icon:ns},maintenance:{label:"Maintenance",class:"badge-maintenance",icon:Es},lost:{label:"Lost",class:"badge-lost",icon:xs}};function Ma({status:c}){const h=Ur[c]||Ur.available,d=h.icon;return n.jsxs("span",{className:`badge ${h.class} flex items-center gap-1`,children:[n.jsx(d,{className:"w-3 h-3"}),h.label]})}function Ao({asset:c,onView:h,onEdit:d,onDelete:x}){const[g,f]=R.useState(!1),N=wn[c.category]||wn.default;return n.jsxs("div",{className:"card group hover:border-neofox-yellow/30 transition-all duration-300",children:[n.jsxs("div",{className:"relative aspect-video bg-neofox-darker rounded-t-xl overflow-hidden",children:[c.photo?n.jsx("img",{src:c.photo,alt:c.asset_name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(N,{className:"w-16 h-16 text-neofox-gray"})}),n.jsx("div",{className:"absolute top-3 left-3",children:n.jsx(Ma,{status:c.status})}),n.jsx("div",{className:"absolute top-3 right-3",children:n.jsxs("div",{className:"relative",children:[n.jsx("button",{onClick:()=>f(!g),className:"p-2 bg-black/50 rounded-lg text-white hover:bg-black/70 transition-colors backdrop-blur-sm",children:n.jsx(co,{className:"w-4 h-4"})}),g&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>f(!1)}),n.jsxs("div",{className:"absolute right-0 mt-2 w-40 bg-neofox-dark border border-neofox-gray rounded-lg shadow-xl z-20 overflow-hidden",children:[n.jsxs("button",{onClick:()=>{f(!1),h(c)},className:"flex items-center gap-2 w-full px-4 py-2.5 text-sm hover:bg-neofox-gray transition-colors",children:[n.jsx(Ps,{className:"w-4 h-4"})," View Details"]}),n.jsxs("button",{onClick:()=>{f(!1),d(c)},className:"flex items-center gap-2 w-full px-4 py-2.5 text-sm hover:bg-neofox-gray transition-colors",children:[n.jsx(en,{className:"w-4 h-4"})," Edit"]}),n.jsxs("button",{onClick:()=>{f(!1),x(c)},className:"flex items-center gap-2 w-full px-4 py-2.5 text-sm text-red-400 hover:bg-red-500/10 transition-colors",children:[n.jsx(gs,{className:"w-4 h-4"})," Delete"]})]})]})]})})]}),n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:"flex items-start justify-between mb-2",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-neofox-yellow font-mono tracking-wide",children:c.asset_id}),n.jsx("h3",{className:"font-semibold mt-1 line-clamp-1",children:c.asset_name})]}),n.jsx("span",{className:"text-xs text-gray-500 bg-neofox-darker px-2 py-1 rounded-full",children:c.category})]}),c.current_borrower&&n.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:[n.jsx("span",{className:"text-yellow-400",children:"With:"})," ",c.current_borrower]}),c.serial_number&&n.jsxs("p",{className:"text-xs text-gray-500 mt-1 font-mono",children:["S/N: ",c.serial_number]})]})]})}function Eo({asset:c,onView:h,onEdit:d,onDelete:x,selected:g,onSelect:f}){const N=wn[c.category]||wn.default;return n.jsxs("tr",{className:"group",children:[n.jsx("td",{className:"px-4 py-3",children:n.jsx("input",{type:"checkbox",checked:g,onChange:M=>f(M.target.checked),className:"w-4 h-4 rounded border-neofox-gray bg-neofox-darker text-neofox-yellow focus:ring-neofox-yellow"})}),n.jsx("td",{className:"px-4 py-3",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-lg bg-neofox-darker flex items-center justify-center overflow-hidden flex-shrink-0",children:c.photo?n.jsx("img",{src:c.photo,alt:"",className:"w-full h-full object-cover"}):n.jsx(N,{className:"w-5 h-5 text-gray-500"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium group-hover:text-neofox-yellow transition-colors",children:c.asset_name}),n.jsx("p",{className:"text-xs text-neofox-yellow font-mono",children:c.asset_id})]})]})}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-400",children:c.category}),n.jsx("td",{className:"px-4 py-3",children:n.jsx(Ma,{status:c.status})}),n.jsx("td",{className:"px-4 py-3 text-sm",children:c.current_borrower||n.jsx("span",{className:"text-gray-500",children:""})}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-400 font-mono",children:c.serial_number||n.jsx("span",{className:"text-gray-500",children:""})}),n.jsx("td",{className:"px-4 py-3",children:n.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[n.jsx("button",{onClick:()=>h(c),className:"p-2 hover:bg-neofox-gray rounded-lg transition-colors",title:"View",children:n.jsx(Ps,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>d(c),className:"p-2 hover:bg-neofox-gray rounded-lg transition-colors",title:"Edit",children:n.jsx(en,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>x(c),className:"p-2 hover:bg-red-500/20 text-red-400 rounded-lg transition-colors",title:"Delete",children:n.jsx(gs,{className:"w-4 h-4"})})]})})]})}function vo(){const[c,h]=R.useState([]),[d,x]=R.useState(!0),[g,f]=R.useState(""),[N,M]=R.useState(""),[j,p]=R.useState(""),[A,S]=R.useState("grid"),[F,Q]=R.useState(new Set),[B,U]=R.useState(!1),[z,se]=R.useState(!1),[X,W]=R.useState(null);Cn();const Y=$e(),{isAdmin:D}=as();R.useEffect(()=>{v()},[]);const v=async()=>{try{x(!0);const re=await Oe.getAll();h(re.assets||[])}catch{Y.error("Failed to load equipment")}finally{x(!1)}},T=R.useMemo(()=>{const re=new Set(c.map(ue=>ue.category));return Array.from(re).sort()},[c]),I=R.useMemo(()=>c.filter(re=>{var et;const ue=!g||re.asset_name.toLowerCase().includes(g.toLowerCase())||re.asset_id.toLowerCase().includes(g.toLowerCase())||((et=re.serial_number)==null?void 0:et.toLowerCase().includes(g.toLowerCase())),de=!N||re.category===N,je=!j||re.status===j;return ue&&de&&je}),[c,g,N,j]),P=re=>{window.location.href=`/assets/${re.asset_id}`},Z=re=>{window.location.href=`/assets/${re.asset_id}?edit=true`},q=re=>{W(re),se(!0)},J=async()=>{if(X)try{await Oe.delete(X.asset_id),h(re=>re.filter(ue=>ue.asset_id!==X.asset_id)),Y.success("Equipment deleted successfully")}catch{Y.error("Failed to delete equipment")}finally{se(!1),W(null)}},ae=()=>{F.size===I.length?Q(new Set):Q(new Set(I.map(re=>re.asset_id)))},Ce=()=>{f(""),M(""),p("")},H=g||N||j;return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Equipment"}),n.jsxs("p",{className:"text-gray-400",children:[I.length," of ",c.length," items",H&&" (filtered)"]})]}),n.jsx("div",{className:"flex items-center gap-3",children:n.jsxs(Dt,{to:"/assets/add",className:"btn-primary flex items-center gap-2",children:[n.jsx($t,{className:"w-5 h-5"}),"Add Equipment"]})})]}),n.jsx("div",{className:"card p-4",children:n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(Ft,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),n.jsx("input",{type:"text",placeholder:"Search by name, ID, or serial number...",value:g,onChange:re=>f(re.target.value),className:"input-field pl-10"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("select",{value:N,onChange:re=>M(re.target.value),className:"select-field w-40",children:[n.jsx("option",{value:"",children:"All Categories"}),T.map(re=>n.jsx("option",{value:re,children:re},re))]}),n.jsxs("select",{value:j,onChange:re=>p(re.target.value),className:"select-field w-40",children:[n.jsx("option",{value:"",children:"All Status"}),n.jsx("option",{value:"available",children:"Available"}),n.jsx("option",{value:"checked_out",children:"Checked Out"}),n.jsx("option",{value:"maintenance",children:"Maintenance"}),n.jsx("option",{value:"lost",children:"Lost"})]}),H&&n.jsx("button",{onClick:Ce,className:"p-2 text-gray-400 hover:text-white hover:bg-neofox-gray rounded-lg transition-colors",title:"Clear filters",children:n.jsx(it,{className:"w-5 h-5"})}),n.jsxs("div",{className:"flex items-center bg-neofox-darker rounded-lg p-1",children:[n.jsx("button",{onClick:()=>S("grid"),className:`p-2 rounded-lg transition-colors ${A==="grid"?"bg-neofox-gray text-white":"text-gray-500 hover:text-white"}`,children:n.jsx(no,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>S("list"),className:`p-2 rounded-lg transition-colors ${A==="list"?"bg-neofox-gray text-white":"text-gray-500 hover:text-white"}`,children:n.jsx(io,{className:"w-5 h-5"})})]})]})]})}),d?n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[1,2,3,4,5,6,7,8].map(re=>n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"skeleton aspect-video rounded-t-xl"}),n.jsxs("div",{className:"p-4 space-y-3",children:[n.jsx("div",{className:"skeleton h-4 w-20"}),n.jsx("div",{className:"skeleton h-5 w-3/4"})]})]},re))}):I.length===0?n.jsxs("div",{className:"card p-12 text-center",children:[n.jsx(Ee,{className:"w-16 h-16 mx-auto text-gray-600 mb-4"}),n.jsx("h3",{className:"text-lg font-medium mb-2",children:"No equipment found"}),n.jsx("p",{className:"text-gray-500 mb-4",children:H?"Try adjusting your filters":"Add your first piece of equipment to get started"}),H?n.jsx("button",{onClick:Ce,className:"btn-secondary",children:"Clear Filters"}):n.jsxs(Dt,{to:"/assets/add",className:"btn-primary inline-flex items-center gap-2",children:[n.jsx($t,{className:"w-5 h-5"}),"Add Equipment"]})]}):A==="grid"?n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:I.map(re=>n.jsx(Ao,{asset:re,onView:P,onEdit:Z,onDelete:q},re.asset_id))}):n.jsx("div",{className:"card overflow-hidden",children:n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"data-table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"w-12",children:n.jsx("input",{type:"checkbox",checked:F.size===I.length&&I.length>0,onChange:ae,className:"w-4 h-4 rounded border-neofox-gray bg-neofox-darker text-neofox-yellow focus:ring-neofox-yellow"})}),n.jsx("th",{children:"Equipment"}),n.jsx("th",{children:"Category"}),n.jsx("th",{children:"Status"}),n.jsx("th",{children:"Current Holder"}),n.jsx("th",{children:"Serial Number"}),n.jsx("th",{className:"w-32",children:"Actions"})]})}),n.jsx("tbody",{children:I.map(re=>n.jsx(Eo,{asset:re,onView:P,onEdit:Z,onDelete:q,selected:F.has(re.asset_id),onSelect:ue=>{const de=new Set(F);ue?de.add(re.asset_id):de.delete(re.asset_id),Q(de)}},re.asset_id))})]})})}),z&&n.jsx("div",{className:"modal-overlay",onClick:()=>se(!1),children:n.jsx("div",{className:"modal-content max-w-md",onClick:re=>re.stopPropagation(),children:n.jsxs("div",{className:"p-6",children:[n.jsx("div",{className:"w-12 h-12 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(gs,{className:"w-6 h-6 text-red-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-center mb-2",children:"Delete Equipment?"}),n.jsxs("p",{className:"text-gray-400 text-center mb-6",children:["Are you sure you want to delete ",n.jsx("strong",{children:X==null?void 0:X.asset_name}),"? This action cannot be undone."]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>se(!1),className:"btn-secondary flex-1",children:"Cancel"}),n.jsx("button",{onClick:J,className:"btn-danger flex-1",children:"Delete"})]})]})})})]})}const Hr={Camera:Gt,Audio:cr,Lighting:lr,Lens:Gt,Storage:ir,default:Ee},zr={available:{label:"Available",class:"bg-green-500/20 text-green-400 border-green-500/30"},checked_out:{label:"Checked Out",class:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30"},maintenance:{label:"Maintenance",class:"bg-orange-500/20 text-orange-400 border-orange-500/30"},lost:{label:"Lost",class:"bg-red-500/20 text-red-400 border-red-500/30"}},Vr={excellent:{label:"Excellent",class:"text-green-400"},good:{label:"Good",class:"text-blue-400"},needs_repair:{label:"Needs Repair",class:"text-orange-400"}};function So(){const{id:c}=yi(),h=es(),[d]=Cn(),[x,g]=R.useState(null),[f,N]=R.useState([]),[M,j]=R.useState(!0),[p,A]=R.useState(d.get("edit")==="true"),[S,F]=R.useState({}),[Q,B]=R.useState(!1),U=$e();R.useEffect(()=>{z(),se()},[c]);const z=async()=>{try{const I=await Oe.getById(c);g(I.asset),F(I.asset)}catch{U.error("Failed to load equipment details"),h("/assets")}finally{j(!1)}},se=async()=>{try{const I=await rr.getByAsset(c);N(I.transactions||[])}catch{console.error("Failed to load transactions")}},X=async()=>{B(!0);try{await Oe.update(c,S),g(S),A(!1),U.success("Equipment updated successfully")}catch{U.error("Failed to update equipment")}finally{B(!1)}},W=async()=>{if(confirm("Are you sure you want to delete this equipment?"))try{await Oe.delete(c),U.success("Equipment deleted"),h("/assets")}catch{U.error("Failed to delete equipment")}},Y=()=>{const I=window.open("","_blank");I.document.write(`
      <html>
        <head>
          <title>QR Code - ${x.asset_id}</title>
          <style>
            body { display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; font-family: Arial, sans-serif; }
            .qr-container { text-align: center; }
            .qr-container img { width: 200px; height: 200px; }
            .qr-container p { margin: 10px 0; font-weight: bold; }
          </style>
        </head>
        <body>
          <div class="qr-container">
            <img src="${x.qr_code}" alt="QR Code" />
            <p>${x.asset_id}</p>
            <p style="font-weight: normal; font-size: 12px;">${x.asset_name}</p>
          </div>
          <script>window.onload = function() { window.print(); }<\/script>
        </body>
      </html>
    `),I.document.close()};if(M)return n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"skeleton h-8 w-48"}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"lg:col-span-2 card",children:[n.jsx("div",{className:"skeleton aspect-video rounded-t-xl"}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsx("div",{className:"skeleton h-6 w-3/4"}),n.jsx("div",{className:"skeleton h-4 w-1/2"})]})]}),n.jsxs("div",{className:"card p-6 space-y-4",children:[n.jsx("div",{className:"skeleton h-6 w-1/2"}),n.jsx("div",{className:"skeleton h-4 w-full"}),n.jsx("div",{className:"skeleton h-4 w-full"})]})]})]});if(!x)return null;const D=Hr[x.category]||Hr.default,v=zr[x.status]||zr.available,T=Vr[x.condition_status]||Vr.excellent;return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("button",{onClick:()=>h("/assets"),className:"p-2 hover:bg-neofox-gray rounded-lg transition-colors",children:n.jsx(vs,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-neofox-yellow font-mono",children:x.asset_id}),n.jsx("h1",{className:"text-2xl font-bold",children:x.asset_name})]})]}),n.jsx("div",{className:"flex items-center gap-3",children:p?n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>A(!1),className:"btn-secondary",children:[n.jsx(it,{className:"w-4 h-4 mr-2"}),"Cancel"]}),n.jsxs("button",{onClick:X,disabled:Q,className:"btn-primary",children:[n.jsx(ja,{className:"w-4 h-4 mr-2"}),Q?"Saving...":"Save Changes"]})]}):n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:Y,className:"btn-secondary",children:[n.jsx(jn,{className:"w-4 h-4 mr-2"}),"Print QR"]}),n.jsxs("button",{onClick:()=>A(!0),className:"btn-secondary",children:[n.jsx(en,{className:"w-4 h-4 mr-2"}),"Edit"]}),n.jsxs("button",{onClick:W,className:"btn-danger",children:[n.jsx(gs,{className:"w-4 h-4 mr-2"}),"Delete"]})]})})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[n.jsx("div",{className:"card overflow-hidden",children:n.jsx("div",{className:"aspect-video bg-neofox-darker flex items-center justify-center",children:x.photo?n.jsx("img",{src:x.photo,alt:x.asset_name,className:"w-full h-full object-contain"}):n.jsxs("div",{className:"text-center",children:[n.jsx(D,{className:"w-24 h-24 text-neofox-gray mx-auto"}),n.jsx("p",{className:"text-gray-500 mt-2",children:"No photo available"})]})})}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"font-semibold",children:"Equipment Details"})}),n.jsx("div",{className:"card-body",children:p?n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Name"}),n.jsx("input",{type:"text",value:S.asset_name||"",onChange:I=>F({...S,asset_name:I.target.value}),className:"input-field"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Category"}),n.jsxs("select",{value:S.category||"",onChange:I=>F({...S,category:I.target.value}),className:"select-field",children:[n.jsx("option",{value:"Camera",children:"Camera"}),n.jsx("option",{value:"Lens",children:"Lens"}),n.jsx("option",{value:"Audio",children:"Audio"}),n.jsx("option",{value:"Lighting",children:"Lighting"}),n.jsx("option",{value:"Storage",children:"Storage"}),n.jsx("option",{value:"Monitor",children:"Monitor"}),n.jsx("option",{value:"Tripod",children:"Tripod"}),n.jsx("option",{value:"Cables",children:"Cables"}),n.jsx("option",{value:"Other",children:"Other"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Serial Number"}),n.jsx("input",{type:"text",value:S.serial_number||"",onChange:I=>F({...S,serial_number:I.target.value}),className:"input-field"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Condition"}),n.jsxs("select",{value:S.condition_status||"excellent",onChange:I=>F({...S,condition_status:I.target.value}),className:"select-field",children:[n.jsx("option",{value:"excellent",children:"Excellent"}),n.jsx("option",{value:"good",children:"Good"}),n.jsx("option",{value:"needs_repair",children:"Needs Repair"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Storage Location"}),n.jsx("input",{type:"text",value:S.storage_location||"",onChange:I=>F({...S,storage_location:I.target.value}),className:"input-field",placeholder:"e.g., Room A, Warehouse 1"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Shelf / Area"}),n.jsx("input",{type:"text",value:S.shelf||"",onChange:I=>F({...S,shelf:I.target.value}),className:"input-field",placeholder:"e.g., Shelf 3, Cabinet B"})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Description"}),n.jsx("textarea",{value:S.description||"",onChange:I=>F({...S,description:I.target.value}),rows:3,className:"input-field"})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Notes"}),n.jsx("textarea",{value:S.notes||"",onChange:I=>F({...S,notes:I.target.value}),rows:2,className:"input-field"})]})]}):n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Category"}),n.jsxs("p",{className:"font-medium flex items-center gap-2 mt-1",children:[n.jsx(D,{className:"w-4 h-4 text-neofox-yellow"}),x.category]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Serial Number"}),n.jsx("p",{className:"font-medium font-mono mt-1",children:x.serial_number||""})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Condition"}),n.jsx("p",{className:`font-medium mt-1 ${T.class}`,children:T.label})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Total Checkouts"}),n.jsx("p",{className:"font-medium mt-1",children:x.total_checkouts||0})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Storage Location"}),n.jsx("p",{className:"font-medium mt-1",children:x.storage_location||""})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Shelf / Area"}),n.jsx("p",{className:"font-medium mt-1",children:x.shelf||""})]}),x.description&&n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Description"}),n.jsx("p",{className:"mt-1",children:x.description})]}),x.notes&&n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Notes"}),n.jsx("p",{className:"mt-1 text-yellow-400",children:x.notes})]})]})})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"font-semibold",children:"Activity History"})}),n.jsx("div",{className:"card-body",children:f.length>0?n.jsx("div",{className:"space-y-3",children:f.slice(0,10).map((I,P)=>n.jsxs("div",{className:"flex items-start gap-4 p-3 bg-neofox-darker rounded-lg",children:[n.jsx("div",{className:`p-2 rounded-lg ${I.transaction_type==="checkout"?"bg-yellow-500/20 text-yellow-400":"bg-green-500/20 text-green-400"}`,children:I.transaction_type==="checkout"?n.jsx(ns,{className:"w-4 h-4"}):n.jsx(Ct,{className:"w-4 h-4"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("p",{className:"font-medium",children:[I.transaction_type==="checkout"?"Checked out to":"Returned by"," ",I.borrower_name]}),I.purpose&&n.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Purpose: ",I.purpose]}),n.jsx("p",{className:"text-sm text-gray-500 mt-1",children:ye(ge(I.transaction_date),"MMM d, yyyy h:mm a")})]})]},P))}):n.jsx("p",{className:"text-gray-500 text-center py-4",children:"No activity recorded"})})]})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"font-semibold",children:"Current Status"})}),n.jsxs("div",{className:"card-body",children:[n.jsxs("div",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-lg border ${v.class}`,children:[x.status==="available"&&n.jsx(Ct,{className:"w-5 h-5"}),x.status==="checked_out"&&n.jsx(ns,{className:"w-5 h-5"}),x.status==="maintenance"&&n.jsx(Es,{className:"w-5 h-5"}),x.status==="lost"&&n.jsx(xs,{className:"w-5 h-5"}),n.jsx("span",{className:"font-medium",children:v.label})]}),x.status==="checked_out"&&n.jsxs("div",{className:"mt-4 space-y-3",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Current Holder"}),n.jsxs("p",{className:"font-medium flex items-center gap-2 mt-1",children:[n.jsx(Rt,{className:"w-4 h-4"}),x.current_borrower]})]}),x.checkout_date&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Checked Out"}),n.jsxs("p",{className:"font-medium flex items-center gap-2 mt-1",children:[n.jsx(Nt,{className:"w-4 h-4"}),ye(ge(x.checkout_date),"MMM d, yyyy")]})]}),x.expected_return_date&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Expected Return"}),n.jsxs("p",{className:"font-medium flex items-center gap-2 mt-1",children:[n.jsx(Nt,{className:"w-4 h-4"}),ye(ge(x.expected_return_date),"MMM d, yyyy")]})]})]}),n.jsx("div",{className:"mt-4 pt-4 border-t border-neofox-gray",children:x.status==="available"?n.jsx(Dt,{to:`/checkout?asset=${x.asset_id}`,className:"btn-primary w-full text-center",children:"Check Out"}):x.status==="checked_out"?n.jsx(Dt,{to:`/checkin?asset=${x.asset_id}`,className:"btn-primary w-full text-center",children:"Check In"}):null})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"font-semibold",children:"QR Code"})}),n.jsx("div",{className:"card-body text-center",children:x.qr_code?n.jsxs(n.Fragment,{children:[n.jsx("img",{src:x.qr_code,alt:"QR Code",className:"w-40 h-40 mx-auto bg-white p-2 rounded-lg"}),n.jsxs("button",{onClick:Y,className:"btn-secondary mt-4 w-full",children:[n.jsx($s,{className:"w-4 h-4 mr-2"}),"Download / Print"]})]}):n.jsx("p",{className:"text-gray-500",children:"No QR code generated"})})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"font-semibold",children:"Quick Info"})}),n.jsxs("div",{className:"card-body space-y-3 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-500",children:"Created"}),n.jsx("span",{children:x.created_at?ye(ge(x.created_at),"MMM d, yyyy"):""})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-500",children:"Last Updated"}),n.jsx("span",{children:x.updated_at?ye(ge(x.updated_at),"MMM d, yyyy"):""})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-500",children:"Last Returned"}),n.jsx("span",{children:x.last_returned_date?ye(ge(x.last_returned_date),"MMM d, yyyy"):""})]})]})]})]})]})]})}const jo=[{value:"Camera",icon:Gt},{value:"Lens",icon:Gt},{value:"Audio",icon:cr},{value:"Lighting",icon:lr},{value:"Storage",icon:ir},{value:"Monitor",icon:Ee},{value:"Tripod",icon:Ee},{value:"Cables",icon:Ee},{value:"Other",icon:Ee}];function Io(){const c=es(),h=$e(),[d,x]=R.useState(!1),[g,f]=R.useState({asset_name:"",category:"Camera",description:"",serial_number:"",condition_status:"excellent",storage_location:"",shelf:"",notes:""}),[N,M]=R.useState([]),[j,p]=R.useState(null),A=B=>{const{name:U,value:z}=B.target;f(se=>({...se,[U]:z}))},S=B=>{const U=B.target.files[0];if(U){M([U]);const z=new FileReader;z.onloadend=()=>{p(z.result)},z.readAsDataURL(U)}},F=()=>{M([]),p(null)},Q=async B=>{if(B.preventDefault(),!g.asset_name.trim()){h.error("Please enter an equipment name");return}x(!0);try{const U=await Oe.create(g);if(N.length>0&&U.asset_id){const z=new FormData;z.append("photo",N[0]),z.append("photo_type","main"),await Oe.uploadPhoto(U.asset_id,z)}h.success("Equipment added successfully"),c(`/assets/${U.asset_id}`)}catch(U){h.error(U.message||"Failed to add equipment")}finally{x(!1)}};return n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx("button",{onClick:()=>c("/assets"),className:"p-2 hover:bg-neofox-gray rounded-lg transition-colors",children:n.jsx(vs,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Add Equipment"}),n.jsx("p",{className:"text-gray-400",children:"Add new equipment to your inventory"})]})]}),n.jsxs("form",{onSubmit:Q,className:"space-y-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"font-semibold",children:"Equipment Photo"})}),n.jsx("div",{className:"card-body",children:j?n.jsxs("div",{className:"relative inline-block",children:[n.jsx("img",{src:j,alt:"Preview",className:"w-64 h-48 object-cover rounded-lg"}),n.jsx("button",{type:"button",onClick:F,className:"absolute -top-2 -right-2 p-1 bg-red-500 rounded-full text-white hover:bg-red-600 transition-colors",children:n.jsx(it,{className:"w-4 h-4"})})]}):n.jsxs("label",{className:"flex flex-col items-center justify-center w-64 h-48 border-2 border-dashed border-neofox-gray rounded-lg cursor-pointer hover:border-neofox-yellow transition-colors",children:[n.jsx(In,{className:"w-10 h-10 text-gray-500 mb-2"}),n.jsx("span",{className:"text-sm text-gray-400",children:"Click to upload photo"}),n.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"PNG, JPG up to 10MB"}),n.jsx("input",{type:"file",accept:"image/*",onChange:S,className:"hidden"})]})})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"font-semibold",children:"Basic Information"})}),n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Equipment Name ",n.jsx("span",{className:"text-red-400",children:"*"})]}),n.jsx("input",{type:"text",name:"asset_name",value:g.asset_name,onChange:A,className:"input-field",placeholder:"e.g., Sony A7 III",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Category"}),n.jsx("select",{name:"category",value:g.category,onChange:A,className:"select-field",children:jo.map(B=>n.jsx("option",{value:B.value,children:B.value},B.value))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Serial Number"}),n.jsx("input",{type:"text",name:"serial_number",value:g.serial_number,onChange:A,className:"input-field",placeholder:"Enter serial number"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Condition"}),n.jsxs("select",{name:"condition_status",value:g.condition_status,onChange:A,className:"select-field",children:[n.jsx("option",{value:"excellent",children:"Excellent"}),n.jsx("option",{value:"good",children:"Good"}),n.jsx("option",{value:"needs_repair",children:"Needs Repair"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Storage Location"}),n.jsx("input",{type:"text",name:"storage_location",value:g.storage_location,onChange:A,className:"input-field",placeholder:"e.g., Room A, Warehouse 1"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Shelf / Area"}),n.jsx("input",{type:"text",name:"shelf",value:g.shelf,onChange:A,className:"input-field",placeholder:"e.g., Shelf 3, Cabinet B"})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Description"}),n.jsx("textarea",{name:"description",value:g.description,onChange:A,rows:3,className:"input-field",placeholder:"Optional description or specifications"})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Notes"}),n.jsx("textarea",{name:"notes",value:g.notes,onChange:A,rows:2,className:"input-field",placeholder:"Any additional notes"})]})]})})]}),n.jsxs("div",{className:"flex items-center justify-end gap-3",children:[n.jsx("button",{type:"button",onClick:()=>c("/assets"),className:"btn-secondary",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:d,className:"btn-primary flex items-center gap-2",children:d?n.jsxs(n.Fragment,{children:[n.jsx(Ye,{className:"w-5 h-5 animate-spin"}),"Adding..."]}):n.jsxs(n.Fragment,{children:[n.jsx($t,{className:"w-5 h-5"}),"Add Equipment"]})})]})]})]})}function To(){const c=es(),[h]=Cn(),d=$e(),{user:x}=as(),g=R.useRef(null),[f,N]=R.useState([]),[M,j]=R.useState([]),[p,A]=R.useState(!0),[S,F]=R.useState(!1),[Q,B]=R.useState(""),[U,z]=R.useState(null),[se,X]=R.useState(!1),[W,Y]=R.useState([]),[D,v]=R.useState([]),[T,I]=R.useState({borrower_name:"",borrower_phone:"",expected_return_date:ye(yn(new Date,7),"yyyy-MM-dd"),project:"",purpose:"",notes:""}),[P,Z]=R.useState(!0),[q,J]=R.useState(!0);R.useEffect(()=>{ae()},[]),R.useEffect(()=>{const de=h.get("asset");if(de&&f.length>0){const je=f.find(et=>et.asset_id===de);je&&je.status==="available"&&z(je)}},[h,f]);const ae=async()=>{var de;try{const[je,et]=await Promise.all([Oe.getAll({status:"available"}),Ls.getBorrowers()]);N(((de=je.assets)==null?void 0:de.filter(yt=>yt.status==="available"))||[]),j(et.borrowers||[])}catch{d.error("Failed to load data")}finally{A(!1)}},Ce=f.filter(de=>!Q||de.asset_name.toLowerCase().includes(Q.toLowerCase())||de.asset_id.toLowerCase().includes(Q.toLowerCase())),H=de=>{const je=Array.from(de.target.files);if(je.length===0)return;const et=5-W.length,yt=je.slice(0,et);Y(Be=>[...Be,...yt]),yt.forEach(Be=>{const mt=new FileReader;mt.onloadend=()=>{v(dt=>[...dt,mt.result])},mt.readAsDataURL(Be)}),g.current&&(g.current.value="")},re=de=>{Y(je=>je.filter((et,yt)=>yt!==de)),v(je=>je.filter((et,yt)=>yt!==de))},ue=async de=>{if(de.preventDefault(),!U){d.error("Please select an equipment");return}if(!T.borrower_name.trim()){d.error("Please enter borrower name");return}if(!T.expected_return_date){d.error("Please select expected return date");return}F(!0);try{const je=[];for(const yt of W){const Be=new FormData;Be.append("photo",yt),Be.append("photo_type","checkout"),Be.append("transaction_type","checkout"),Be.append("borrower_name",T.borrower_name);try{const mt=await Oe.uploadPhoto(U.asset_id,Be);mt.photo_path&&je.push(mt.photo_path)}catch(mt){console.error("Photo upload failed:",mt)}}const et=await Oe.checkout(U.asset_id,{borrower_name:T.borrower_name,expected_return_date:T.expected_return_date,project:T.project,purpose:T.purpose,notes:T.notes,photos:je});if(d.success(`${U.asset_name} checked out successfully`),P&&T.borrower_phone){const yt=T.borrower_phone.replace(/[^0-9]/g,""),Be=`Hi ${T.borrower_name},%0A%0AThe following equipment has been checked out to you:%0A%0A*${U.asset_name}*%0AID: ${U.asset_id}%0ACategory: ${U.category}%0AProject: ${T.project||"Not specified"}%0A%0AExpected Return: ${ye(new Date(T.expected_return_date),"MMMM d, yyyy")}%0APurpose: ${T.purpose||"Not specified"}%0A%0APlease take care of the equipment and return it on time.%0A%0A- NeoFox Media Equipment Team`;window.open(`https://wa.me/${yt}?text=${Be}`,"_blank")}q?c("/checkout/receipt",{state:{checkoutData:{asset:U,borrower:T.borrower_name,returnDate:T.expected_return_date,project:T.project,purpose:T.purpose,notes:T.notes,transactionId:et.transaction_id}}}):c("/assets")}catch(je){d.error(je.message||"Failed to checkout")}finally{F(!1)}};return p?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx(Ye,{className:"w-8 h-8 animate-spin text-neofox-yellow"})}):n.jsxs("div",{className:"max-w-2xl mx-auto",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx("button",{onClick:()=>c(-1),className:"p-2 hover:bg-neofox-gray rounded-lg transition-colors",children:n.jsx(vs,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Check Out Equipment"}),n.jsx("p",{className:"text-gray-400",children:"Assign equipment to a team member"})]})]}),n.jsxs("form",{onSubmit:ue,className:"space-y-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[n.jsx(Ee,{className:"w-5 h-5 text-neofox-yellow"}),"Select Equipment"]})}),n.jsx("div",{className:"card-body",children:U?n.jsxs("div",{className:"flex items-center gap-4 p-4 bg-neofox-darker rounded-lg",children:[n.jsx("div",{className:"w-16 h-16 bg-neofox-gray rounded-lg flex items-center justify-center overflow-hidden",children:U.photo?n.jsx("img",{src:U.photo,alt:"",className:"w-full h-full object-cover"}):n.jsx(Ee,{className:"w-8 h-8 text-gray-500"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium",children:U.asset_name}),n.jsx("p",{className:"text-sm text-neofox-yellow font-mono",children:U.asset_id}),n.jsx("p",{className:"text-sm text-gray-400",children:U.category})]}),n.jsx("button",{type:"button",onClick:()=>z(null),className:"p-2 hover:bg-neofox-gray rounded-lg transition-colors",children:n.jsx(it,{className:"w-5 h-5"})})]}):n.jsxs("div",{className:"relative",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Ft,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),n.jsx("input",{type:"text",placeholder:"Search equipment by name or ID...",value:Q,onChange:de=>B(de.target.value),onFocus:()=>X(!0),className:"input-field pl-10"})]}),se&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>X(!1)}),n.jsx("div",{className:"absolute z-20 w-full mt-2 bg-neofox-dark border border-neofox-gray rounded-lg shadow-xl max-h-64 overflow-y-auto",children:Ce.length>0?Ce.slice(0,10).map(de=>n.jsxs("button",{type:"button",onClick:()=>{z(de),X(!1),B("")},className:"flex items-center gap-3 w-full p-3 hover:bg-neofox-gray transition-colors",children:[n.jsx("div",{className:"w-10 h-10 bg-neofox-darker rounded-lg flex items-center justify-center",children:n.jsx(Ee,{className:"w-5 h-5 text-gray-500"})}),n.jsxs("div",{className:"text-left",children:[n.jsx("p",{className:"font-medium",children:de.asset_name}),n.jsxs("p",{className:"text-sm text-gray-400",children:[de.asset_id,"  ",de.category]})]}),n.jsx(Ct,{className:"w-5 h-5 text-green-400 ml-auto"})]},de.asset_id)):n.jsx("div",{className:"p-4 text-center text-gray-500",children:"No available equipment found"})})]})]})})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[n.jsx(Rt,{className:"w-5 h-5 text-neofox-yellow"}),"Borrower Information"]})}),n.jsxs("div",{className:"card-body space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Borrower Name ",n.jsx("span",{className:"text-red-400",children:"*"})]}),n.jsx("input",{type:"text",value:T.borrower_name,onChange:de=>I({...T,borrower_name:de.target.value}),className:"input-field",placeholder:"Enter name or select from team",list:"borrowers",required:!0}),n.jsx("datalist",{id:"borrowers",children:M.map(de=>n.jsx("option",{value:de},de))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Phone Number (WhatsApp)"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"tel",value:T.borrower_phone,onChange:de=>I({...T,borrower_phone:de.target.value}),className:"input-field flex-1",placeholder:"+91 98765 43210"}),n.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-neofox-darker rounded-lg cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:P,onChange:de=>Z(de.target.checked),className:"w-4 h-4 rounded border-neofox-gray text-green-500 focus:ring-green-500"}),n.jsx(Sa,{className:"w-4 h-4 text-green-400"}),n.jsx("span",{className:"text-sm text-gray-300",children:"Send"})]})]}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Equipment list will be sent via WhatsApp to this number"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Expected Return Date ",n.jsx("span",{className:"text-red-400",children:"*"})]}),n.jsx("input",{type:"date",value:T.expected_return_date,onChange:de=>I({...T,expected_return_date:de.target.value}),min:ye(new Date,"yyyy-MM-dd"),className:"input-field",required:!0})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[n.jsx(Na,{className:"w-4 h-4 inline mr-1"}),"Project Name ",n.jsx("span",{className:"text-red-400",children:"*"})]}),n.jsx("input",{type:"text",value:T.project,onChange:de=>I({...T,project:de.target.value}),className:"input-field",placeholder:"e.g., Wedding - Sharma, Corporate Video - TechCorp",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Purpose / Use"}),n.jsx("input",{type:"text",value:T.purpose,onChange:de=>I({...T,purpose:de.target.value}),className:"input-field",placeholder:"e.g., Main camera, B-roll, Audio recording"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Notes"}),n.jsx("textarea",{value:T.notes,onChange:de=>I({...T,notes:de.target.value}),rows:2,className:"input-field",placeholder:"Any additional notes"})]}),n.jsx("div",{className:"pt-2 border-t border-neofox-gray",children:n.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:q,onChange:de=>J(de.target.checked),className:"w-4 h-4 rounded border-neofox-gray text-neofox-yellow focus:ring-neofox-yellow"}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Generate Receipt"}),n.jsx("p",{className:"text-xs text-gray-500",children:"Create a printable PDF receipt with signatures"})]})]})})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[n.jsx(Gt,{className:"w-5 h-5 text-neofox-yellow"}),"Equipment Photos (QC)"]})}),n.jsxs("div",{className:"card-body",children:[n.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Take photos of the equipment condition before checkout for quality control records."}),D.length>0&&n.jsx("div",{className:"flex flex-wrap gap-3 mb-4",children:D.map((de,je)=>n.jsxs("div",{className:"relative group",children:[n.jsx("img",{src:de,alt:`Photo ${je+1}`,className:"w-24 h-24 object-cover rounded-lg border border-neofox-gray"}),n.jsx("button",{type:"button",onClick:()=>re(je),className:"absolute -top-2 -right-2 p-1 bg-red-500 rounded-full text-white opacity-0 group-hover:opacity-100 transition-opacity",children:n.jsx(it,{className:"w-3 h-3"})})]},je))}),W.length<5&&n.jsxs("div",{children:[n.jsx("input",{ref:g,type:"file",accept:"image/*",multiple:!0,onChange:H,className:"hidden",id:"photo-upload"}),n.jsxs("label",{htmlFor:"photo-upload",className:"flex items-center justify-center gap-2 p-4 border-2 border-dashed border-neofox-gray rounded-lg cursor-pointer hover:border-neofox-yellow transition-colors",children:[n.jsx(In,{className:"w-5 h-5 text-gray-400"}),n.jsxs("span",{className:"text-gray-400",children:["Click to upload photos (",5-W.length," remaining)"]})]})]}),n.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Photos are emailed to admin and stored for damage tracking purposes."})]})]}),n.jsxs("div",{className:"flex items-center justify-between gap-4",children:[n.jsxs("button",{type:"button",onClick:()=>c("/scanner"),className:"btn-secondary flex items-center gap-2",children:[n.jsx(jn,{className:"w-5 h-5"}),"Scan QR Code"]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("button",{type:"button",onClick:()=>c(-1),className:"btn-secondary",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:S||!U,className:"btn-primary flex items-center gap-2",children:S?n.jsxs(n.Fragment,{children:[n.jsx(Ye,{className:"w-5 h-5 animate-spin"}),"Processing..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ms,{className:"w-5 h-5"}),"Check Out"]})})]})]})]})]})}function _o(){const c=es(),[h]=Cn(),d=$e(),x=R.useRef(null),[g,f]=R.useState([]),[N,M]=R.useState(!0),[j,p]=R.useState(!1),[A,S]=R.useState(""),[F,Q]=R.useState(null),[B,U]=R.useState(!1),[z,se]=R.useState([]),[X,W]=R.useState([]),[Y,D]=R.useState({condition_on_return:"excellent",notes:""});R.useEffect(()=>{v()},[]),R.useEffect(()=>{const J=h.get("asset");if(J&&g.length>0){const ae=g.find(Ce=>Ce.asset_id===J);ae&&ae.status==="checked_out"&&Q(ae)}},[h,g]);const v=async()=>{var J;try{const ae=await Oe.getAll({status:"checked_out"});f(((J=ae.assets)==null?void 0:J.filter(Ce=>Ce.status==="checked_out"))||[])}catch{d.error("Failed to load data")}finally{M(!1)}},T=g.filter(J=>{var ae;return!A||J.asset_name.toLowerCase().includes(A.toLowerCase())||J.asset_id.toLowerCase().includes(A.toLowerCase())||((ae=J.current_borrower)==null?void 0:ae.toLowerCase().includes(A.toLowerCase()))}),I=J=>{const ae=Array.from(J.target.files);if(ae.length===0)return;const Ce=5-z.length,H=ae.slice(0,Ce);se(re=>[...re,...H]),H.forEach(re=>{const ue=new FileReader;ue.onloadend=()=>{W(de=>[...de,ue.result])},ue.readAsDataURL(re)}),x.current&&(x.current.value="")},P=J=>{se(ae=>ae.filter((Ce,H)=>H!==J)),W(ae=>ae.filter((Ce,H)=>H!==J))},Z=async J=>{if(J.preventDefault(),!F){d.error("Please select an equipment");return}p(!0);try{const ae=[];for(const Ce of z){const H=new FormData;H.append("photo",Ce),H.append("photo_type","checkin"),H.append("transaction_type","checkin"),H.append("borrower_name",F.current_borrower||"Unknown");try{const re=await Oe.uploadPhoto(F.asset_id,H);re.photo_path&&ae.push(re.photo_path)}catch(re){console.error("Photo upload failed:",re)}}await Oe.checkin(F.asset_id,{condition_on_return:Y.condition_on_return,notes:Y.notes,photos:ae}),d.success(`${F.asset_name} checked in successfully`),c("/assets")}catch(ae){d.error(ae.message||"Failed to check in")}finally{p(!1)}};if(N)return n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx(Ye,{className:"w-8 h-8 animate-spin text-neofox-yellow"})});const q=(F==null?void 0:F.expected_return_date)&&As(ge(F.expected_return_date));return n.jsxs("div",{className:"max-w-2xl mx-auto",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx("button",{onClick:()=>c(-1),className:"p-2 hover:bg-neofox-gray rounded-lg transition-colors",children:n.jsx(vs,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Check In Equipment"}),n.jsx("p",{className:"text-gray-400",children:"Return equipment to inventory"})]})]}),n.jsxs("form",{onSubmit:Z,className:"space-y-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[n.jsx(Ee,{className:"w-5 h-5 text-neofox-yellow"}),"Select Equipment"]})}),n.jsx("div",{className:"card-body",children:F?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-4 p-4 bg-neofox-darker rounded-lg",children:[n.jsx("div",{className:"w-16 h-16 bg-neofox-gray rounded-lg flex items-center justify-center",children:F.photo?n.jsx("img",{src:F.photo,alt:"",className:"w-full h-full object-cover rounded-lg"}):n.jsx(Ee,{className:"w-8 h-8 text-gray-500"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium",children:F.asset_name}),n.jsx("p",{className:"text-sm text-neofox-yellow font-mono",children:F.asset_id}),n.jsx("p",{className:"text-sm text-gray-400",children:F.category})]}),n.jsx("button",{type:"button",onClick:()=>Q(null),className:"p-2 hover:bg-neofox-gray rounded-lg transition-colors",children:n.jsx(it,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-4 bg-neofox-darker rounded-lg space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(Rt,{className:"w-4 h-4 text-gray-500"}),n.jsx("span",{className:"text-gray-400",children:"Current Holder:"}),n.jsx("span",{className:"font-medium",children:F.current_borrower})]}),F.checkout_date&&n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(Nt,{className:"w-4 h-4 text-gray-500"}),n.jsx("span",{className:"text-gray-400",children:"Checked Out:"}),n.jsx("span",{children:ye(ge(F.checkout_date),"MMM d, yyyy")})]}),F.expected_return_date&&n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(Nt,{className:"w-4 h-4 text-gray-500"}),n.jsx("span",{className:"text-gray-400",children:"Expected Return:"}),n.jsxs("span",{className:q?"text-red-400 font-medium":"",children:[ye(ge(F.expected_return_date),"MMM d, yyyy"),q&&" (Overdue)"]})]})]}),q&&n.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:[n.jsx(En,{className:"w-5 h-5 text-red-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-red-400",children:"Overdue Return"}),n.jsxs("p",{className:"text-sm text-gray-400",children:["This equipment was due back on ",ye(ge(F.expected_return_date),"MMM d, yyyy")]})]})]})]}):n.jsxs("div",{className:"relative",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Ft,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),n.jsx("input",{type:"text",placeholder:"Search by name, ID, or borrower...",value:A,onChange:J=>S(J.target.value),onFocus:()=>U(!0),className:"input-field pl-10"})]}),B&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>U(!1)}),n.jsx("div",{className:"absolute z-20 w-full mt-2 bg-neofox-dark border border-neofox-gray rounded-lg shadow-xl max-h-64 overflow-y-auto",children:T.length>0?T.slice(0,10).map(J=>n.jsxs("button",{type:"button",onClick:()=>{Q(J),U(!1),S("")},className:"flex items-center gap-3 w-full p-3 hover:bg-neofox-gray transition-colors",children:[n.jsx("div",{className:"w-10 h-10 bg-neofox-darker rounded-lg flex items-center justify-center",children:n.jsx(Ee,{className:"w-5 h-5 text-gray-500"})}),n.jsxs("div",{className:"text-left flex-1",children:[n.jsx("p",{className:"font-medium",children:J.asset_name}),n.jsxs("p",{className:"text-sm text-gray-400",children:[J.asset_id,"  With: ",J.current_borrower]})]}),J.expected_return_date&&As(ge(J.expected_return_date))&&n.jsx("span",{className:"badge badge-lost",children:"Overdue"})]},J.asset_id)):n.jsx("div",{className:"p-4 text-center text-gray-500",children:"No checked out equipment found"})})]})]})})]}),F&&n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"font-semibold",children:"Condition Assessment"})}),n.jsxs("div",{className:"card-body space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Condition on Return"}),n.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{value:"excellent",label:"Excellent",class:"border-green-500 bg-green-500/20 text-green-400"},{value:"good",label:"Good",class:"border-blue-500 bg-blue-500/20 text-blue-400"},{value:"needs_repair",label:"Needs Repair",class:"border-orange-500 bg-orange-500/20 text-orange-400"}].map(J=>n.jsx("button",{type:"button",onClick:()=>D({...Y,condition_on_return:J.value}),className:`p-3 rounded-lg border-2 transition-all ${Y.condition_on_return===J.value?J.class:"border-neofox-gray hover:border-neofox-yellow/50"}`,children:J.label},J.value))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Notes"}),n.jsx("textarea",{value:Y.notes,onChange:J=>D({...Y,notes:J.target.value}),rows:3,className:"input-field",placeholder:"Any issues, damage, or notes about the equipment"})]})]})]}),F&&n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[n.jsx(Gt,{className:"w-5 h-5 text-neofox-yellow"}),"Equipment Photos (QC)"]})}),n.jsxs("div",{className:"card-body",children:[n.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Take photos of the equipment condition on return for quality control records."}),X.length>0&&n.jsx("div",{className:"flex flex-wrap gap-3 mb-4",children:X.map((J,ae)=>n.jsxs("div",{className:"relative group",children:[n.jsx("img",{src:J,alt:`Photo ${ae+1}`,className:"w-24 h-24 object-cover rounded-lg border border-neofox-gray"}),n.jsx("button",{type:"button",onClick:()=>P(ae),className:"absolute -top-2 -right-2 p-1 bg-red-500 rounded-full text-white opacity-0 group-hover:opacity-100 transition-opacity",children:n.jsx(it,{className:"w-3 h-3"})})]},ae))}),z.length<5&&n.jsxs("div",{children:[n.jsx("input",{ref:x,type:"file",accept:"image/*",multiple:!0,onChange:I,className:"hidden",id:"photo-upload"}),n.jsxs("label",{htmlFor:"photo-upload",className:"flex items-center justify-center gap-2 p-4 border-2 border-dashed border-neofox-gray rounded-lg cursor-pointer hover:border-neofox-yellow transition-colors",children:[n.jsx(In,{className:"w-5 h-5 text-gray-400"}),n.jsxs("span",{className:"text-gray-400",children:["Click to upload photos (",5-z.length," remaining)"]})]})]}),n.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Photos are emailed to admin and stored for damage tracking purposes."})]})]}),n.jsxs("div",{className:"flex items-center justify-between gap-4",children:[n.jsxs("button",{type:"button",onClick:()=>c("/scanner"),className:"btn-secondary flex items-center gap-2",children:[n.jsx(jn,{className:"w-5 h-5"}),"Scan QR Code"]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("button",{type:"button",onClick:()=>c(-1),className:"btn-secondary",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:j||!F,className:"btn-primary flex items-center gap-2",children:j?n.jsxs(n.Fragment,{children:[n.jsx(Ye,{className:"w-5 h-5 animate-spin"}),"Processing..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Fs,{className:"w-5 h-5"}),"Check In"]})})]})]})]})]})}var oe;(function(c){c[c.QR_CODE=0]="QR_CODE",c[c.AZTEC=1]="AZTEC",c[c.CODABAR=2]="CODABAR",c[c.CODE_39=3]="CODE_39",c[c.CODE_93=4]="CODE_93",c[c.CODE_128=5]="CODE_128",c[c.DATA_MATRIX=6]="DATA_MATRIX",c[c.MAXICODE=7]="MAXICODE",c[c.ITF=8]="ITF",c[c.EAN_13=9]="EAN_13",c[c.EAN_8=10]="EAN_8",c[c.PDF_417=11]="PDF_417",c[c.RSS_14=12]="RSS_14",c[c.RSS_EXPANDED=13]="RSS_EXPANDED",c[c.UPC_A=14]="UPC_A",c[c.UPC_E=15]="UPC_E",c[c.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(oe||(oe={}));var Gr=new Map([[oe.QR_CODE,"QR_CODE"],[oe.AZTEC,"AZTEC"],[oe.CODABAR,"CODABAR"],[oe.CODE_39,"CODE_39"],[oe.CODE_93,"CODE_93"],[oe.CODE_128,"CODE_128"],[oe.DATA_MATRIX,"DATA_MATRIX"],[oe.MAXICODE,"MAXICODE"],[oe.ITF,"ITF"],[oe.EAN_13,"EAN_13"],[oe.EAN_8,"EAN_8"],[oe.PDF_417,"PDF_417"],[oe.RSS_14,"RSS_14"],[oe.RSS_EXPANDED,"RSS_EXPANDED"],[oe.UPC_A,"UPC_A"],[oe.UPC_E,"UPC_E"],[oe.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),Wr;(function(c){c[c.UNKNOWN=0]="UNKNOWN",c[c.URL=1]="URL"})(Wr||(Wr={}));function Mo(c){return Object.values(oe).includes(c)}var rs;(function(c){c[c.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",c[c.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(rs||(rs={}));var Vt=function(){function c(){}return c.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",c.SCAN_DEFAULT_FPS=2,c.DEFAULT_DISABLE_FLIP=!1,c.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,c.DEFAULT_SUPPORTED_SCAN_TYPE=[rs.SCAN_TYPE_CAMERA,rs.SCAN_TYPE_FILE],c}(),Da=function(){function c(h,d){this.format=h,this.formatName=d}return c.prototype.toString=function(){return this.formatName},c.create=function(h){if(!Gr.has(h))throw"".concat(h," not in html5QrcodeSupportedFormatsTextMap");return new c(h,Gr.get(h))},c}(),Yr=function(){function c(){}return c.createFromText=function(h){var d={text:h};return{decodedText:h,result:d}},c.createFromQrcodeResult=function(h){return{decodedText:h.text,result:h}},c}(),tr;(function(c){c[c.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",c[c.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",c[c.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(tr||(tr={}));var Oa=function(){function c(){}return c.createFrom=function(h){return{errorMessage:h,type:tr.UNKWOWN_ERROR}},c}(),Ra=function(){function c(h){this.verbose=h}return c.prototype.log=function(h){this.verbose&&console.log(h)},c.prototype.warn=function(h){this.verbose&&console.warn(h)},c.prototype.logError=function(h,d){(this.verbose||d===!0)&&console.error(h)},c.prototype.logErrors=function(h){if(h.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(h)},c}();function Jt(c){return typeof c>"u"||c===null}function Do(c,h,d){return c>d?d:c<h?h:c}var Bs=function(){function c(){}return c.codeParseError=function(h){return"QR code parse error, error = ".concat(h)},c.errorGettingUserMedia=function(h){return"Error getting userMedia, error = ".concat(h)},c.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},c.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},c.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},c.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},c.scannerPaused=function(){return"Scanner paused"},c}(),ke=function(){function c(){}return c.scanningStatus=function(){return"Scanning"},c.idleStatus=function(){return"Idle"},c.errorStatus=function(){return"Error"},c.permissionStatus=function(){return"Permission"},c.noCameraFoundErrorStatus=function(){return"No Cameras"},c.lastMatch=function(h){return"Last Match: ".concat(h)},c.codeScannerTitle=function(){return"Code Scanner"},c.cameraPermissionTitle=function(){return"Request Camera Permissions"},c.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},c.noCameraFound=function(){return"No camera found"},c.scanButtonStopScanningText=function(){return"Stop Scanning"},c.scanButtonStartScanningText=function(){return"Start Scanning"},c.torchOnButton=function(){return"Switch On Torch"},c.torchOffButton=function(){return"Switch Off Torch"},c.torchOnFailedMessage=function(){return"Failed to turn on torch"},c.torchOffFailedMessage=function(){return"Failed to turn off torch"},c.scanButtonScanningStarting=function(){return"Launching Camera..."},c.textIfCameraScanSelected=function(){return"Scan an Image File"},c.textIfFileScanSelected=function(){return"Scan using camera directly"},c.selectCamera=function(){return"Select Camera"},c.fileSelectionChooseImage=function(){return"Choose Image"},c.fileSelectionChooseAnother=function(){return"Choose Another"},c.fileSelectionNoImageSelected=function(){return"No image choosen"},c.anonymousCameraPrefix=function(){return"Anonymous Camera"},c.dragAndDropMessage=function(){return"Or drop an image to scan"},c.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},c.zoom=function(){return"zoom"},c.loadingImage=function(){return"Loading image..."},c.cameraScanAltText=function(){return"Camera based scan"},c.fileScanAltText=function(){return"Fule based scan"},c}(),Xr=function(){function c(){}return c.poweredBy=function(){return"Powered by "},c.reportIssues=function(){return"Report issues"},c}(),ka=function(){function c(){}return c.isMediaStreamConstraintsValid=function(h,d){if(typeof h!="object"){var x=typeof h;return d.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(x,"."),!0),!1}for(var g=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],f=new Set(g),N=Object.keys(h),M=0,j=N;M<j.length;M++){var p=j[M];if(f.has(p))return d.logError("".concat(p," is not supported videoConstaints."),!0),!1}return!0},c}(),sr={exports:{}};(function(c,h){(function(d,x){x(h)})(Js,function(d){function x(y){return y==null}var g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,e){y.__proto__=e}||function(y,e){for(var t in e)e.hasOwnProperty(t)&&(y[t]=e[t])};function f(y,e){g(y,e);function t(){this.constructor=y}y.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function N(y,e){var t=Object.setPrototypeOf;t?t(y,e):y.__proto__=e}function M(y,e){e===void 0&&(e=y.constructor);var t=Error.captureStackTrace;t&&t(y,e)}var j=function(y){f(e,y);function e(t){var s=this.constructor,r=y.call(this,t)||this;return Object.defineProperty(r,"name",{value:s.name,enumerable:!1}),N(r,s.prototype),M(r),r}return e}(Error);class p extends j{constructor(e=void 0){super(e),this.message=e}getKind(){return this.constructor.kind}}p.kind="Exception";class A extends p{}A.kind="ArgumentException";class S extends p{}S.kind="IllegalArgumentException";class F{constructor(e){if(this.binarizer=e,e===null)throw new S("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(e,t){return this.binarizer.getBlackRow(e,t)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(e,t,s,r){const a=this.binarizer.getLuminanceSource().crop(e,t,s,r);return new F(this.binarizer.createBinarizer(a))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new F(this.binarizer.createBinarizer(e))}rotateCounterClockwise45(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new F(this.binarizer.createBinarizer(e))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class Q extends p{static getChecksumInstance(){return new Q}}Q.kind="ChecksumException";class B{constructor(e){this.source=e}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class U{static arraycopy(e,t,s,r,a){for(;a--;)s[r++]=e[t++]}static currentTimeMillis(){return Date.now()}}class z extends p{}z.kind="IndexOutOfBoundsException";class se extends z{constructor(e=void 0,t=void 0){super(t),this.index=e,this.message=t}}se.kind="ArrayIndexOutOfBoundsException";class X{static fill(e,t){for(let s=0,r=e.length;s<r;s++)e[s]=t}static fillWithin(e,t,s,r){X.rangeCheck(e.length,t,s);for(let a=t;a<s;a++)e[a]=r}static rangeCheck(e,t,s){if(t>s)throw new S("fromIndex("+t+") > toIndex("+s+")");if(t<0)throw new se(t);if(s>e)throw new se(s)}static asList(...e){return e}static create(e,t,s){return Array.from({length:e}).map(a=>Array.from({length:t}).fill(s))}static createInt32Array(e,t,s){return Array.from({length:e}).map(a=>Int32Array.from({length:t}).fill(s))}static equals(e,t){if(!e||!t||!e.length||!t.length||e.length!==t.length)return!1;for(let s=0,r=e.length;s<r;s++)if(e[s]!==t[s])return!1;return!0}static hashCode(e){if(e===null)return 0;let t=1;for(const s of e)t=31*t+s;return t}static fillUint8Array(e,t){for(let s=0;s!==e.length;s++)e[s]=t}static copyOf(e,t){return e.slice(0,t)}static copyOfUint8Array(e,t){if(e.length<=t){const s=new Uint8Array(t);return s.set(e),s}return e.slice(0,t)}static copyOfRange(e,t,s){const r=s-t,a=new Int32Array(r);return U.arraycopy(e,t,a,0,r),a}static binarySearch(e,t,s){s===void 0&&(s=X.numberComparator);let r=0,a=e.length-1;for(;r<=a;){const i=a+r>>1,o=s(t,e[i]);if(o>0)r=i+1;else if(o<0)a=i-1;else return i}return-r-1}static numberComparator(e,t){return e-t}}class W{static numberOfTrailingZeros(e){let t;if(e===0)return 32;let s=31;return t=e<<16,t!==0&&(s-=16,e=t),t=e<<8,t!==0&&(s-=8,e=t),t=e<<4,t!==0&&(s-=4,e=t),t=e<<2,t!==0&&(s-=2,e=t),s-(e<<1>>>31)}static numberOfLeadingZeros(e){if(e===0)return 32;let t=1;return e>>>16||(t+=16,e<<=16),e>>>24||(t+=8,e<<=8),e>>>28||(t+=4,e<<=4),e>>>30||(t+=2,e<<=2),t-=e>>>31,t}static toHexString(e){return e.toString(16)}static toBinaryString(e){return String(parseInt(String(e),2))}static bitCount(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63}static truncDivision(e,t){return Math.trunc(e/t)}static parseInt(e,t=void 0){return parseInt(e,t)}}W.MIN_VALUE_32_BITS=-2147483648,W.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Y{constructor(e,t){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,t==null?this.bits=Y.makeArray(e):this.bits=t)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(e){if(e>this.bits.length*32){const t=Y.makeArray(e);U.arraycopy(this.bits,0,t,0,this.bits.length),this.bits=t}}get(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0}set(e){this.bits[Math.floor(e/32)]|=1<<(e&31)}flip(e){this.bits[Math.floor(e/32)]^=1<<(e&31)}getNextSet(e){const t=this.size;if(e>=t)return t;const s=this.bits;let r=Math.floor(e/32),a=s[r];a&=~((1<<(e&31))-1);const i=s.length;for(;a===0;){if(++r===i)return t;a=s[r]}const o=r*32+W.numberOfTrailingZeros(a);return o>t?t:o}getNextUnset(e){const t=this.size;if(e>=t)return t;const s=this.bits;let r=Math.floor(e/32),a=~s[r];a&=~((1<<(e&31))-1);const i=s.length;for(;a===0;){if(++r===i)return t;a=~s[r]}const o=r*32+W.numberOfTrailingZeros(a);return o>t?t:o}setBulk(e,t){this.bits[Math.floor(e/32)]=t}setRange(e,t){if(t<e||e<0||t>this.size)throw new S;if(t===e)return;t--;const s=Math.floor(e/32),r=Math.floor(t/32),a=this.bits;for(let i=s;i<=r;i++){const o=i>s?0:e&31,u=(2<<(i<r?31:t&31))-(1<<o);a[i]|=u}}clear(){const e=this.bits.length,t=this.bits;for(let s=0;s<e;s++)t[s]=0}isRange(e,t,s){if(t<e||e<0||t>this.size)throw new S;if(t===e)return!0;t--;const r=Math.floor(e/32),a=Math.floor(t/32),i=this.bits;for(let o=r;o<=a;o++){const l=o>r?0:e&31,m=(2<<(o<a?31:t&31))-(1<<l)&4294967295;if((i[o]&m)!==(s?m:0))return!1}return!0}appendBit(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(e,t){if(t<0||t>32)throw new S("Num bits must be between 0 and 32");this.ensureCapacity(this.size+t);for(let s=t;s>0;s--)this.appendBit((e>>s-1&1)===1)}appendBitArray(e){const t=e.size;this.ensureCapacity(this.size+t);for(let s=0;s<t;s++)this.appendBit(e.get(s))}xor(e){if(this.size!==e.size)throw new S("Sizes don't match");const t=this.bits;for(let s=0,r=t.length;s<r;s++)t[s]^=e.bits[s]}toBytes(e,t,s,r){for(let a=0;a<r;a++){let i=0;for(let o=0;o<8;o++)this.get(e)&&(i|=1<<7-o),e++;t[s+a]=i}}getBitArray(){return this.bits}reverse(){const e=new Int32Array(this.bits.length),t=Math.floor((this.size-1)/32),s=t+1,r=this.bits;for(let a=0;a<s;a++){let i=r[a];i=i>>1&1431655765|(i&1431655765)<<1,i=i>>2&858993459|(i&858993459)<<2,i=i>>4&252645135|(i&252645135)<<4,i=i>>8&16711935|(i&16711935)<<8,i=i>>16&65535|(i&65535)<<16,e[t-a]=i}if(this.size!==s*32){const a=s*32-this.size;let i=e[0]>>>a;for(let o=1;o<s;o++){const l=e[o];i|=l<<32-a,e[o-1]=i,i=l>>>a}e[s-1]=i}this.bits=e}static makeArray(e){return new Int32Array(Math.floor((e+31)/32))}equals(e){if(!(e instanceof Y))return!1;const t=e;return this.size===t.size&&X.equals(this.bits,t.bits)}hashCode(){return 31*this.size+X.hashCode(this.bits)}toString(){let e="";for(let t=0,s=this.size;t<s;t++)t&7||(e+=" "),e+=this.get(t)?"X":".";return e}clone(){return new Y(this.size,this.bits.slice())}}var D;(function(y){y[y.OTHER=0]="OTHER",y[y.PURE_BARCODE=1]="PURE_BARCODE",y[y.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",y[y.TRY_HARDER=3]="TRY_HARDER",y[y.CHARACTER_SET=4]="CHARACTER_SET",y[y.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",y[y.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",y[y.ASSUME_GS1=7]="ASSUME_GS1",y[y.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",y[y.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",y[y.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(D||(D={}));var v=D;class T extends p{static getFormatInstance(){return new T}}T.kind="FormatException";var I;(function(y){y[y.Cp437=0]="Cp437",y[y.ISO8859_1=1]="ISO8859_1",y[y.ISO8859_2=2]="ISO8859_2",y[y.ISO8859_3=3]="ISO8859_3",y[y.ISO8859_4=4]="ISO8859_4",y[y.ISO8859_5=5]="ISO8859_5",y[y.ISO8859_6=6]="ISO8859_6",y[y.ISO8859_7=7]="ISO8859_7",y[y.ISO8859_8=8]="ISO8859_8",y[y.ISO8859_9=9]="ISO8859_9",y[y.ISO8859_10=10]="ISO8859_10",y[y.ISO8859_11=11]="ISO8859_11",y[y.ISO8859_13=12]="ISO8859_13",y[y.ISO8859_14=13]="ISO8859_14",y[y.ISO8859_15=14]="ISO8859_15",y[y.ISO8859_16=15]="ISO8859_16",y[y.SJIS=16]="SJIS",y[y.Cp1250=17]="Cp1250",y[y.Cp1251=18]="Cp1251",y[y.Cp1252=19]="Cp1252",y[y.Cp1256=20]="Cp1256",y[y.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",y[y.UTF8=22]="UTF8",y[y.ASCII=23]="ASCII",y[y.Big5=24]="Big5",y[y.GB18030=25]="GB18030",y[y.EUC_KR=26]="EUC_KR"})(I||(I={}));class P{constructor(e,t,s,...r){this.valueIdentifier=e,this.name=s,typeof t=="number"?this.values=Int32Array.from([t]):this.values=t,this.otherEncodingNames=r,P.VALUE_IDENTIFIER_TO_ECI.set(e,this),P.NAME_TO_ECI.set(s,this);const a=this.values;for(let i=0,o=a.length;i!==o;i++){const l=a[i];P.VALUES_TO_ECI.set(l,this)}for(const i of r)P.NAME_TO_ECI.set(i,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(e){if(e<0||e>=900)throw new T("incorect value");const t=P.VALUES_TO_ECI.get(e);if(t===void 0)throw new T("incorect value");return t}static getCharacterSetECIByName(e){const t=P.NAME_TO_ECI.get(e);if(t===void 0)throw new T("incorect value");return t}equals(e){if(!(e instanceof P))return!1;const t=e;return this.getName()===t.getName()}}P.VALUE_IDENTIFIER_TO_ECI=new Map,P.VALUES_TO_ECI=new Map,P.NAME_TO_ECI=new Map,P.Cp437=new P(I.Cp437,Int32Array.from([0,2]),"Cp437"),P.ISO8859_1=new P(I.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),P.ISO8859_2=new P(I.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),P.ISO8859_3=new P(I.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),P.ISO8859_4=new P(I.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),P.ISO8859_5=new P(I.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),P.ISO8859_6=new P(I.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),P.ISO8859_7=new P(I.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),P.ISO8859_8=new P(I.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),P.ISO8859_9=new P(I.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),P.ISO8859_10=new P(I.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),P.ISO8859_11=new P(I.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),P.ISO8859_13=new P(I.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),P.ISO8859_14=new P(I.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),P.ISO8859_15=new P(I.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),P.ISO8859_16=new P(I.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),P.SJIS=new P(I.SJIS,20,"SJIS","Shift_JIS"),P.Cp1250=new P(I.Cp1250,21,"Cp1250","windows-1250"),P.Cp1251=new P(I.Cp1251,22,"Cp1251","windows-1251"),P.Cp1252=new P(I.Cp1252,23,"Cp1252","windows-1252"),P.Cp1256=new P(I.Cp1256,24,"Cp1256","windows-1256"),P.UnicodeBigUnmarked=new P(I.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),P.UTF8=new P(I.UTF8,26,"UTF8","UTF-8"),P.ASCII=new P(I.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),P.Big5=new P(I.Big5,28,"Big5"),P.GB18030=new P(I.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),P.EUC_KR=new P(I.EUC_KR,30,"EUC_KR","EUC-KR");class Z extends p{}Z.kind="UnsupportedOperationException";class q{static decode(e,t){const s=this.encodingName(t);return this.customDecoder?this.customDecoder(e,s):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(s)?this.decodeFallback(e,s):new TextDecoder(s).decode(e)}static shouldDecodeOnFallback(e){return!q.isBrowser()&&e==="ISO-8859-1"}static encode(e,t){const s=this.encodingName(t);return this.customEncoder?this.customEncoder(e,s):typeof TextEncoder>"u"?this.encodeFallback(e):new TextEncoder().encode(e)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(e){return typeof e=="string"?e:e.getName()}static encodingCharacterSet(e){return e instanceof P?e:P.getCharacterSetECIByName(e)}static decodeFallback(e,t){const s=this.encodingCharacterSet(t);if(q.isDecodeFallbackSupported(s)){let r="";for(let a=0,i=e.length;a<i;a++){let o=e[a].toString(16);o.length<2&&(o="0"+o),r+="%"+o}return decodeURIComponent(r)}if(s.equals(P.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new Z(`Encoding ${this.encodingName(t)} not supported by fallback.`)}static isDecodeFallbackSupported(e){return e.equals(P.UTF8)||e.equals(P.ISO8859_1)||e.equals(P.ASCII)}static encodeFallback(e){const s=btoa(unescape(encodeURIComponent(e))).split(""),r=[];for(let a=0;a<s.length;a++)r.push(s[a].charCodeAt(0));return new Uint8Array(r)}}class J{static castAsNonUtf8Char(e,t=null){const s=t?t.getName():this.ISO88591;return q.decode(new Uint8Array([e]),s)}static guessEncoding(e,t){if(t!=null&&t.get(v.CHARACTER_SET)!==void 0)return t.get(v.CHARACTER_SET).toString();const s=e.length;let r=!0,a=!0,i=!0,o=0,l=0,u=0,m=0,w=0,b=0,E=0,_=0,O=0,k=0,G=0;const ee=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191;for(let te=0;te<s&&(r||a||i);te++){const $=e[te]&255;i&&(o>0?$&128?o--:i=!1:$&128&&($&64?(o++,$&32?(o++,$&16?(o++,$&8?i=!1:m++):u++):l++):i=!1)),r&&($>127&&$<160?r=!1:$>159&&($<192||$===215||$===247)&&G++),a&&(w>0?$<64||$===127||$>252?a=!1:w--:$===128||$===160||$>239?a=!1:$>160&&$<224?(b++,_=0,E++,E>O&&(O=E)):$>127?(w++,E=0,_++,_>k&&(k=_)):(E=0,_=0))}return i&&o>0&&(i=!1),a&&w>0&&(a=!1),i&&(ee||l+u+m>0)?J.UTF8:a&&(J.ASSUME_SHIFT_JIS||O>=3||k>=3)?J.SHIFT_JIS:r&&a?O===2&&b===2||G*10>=s?J.SHIFT_JIS:J.ISO88591:r?J.ISO88591:a?J.SHIFT_JIS:i?J.UTF8:J.PLATFORM_DEFAULT_ENCODING}static format(e,...t){let s=-1;function r(i,o,l,u,m,w){if(i==="%%")return"%";if(t[++s]===void 0)return;i=u?parseInt(u.substr(1)):void 0;let b=m?parseInt(m.substr(1)):void 0,E;switch(w){case"s":E=t[s];break;case"c":E=t[s][0];break;case"f":E=parseFloat(t[s]).toFixed(i);break;case"p":E=parseFloat(t[s]).toPrecision(i);break;case"e":E=parseFloat(t[s]).toExponential(i);break;case"x":E=parseInt(t[s]).toString(b||16);break;case"d":E=parseFloat(parseInt(t[s],b||10).toPrecision(i)).toFixed(0);break}E=typeof E=="object"?JSON.stringify(E):(+E).toString(b);let _=parseInt(l),O=l&&l[0]+""=="0"?"0":" ";for(;E.length<_;)E=o!==void 0?E+O:O+E;return E}let a=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(a,r)}static getBytes(e,t){return q.encode(e,t)}static getCharCode(e,t=0){return e.charCodeAt(t)}static getCharAt(e){return String.fromCharCode(e)}}J.SHIFT_JIS=P.SJIS.getName(),J.GB2312="GB2312",J.ISO88591=P.ISO8859_1.getName(),J.EUC_JP="EUC_JP",J.UTF8=P.UTF8.getName(),J.PLATFORM_DEFAULT_ENCODING=J.UTF8,J.ASSUME_SHIFT_JIS=!1;class ae{constructor(e=""){this.value=e}enableDecoding(e){return this.encoding=e,this}append(e){return typeof e=="string"?this.value+=e.toString():this.encoding?this.value+=J.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this}appendChars(e,t,s){for(let r=t;t<t+s;r++)this.append(e[r]);return this}length(){return this.value.length}charAt(e){return this.value.charAt(e)}deleteCharAt(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)}setCharAt(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+1)}substring(e,t){return this.value.substring(e,t)}setLengthToZero(){this.value=""}toString(){return this.value}insert(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+t.length)}}class Ce{constructor(e,t,s,r){if(this.width=e,this.height=t,this.rowSize=s,this.bits=r,t==null&&(t=e),this.height=t,e<1||t<1)throw new S("Both dimensions must be greater than 0");s==null&&(s=Math.floor((e+31)/32)),this.rowSize=s,r==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(e){const t=e.length,s=e[0].length,r=new Ce(s,t);for(let a=0;a<t;a++){const i=e[a];for(let o=0;o<s;o++)i[o]&&r.set(o,a)}return r}static parseFromString(e,t,s){if(e===null)throw new S("stringRepresentation cannot be null");const r=new Array(e.length);let a=0,i=0,o=-1,l=0,u=0;for(;u<e.length;)if(e.charAt(u)===`
`||e.charAt(u)==="\r"){if(a>i){if(o===-1)o=a-i;else if(a-i!==o)throw new S("row lengths do not match");i=a,l++}u++}else if(e.substring(u,u+t.length)===t)u+=t.length,r[a]=!0,a++;else if(e.substring(u,u+s.length)===s)u+=s.length,r[a]=!1,a++;else throw new S("illegal character encountered: "+e.substring(u));if(a>i){if(o===-1)o=a-i;else if(a-i!==o)throw new S("row lengths do not match");l++}const m=new Ce(o,l);for(let w=0;w<a;w++)r[w]&&m.set(Math.floor(w%o),Math.floor(w/o));return m}get(e,t){const s=t*this.rowSize+Math.floor(e/32);return(this.bits[s]>>>(e&31)&1)!==0}set(e,t){const s=t*this.rowSize+Math.floor(e/32);this.bits[s]|=1<<(e&31)&4294967295}unset(e,t){const s=t*this.rowSize+Math.floor(e/32);this.bits[s]&=~(1<<(e&31)&4294967295)}flip(e,t){const s=t*this.rowSize+Math.floor(e/32);this.bits[s]^=1<<(e&31)&4294967295}xor(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new S("input matrix dimensions do not match");const t=new Y(Math.floor(this.width/32)+1),s=this.rowSize,r=this.bits;for(let a=0,i=this.height;a<i;a++){const o=a*s,l=e.getRow(a,t).getBitArray();for(let u=0;u<s;u++)r[o+u]^=l[u]}}clear(){const e=this.bits,t=e.length;for(let s=0;s<t;s++)e[s]=0}setRegion(e,t,s,r){if(t<0||e<0)throw new S("Left and top must be nonnegative");if(r<1||s<1)throw new S("Height and width must be at least 1");const a=e+s,i=t+r;if(i>this.height||a>this.width)throw new S("The region must fit inside the matrix");const o=this.rowSize,l=this.bits;for(let u=t;u<i;u++){const m=u*o;for(let w=e;w<a;w++)l[m+Math.floor(w/32)]|=1<<(w&31)&4294967295}}getRow(e,t){t==null||t.getSize()<this.width?t=new Y(this.width):t.clear();const s=this.rowSize,r=this.bits,a=e*s;for(let i=0;i<s;i++)t.setBulk(i*32,r[a+i]);return t}setRow(e,t){U.arraycopy(t.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)}rotate180(){const e=this.getWidth(),t=this.getHeight();let s=new Y(e),r=new Y(e);for(let a=0,i=Math.floor((t+1)/2);a<i;a++)s=this.getRow(a,s),r=this.getRow(t-1-a,r),s.reverse(),r.reverse(),this.setRow(a,r),this.setRow(t-1-a,s)}getEnclosingRectangle(){const e=this.width,t=this.height,s=this.rowSize,r=this.bits;let a=e,i=t,o=-1,l=-1;for(let u=0;u<t;u++)for(let m=0;m<s;m++){const w=r[u*s+m];if(w!==0){if(u<i&&(i=u),u>l&&(l=u),m*32<a){let b=0;for(;!(w<<31-b&4294967295);)b++;m*32+b<a&&(a=m*32+b)}if(m*32+31>o){let b=31;for(;!(w>>>b);)b--;m*32+b>o&&(o=m*32+b)}}}return o<a||l<i?null:Int32Array.from([a,i,o-a+1,l-i+1])}getTopLeftOnBit(){const e=this.rowSize,t=this.bits;let s=0;for(;s<t.length&&t[s]===0;)s++;if(s===t.length)return null;const r=s/e;let a=s%e*32;const i=t[s];let o=0;for(;!(i<<31-o&4294967295);)o++;return a+=o,Int32Array.from([a,r])}getBottomRightOnBit(){const e=this.rowSize,t=this.bits;let s=t.length-1;for(;s>=0&&t[s]===0;)s--;if(s<0)return null;const r=Math.floor(s/e);let a=Math.floor(s%e)*32;const i=t[s];let o=31;for(;!(i>>>o);)o--;return a+=o,Int32Array.from([a,r])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(e){if(!(e instanceof Ce))return!1;const t=e;return this.width===t.width&&this.height===t.height&&this.rowSize===t.rowSize&&X.equals(this.bits,t.bits)}hashCode(){let e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+X.hashCode(this.bits),e}toString(e="X ",t="  ",s=`
`){return this.buildToString(e,t,s)}buildToString(e,t,s){let r=new ae;for(let a=0,i=this.height;a<i;a++){for(let o=0,l=this.width;o<l;o++)r.append(this.get(o,a)?e:t);r.append(s)}return r.toString()}clone(){return new Ce(this.width,this.height,this.rowSize,this.bits.slice())}}class H extends p{static getNotFoundInstance(){return new H}}H.kind="NotFoundException";class re extends B{constructor(e){super(e),this.luminances=re.EMPTY,this.buckets=new Int32Array(re.LUMINANCE_BUCKETS)}getBlackRow(e,t){const s=this.getLuminanceSource(),r=s.getWidth();t==null||t.getSize()<r?t=new Y(r):t.clear(),this.initArrays(r);const a=s.getRow(e,this.luminances),i=this.buckets;for(let l=0;l<r;l++)i[(a[l]&255)>>re.LUMINANCE_SHIFT]++;const o=re.estimateBlackPoint(i);if(r<3)for(let l=0;l<r;l++)(a[l]&255)<o&&t.set(l);else{let l=a[0]&255,u=a[1]&255;for(let m=1;m<r-1;m++){const w=a[m+1]&255;(u*4-l-w)/2<o&&t.set(m),l=u,u=w}}return t}getBlackMatrix(){const e=this.getLuminanceSource(),t=e.getWidth(),s=e.getHeight(),r=new Ce(t,s);this.initArrays(t);const a=this.buckets;for(let l=1;l<5;l++){const u=Math.floor(s*l/5),m=e.getRow(u,this.luminances),w=Math.floor(t*4/5);for(let b=Math.floor(t/5);b<w;b++){const E=m[b]&255;a[E>>re.LUMINANCE_SHIFT]++}}const i=re.estimateBlackPoint(a),o=e.getMatrix();for(let l=0;l<s;l++){const u=l*t;for(let m=0;m<t;m++)(o[u+m]&255)<i&&r.set(m,l)}return r}createBinarizer(e){return new re(e)}initArrays(e){this.luminances.length<e&&(this.luminances=new Uint8ClampedArray(e));const t=this.buckets;for(let s=0;s<re.LUMINANCE_BUCKETS;s++)t[s]=0}static estimateBlackPoint(e){const t=e.length;let s=0,r=0,a=0;for(let m=0;m<t;m++)e[m]>a&&(r=m,a=e[m]),e[m]>s&&(s=e[m]);let i=0,o=0;for(let m=0;m<t;m++){const w=m-r,b=e[m]*w*w;b>o&&(i=m,o=b)}if(r>i){const m=r;r=i,i=m}if(i-r<=t/16)throw new H;let l=i-1,u=-1;for(let m=i-1;m>r;m--){const w=m-r,b=w*w*(i-m)*(s-e[m]);b>u&&(l=m,u=b)}return l<<re.LUMINANCE_SHIFT}}re.LUMINANCE_BITS=5,re.LUMINANCE_SHIFT=8-re.LUMINANCE_BITS,re.LUMINANCE_BUCKETS=1<<re.LUMINANCE_BITS,re.EMPTY=Uint8ClampedArray.from([0]);class ue extends re{constructor(e){super(e),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const e=this.getLuminanceSource(),t=e.getWidth(),s=e.getHeight();if(t>=ue.MINIMUM_DIMENSION&&s>=ue.MINIMUM_DIMENSION){const r=e.getMatrix();let a=t>>ue.BLOCK_SIZE_POWER;t&ue.BLOCK_SIZE_MASK&&a++;let i=s>>ue.BLOCK_SIZE_POWER;s&ue.BLOCK_SIZE_MASK&&i++;const o=ue.calculateBlackPoints(r,a,i,t,s),l=new Ce(t,s);ue.calculateThresholdForBlock(r,a,i,t,s,o,l),this.matrix=l}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(e){return new ue(e)}static calculateThresholdForBlock(e,t,s,r,a,i,o){const l=a-ue.BLOCK_SIZE,u=r-ue.BLOCK_SIZE;for(let m=0;m<s;m++){let w=m<<ue.BLOCK_SIZE_POWER;w>l&&(w=l);const b=ue.cap(m,2,s-3);for(let E=0;E<t;E++){let _=E<<ue.BLOCK_SIZE_POWER;_>u&&(_=u);const O=ue.cap(E,2,t-3);let k=0;for(let ee=-2;ee<=2;ee++){const te=i[b+ee];k+=te[O-2]+te[O-1]+te[O]+te[O+1]+te[O+2]}const G=k/25;ue.thresholdBlock(e,_,w,G,r,o)}}}static cap(e,t,s){return e<t?t:e>s?s:e}static thresholdBlock(e,t,s,r,a,i){for(let o=0,l=s*a+t;o<ue.BLOCK_SIZE;o++,l+=a)for(let u=0;u<ue.BLOCK_SIZE;u++)(e[l+u]&255)<=r&&i.set(t+u,s+o)}static calculateBlackPoints(e,t,s,r,a){const i=a-ue.BLOCK_SIZE,o=r-ue.BLOCK_SIZE,l=new Array(s);for(let u=0;u<s;u++){l[u]=new Int32Array(t);let m=u<<ue.BLOCK_SIZE_POWER;m>i&&(m=i);for(let w=0;w<t;w++){let b=w<<ue.BLOCK_SIZE_POWER;b>o&&(b=o);let E=0,_=255,O=0;for(let G=0,ee=m*r+b;G<ue.BLOCK_SIZE;G++,ee+=r){for(let te=0;te<ue.BLOCK_SIZE;te++){const $=e[ee+te]&255;E+=$,$<_&&(_=$),$>O&&(O=$)}if(O-_>ue.MIN_DYNAMIC_RANGE)for(G++,ee+=r;G<ue.BLOCK_SIZE;G++,ee+=r)for(let te=0;te<ue.BLOCK_SIZE;te++)E+=e[ee+te]&255}let k=E>>ue.BLOCK_SIZE_POWER*2;if(O-_<=ue.MIN_DYNAMIC_RANGE&&(k=_/2,u>0&&w>0)){const G=(l[u-1][w]+2*l[u][w-1]+l[u-1][w-1])/4;_<G&&(k=G)}l[u][w]=k}}return l}}ue.BLOCK_SIZE_POWER=3,ue.BLOCK_SIZE=1<<ue.BLOCK_SIZE_POWER,ue.BLOCK_SIZE_MASK=ue.BLOCK_SIZE-1,ue.MINIMUM_DIMENSION=ue.BLOCK_SIZE*5,ue.MIN_DYNAMIC_RANGE=24;class de{constructor(e,t){this.width=e,this.height=t}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(e,t,s,r){throw new Z("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new Z("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new Z("This luminance source does not support rotation by 45 degrees.")}toString(){const e=new Uint8ClampedArray(this.width);let t=new ae;for(let s=0;s<this.height;s++){const r=this.getRow(s,e);for(let a=0;a<this.width;a++){const i=r[a]&255;let o;i<64?o="#":i<128?o="+":i<192?o=".":o=" ",t.append(o)}t.append(`
`)}return t.toString()}}class je extends de{constructor(e){super(e.getWidth(),e.getHeight()),this.delegate=e}getRow(e,t){const s=this.delegate.getRow(e,t),r=this.getWidth();for(let a=0;a<r;a++)s[a]=255-(s[a]&255);return s}getMatrix(){const e=this.delegate.getMatrix(),t=this.getWidth()*this.getHeight(),s=new Uint8ClampedArray(t);for(let r=0;r<t;r++)s[r]=255-(e[r]&255);return s}isCropSupported(){return this.delegate.isCropSupported()}crop(e,t,s,r){return new je(this.delegate.crop(e,t,s,r))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new je(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new je(this.delegate.rotateCounterClockwise45())}}class et extends de{constructor(e){super(e.width,e.height),this.canvas=e,this.tempCanvasElement=null,this.buffer=et.makeBufferFromCanvasImageData(e)}static makeBufferFromCanvasImageData(e){const t=e.getContext("2d").getImageData(0,0,e.width,e.height);return et.toGrayscaleBuffer(t.data,e.width,e.height)}static toGrayscaleBuffer(e,t,s){const r=new Uint8ClampedArray(t*s);for(let a=0,i=0,o=e.length;a<o;a+=4,i++){let l;if(e[a+3]===0)l=255;else{const m=e[a],w=e[a+1],b=e[a+2];l=306*m+601*w+117*b+512>>10}r[i]=l}return r}getRow(e,t){if(e<0||e>=this.getHeight())throw new S("Requested row is outside the image: "+e);const s=this.getWidth(),r=e*s;return t===null?t=this.buffer.slice(r,r+s):(t.length<s&&(t=new Uint8ClampedArray(s)),t.set(this.buffer.slice(r,r+s))),t}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(e,t,s,r){return super.crop(e,t,s,r),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const e=this.canvas.ownerDocument.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height,this.tempCanvasElement=e}return this.tempCanvasElement}rotate(e){const t=this.getTempCanvasElement(),s=t.getContext("2d"),r=e*et.DEGREE_TO_RADIANS,a=this.canvas.width,i=this.canvas.height,o=Math.ceil(Math.abs(Math.cos(r))*a+Math.abs(Math.sin(r))*i),l=Math.ceil(Math.abs(Math.sin(r))*a+Math.abs(Math.cos(r))*i);return t.width=o,t.height=l,s.translate(o/2,l/2),s.rotate(r),s.drawImage(this.canvas,a/-2,i/-2),this.buffer=et.makeBufferFromCanvasImageData(t),this}invert(){return new je(this)}}et.DEGREE_TO_RADIANS=Math.PI/180;class yt{constructor(e,t,s){this.deviceId=e,this.label=t,this.kind="videoinput",this.groupId=s||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var Be=(globalThis||Js||self||window||void 0)&&(globalThis||Js||self||window||void 0).__awaiter||function(y,e,t,s){function r(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(m){try{u(s.next(m))}catch(w){i(w)}}function l(m){try{u(s.throw(m))}catch(w){i(w)}}function u(m){m.done?a(m.value):r(m.value).then(o,l)}u((s=s.apply(y,e||[])).next())})};class mt{constructor(e,t=500,s){this.reader=e,this.timeBetweenScansMillis=t,this._hints=s,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(e){this._timeBetweenDecodingAttempts=e<0?0:e}set hints(e){this._hints=e||null}get hints(){return this._hints}listVideoInputDevices(){return Be(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const e=yield navigator.mediaDevices.enumerateDevices(),t=[];for(const s of e){const r=s.kind==="video"?"videoinput":s.kind;if(r!=="videoinput")continue;const a=s.deviceId||s.id,i=s.label||`Video device ${t.length+1}`,o=s.groupId,l={deviceId:a,label:i,kind:r,groupId:o};t.push(l)}return t})}getVideoInputDevices(){return Be(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(t=>new yt(t.deviceId,t.label))})}findDeviceById(e){return Be(this,void 0,void 0,function*(){const t=yield this.listVideoInputDevices();return t?t.find(s=>s.deviceId===e):null})}decodeFromInputVideoDevice(e,t){return Be(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(e,t)})}decodeOnceFromVideoDevice(e,t){return Be(this,void 0,void 0,function*(){this.reset();let s;e?s={deviceId:{exact:e}}:s={facingMode:"environment"};const r={video:s};return yield this.decodeOnceFromConstraints(r,t)})}decodeOnceFromConstraints(e,t){return Be(this,void 0,void 0,function*(){const s=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeOnceFromStream(s,t)})}decodeOnceFromStream(e,t){return Be(this,void 0,void 0,function*(){this.reset();const s=yield this.attachStreamToVideo(e,t);return yield this.decodeOnce(s)})}decodeFromInputVideoDeviceContinuously(e,t,s){return Be(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(e,t,s)})}decodeFromVideoDevice(e,t,s){return Be(this,void 0,void 0,function*(){let r;e?r={deviceId:{exact:e}}:r={facingMode:"environment"};const a={video:r};return yield this.decodeFromConstraints(a,t,s)})}decodeFromConstraints(e,t,s){return Be(this,void 0,void 0,function*(){const r=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeFromStream(r,t,s)})}decodeFromStream(e,t,s){return Be(this,void 0,void 0,function*(){this.reset();const r=yield this.attachStreamToVideo(e,t);return yield this.decodeContinuously(r,s)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(e,t){return Be(this,void 0,void 0,function*(){const s=this.prepareVideoElement(t);return this.addVideoSource(s,e),this.videoElement=s,this.stream=e,yield this.playVideoOnLoadAsync(s),s})}playVideoOnLoadAsync(e){return new Promise((t,s)=>this.playVideoOnLoad(e,()=>t()))}playVideoOnLoad(e,t){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(e),e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",t),this.tryPlayVideo(e)}isVideoPlaying(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2}tryPlayVideo(e){return Be(this,void 0,void 0,function*(){if(this.isVideoPlaying(e)){console.warn("Trying to play video that is already playing.");return}try{yield e.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(e,t){const s=document.getElementById(e);if(!s)throw new A(`element with id '${e}' not found`);if(s.nodeName.toLowerCase()!==t.toLowerCase())throw new A(`element with id '${e}' must be an ${t} element`);return s}decodeFromImage(e,t){if(!e&&!t)throw new A("either imageElement with a src set or an url must be provided");return t&&!e?this.decodeFromImageUrl(t):this.decodeFromImageElement(e)}decodeFromVideo(e,t){if(!e&&!t)throw new A("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrl(t):this.decodeFromVideoElement(e)}decodeFromVideoContinuously(e,t,s){if(e===void 0&&t===void 0)throw new A("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrlContinuously(t,s):this.decodeFromVideoElementContinuously(e,s)}decodeFromImageElement(e){if(!e)throw new A("An image element must be provided.");this.reset();const t=this.prepareImageElement(e);this.imageElement=t;let s;return this.isImageLoaded(t)?s=this.decodeOnce(t,!1,!0):s=this._decodeOnLoadImage(t),s}decodeFromVideoElement(e){const t=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(t)}decodeFromVideoElementContinuously(e,t){const s=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(s,t)}_decodeFromVideoElementSetup(e){if(!e)throw new A("A video element must be provided.");this.reset();const t=this.prepareVideoElement(e);return this.videoElement=t,t}decodeFromImageUrl(e){if(!e)throw new A("An URL must be provided.");this.reset();const t=this.prepareImageElement();this.imageElement=t;const s=this._decodeOnLoadImage(t);return t.src=e,s}decodeFromVideoUrl(e){if(!e)throw new A("An URL must be provided.");this.reset();const t=this.prepareVideoElement(),s=this.decodeFromVideoElement(t);return t.src=e,s}decodeFromVideoUrlContinuously(e,t){if(!e)throw new A("An URL must be provided.");this.reset();const s=this.prepareVideoElement(),r=this.decodeFromVideoElementContinuously(s,t);return s.src=e,r}_decodeOnLoadImage(e){return new Promise((t,s)=>{this.imageLoadedListener=()=>this.decodeOnce(e,!1,!0).then(t,s),e.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(e){return Be(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(e),yield this.decodeOnce(e)})}_decodeOnLoadVideoContinuously(e,t){return Be(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(e),this.decodeContinuously(e,t)})}isImageLoaded(e){return!(!e.complete||e.naturalWidth===0)}prepareImageElement(e){let t;return typeof e>"u"&&(t=document.createElement("img"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(t=e),t}prepareVideoElement(e){let t;return!e&&typeof document<"u"&&(t=document.createElement("video"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(t=e),t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true"),t}decodeOnce(e,t=!0,s=!0){this._stopAsyncDecode=!1;const r=(a,i)=>{if(this._stopAsyncDecode){i(new H("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const o=this.decode(e);a(o)}catch(o){const l=t&&o instanceof H,m=(o instanceof Q||o instanceof T)&&s;if(l||m)return setTimeout(r,this._timeBetweenDecodingAttempts,a,i);i(o)}};return new Promise((a,i)=>r(a,i))}decodeContinuously(e,t){this._stopContinuousDecode=!1;const s=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const r=this.decode(e);t(r,null),setTimeout(s,this.timeBetweenScansMillis)}catch(r){t(null,r);const a=r instanceof Q||r instanceof T,i=r instanceof H;(a||i)&&setTimeout(s,this._timeBetweenDecodingAttempts)}};s()}decode(e){const t=this.createBinaryBitmap(e);return this.decodeBitmap(t)}_isHTMLVideoElement(e){return e.videoWidth!==0}drawFrameOnCanvas(e,t,s){t||(t={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),s||(s=this.captureCanvasContext),s.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)}drawImageOnCanvas(e,t,s=this.captureCanvasContext){t||(t={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),s||(s=this.captureCanvasContext),s.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)}createBinaryBitmap(e){this.getCaptureCanvasContext(e),this._isHTMLVideoElement(e)?this.drawFrameOnCanvas(e):this.drawImageOnCanvas(e);const t=this.getCaptureCanvas(e),s=new et(t),r=new ue(s);return new F(r)}getCaptureCanvasContext(e){if(!this.captureCanvasContext){const s=this.getCaptureCanvas(e).getContext("2d");this.captureCanvasContext=s}return this.captureCanvasContext}getCaptureCanvas(e){if(!this.captureCanvas){const t=this.createCaptureCanvas(e);this.captureCanvas=t}return this.captureCanvas}decodeBitmap(e){return this.reader.decode(e,this._hints)}createCaptureCanvas(e){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const t=document.createElement("canvas");let s,r;return typeof e<"u"&&(e instanceof HTMLVideoElement?(s=e.videoWidth,r=e.videoHeight):e instanceof HTMLImageElement&&(s=e.naturalWidth||e.width,r=e.naturalHeight||e.height)),t.style.width=s+"px",t.style.height=r+"px",t.width=s,t.height=r,t}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(e=>e.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(e,t){try{e.srcObject=t}catch{e.src=URL.createObjectURL(t)}}cleanVideoSource(e){try{e.srcObject=null}catch{e.src=""}this.videoElement.removeAttribute("src")}}class dt{constructor(e,t,s=t==null?0:8*t.length,r,a,i=U.currentTimeMillis()){this.text=e,this.rawBytes=t,this.numBits=s,this.resultPoints=r,this.format=a,this.timestamp=i,this.text=e,this.rawBytes=t,s==null?this.numBits=t==null?0:8*t.length:this.numBits=s,this.resultPoints=r,this.format=a,this.resultMetadata=null,i==null?this.timestamp=U.currentTimeMillis():this.timestamp=i}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(e,t){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(e,t)}putAllMetadata(e){e!==null&&(this.resultMetadata===null?this.resultMetadata=e:this.resultMetadata=new Map(e))}addResultPoints(e){const t=this.resultPoints;if(t===null)this.resultPoints=e;else if(e!==null&&e.length>0){const s=new Array(t.length+e.length);U.arraycopy(t,0,s,0,t.length),U.arraycopy(e,0,s,t.length,e.length),this.resultPoints=s}}getTimestamp(){return this.timestamp}toString(){return this.text}}var Tn;(function(y){y[y.AZTEC=0]="AZTEC",y[y.CODABAR=1]="CODABAR",y[y.CODE_39=2]="CODE_39",y[y.CODE_93=3]="CODE_93",y[y.CODE_128=4]="CODE_128",y[y.DATA_MATRIX=5]="DATA_MATRIX",y[y.EAN_8=6]="EAN_8",y[y.EAN_13=7]="EAN_13",y[y.ITF=8]="ITF",y[y.MAXICODE=9]="MAXICODE",y[y.PDF_417=10]="PDF_417",y[y.QR_CODE=11]="QR_CODE",y[y.RSS_14=12]="RSS_14",y[y.RSS_EXPANDED=13]="RSS_EXPANDED",y[y.UPC_A=14]="UPC_A",y[y.UPC_E=15]="UPC_E",y[y.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Tn||(Tn={}));var xe=Tn,_n;(function(y){y[y.OTHER=0]="OTHER",y[y.ORIENTATION=1]="ORIENTATION",y[y.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",y[y.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",y[y.ISSUE_NUMBER=4]="ISSUE_NUMBER",y[y.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",y[y.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",y[y.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",y[y.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",y[y.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",y[y.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(_n||(_n={}));var ot=_n;class Us{constructor(e,t,s,r,a=-1,i=-1){this.rawBytes=e,this.text=t,this.byteSegments=s,this.ecLevel=r,this.structuredAppendSequenceNumber=a,this.structuredAppendParity=i,this.numBits=e==null?0:8*e.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(e){this.numBits=e}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(e){this.errorsCorrected=e}getErasures(){return this.erasures}setErasures(e){this.erasures=e}getOther(){return this.other}setOther(e){this.other=e}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Hs{exp(e){return this.expTable[e]}log(e){if(e===0)throw new S;return this.logTable[e]}static addOrSubtract(e,t){return e^t}}class At{constructor(e,t){if(t.length===0)throw new S;this.field=e;const s=t.length;if(s>1&&t[0]===0){let r=1;for(;r<s&&t[r]===0;)r++;r===s?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(s-r),U.arraycopy(t,r,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(e===0)return this.getCoefficient(0);const t=this.coefficients;let s;if(e===1){s=0;for(let i=0,o=t.length;i!==o;i++){const l=t[i];s=Hs.addOrSubtract(s,l)}return s}s=t[0];const r=t.length,a=this.field;for(let i=1;i<r;i++)s=Hs.addOrSubtract(a.multiply(e,s),t[i]);return s}addOrSubtract(e){if(!this.field.equals(e.field))throw new S("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,s=e.coefficients;if(t.length>s.length){const i=t;t=s,s=i}let r=new Int32Array(s.length);const a=s.length-t.length;U.arraycopy(s,0,r,0,a);for(let i=a;i<s.length;i++)r[i]=Hs.addOrSubtract(t[i-a],s[i]);return new At(this.field,r)}multiply(e){if(!this.field.equals(e.field))throw new S("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();const t=this.coefficients,s=t.length,r=e.coefficients,a=r.length,i=new Int32Array(s+a-1),o=this.field;for(let l=0;l<s;l++){const u=t[l];for(let m=0;m<a;m++)i[l+m]=Hs.addOrSubtract(i[l+m],o.multiply(u,r[m]))}return new At(o,i)}multiplyScalar(e){if(e===0)return this.field.getZero();if(e===1)return this;const t=this.coefficients.length,s=this.field,r=new Int32Array(t),a=this.coefficients;for(let i=0;i<t;i++)r[i]=s.multiply(a[i],e);return new At(s,r)}multiplyByMonomial(e,t){if(e<0)throw new S;if(t===0)return this.field.getZero();const s=this.coefficients,r=s.length,a=new Int32Array(r+e),i=this.field;for(let o=0;o<r;o++)a[o]=i.multiply(s[o],t);return new At(i,a)}divide(e){if(!this.field.equals(e.field))throw new S("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new S("Divide by 0");const t=this.field;let s=t.getZero(),r=this;const a=e.getCoefficient(e.getDegree()),i=t.inverse(a);for(;r.getDegree()>=e.getDegree()&&!r.isZero();){const o=r.getDegree()-e.getDegree(),l=t.multiply(r.getCoefficient(r.getDegree()),i),u=e.multiplyByMonomial(o,l),m=t.buildMonomial(o,l);s=s.addOrSubtract(m),r=r.addOrSubtract(u)}return[s,r]}toString(){let e="";for(let t=this.getDegree();t>=0;t--){let s=this.getCoefficient(t);if(s!==0){if(s<0?(e+=" - ",s=-s):e.length>0&&(e+=" + "),t===0||s!==1){const r=this.field.log(s);r===0?e+="1":r===1?e+="a":(e+="a^",e+=r)}t!==0&&(t===1?e+="x":(e+="x^",e+=t))}}return e}}class tn extends p{}tn.kind="ArithmeticException";class _e extends Hs{constructor(e,t,s){super(),this.primitive=e,this.size=t,this.generatorBase=s;const r=new Int32Array(t);let a=1;for(let o=0;o<t;o++)r[o]=a,a*=2,a>=t&&(a^=e,a&=t-1);this.expTable=r;const i=new Int32Array(t);for(let o=0;o<t-1;o++)i[r[o]]=o;this.logTable=i,this.zero=new At(this,Int32Array.from([0])),this.one=new At(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new S;if(t===0)return this.zero;const s=new Int32Array(e+1);return s[0]=t,new At(this,s)}inverse(e){if(e===0)throw new tn;return this.expTable[this.size-this.logTable[e]-1]}multiply(e,t){return e===0||t===0?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+W.toHexString(this.primitive)+","+this.size+")"}equals(e){return e===this}}_e.AZTEC_DATA_12=new _e(4201,4096,1),_e.AZTEC_DATA_10=new _e(1033,1024,1),_e.AZTEC_DATA_6=new _e(67,64,1),_e.AZTEC_PARAM=new _e(19,16,1),_e.QR_CODE_FIELD_256=new _e(285,256,0),_e.DATA_MATRIX_FIELD_256=new _e(301,256,1),_e.AZTEC_DATA_8=_e.DATA_MATRIX_FIELD_256,_e.MAXICODE_FIELD_64=_e.AZTEC_DATA_6;class Ss extends p{}Ss.kind="ReedSolomonException";class Wt extends p{}Wt.kind="IllegalStateException";class zs{constructor(e){this.field=e}decode(e,t){const s=this.field,r=new At(s,e),a=new Int32Array(t);let i=!0;for(let E=0;E<t;E++){const _=r.evaluateAt(s.exp(E+s.getGeneratorBase()));a[a.length-1-E]=_,_!==0&&(i=!1)}if(i)return;const o=new At(s,a),l=this.runEuclideanAlgorithm(s.buildMonomial(t,1),o,t),u=l[0],m=l[1],w=this.findErrorLocations(u),b=this.findErrorMagnitudes(m,w);for(let E=0;E<w.length;E++){const _=e.length-1-s.log(w[E]);if(_<0)throw new Ss("Bad error location");e[_]=_e.addOrSubtract(e[_],b[E])}}runEuclideanAlgorithm(e,t,s){if(e.getDegree()<t.getDegree()){const E=e;e=t,t=E}const r=this.field;let a=e,i=t,o=r.getZero(),l=r.getOne();for(;i.getDegree()>=(s/2|0);){let E=a,_=o;if(a=i,o=l,a.isZero())throw new Ss("r_{i-1} was zero");i=E;let O=r.getZero();const k=a.getCoefficient(a.getDegree()),G=r.inverse(k);for(;i.getDegree()>=a.getDegree()&&!i.isZero();){const ee=i.getDegree()-a.getDegree(),te=r.multiply(i.getCoefficient(i.getDegree()),G);O=O.addOrSubtract(r.buildMonomial(ee,te)),i=i.addOrSubtract(a.multiplyByMonomial(ee,te))}if(l=O.multiply(o).addOrSubtract(_),i.getDegree()>=a.getDegree())throw new Wt("Division algorithm failed to reduce polynomial?")}const u=l.getCoefficient(0);if(u===0)throw new Ss("sigmaTilde(0) was zero");const m=r.inverse(u),w=l.multiplyScalar(m),b=i.multiplyScalar(m);return[w,b]}findErrorLocations(e){const t=e.getDegree();if(t===1)return Int32Array.from([e.getCoefficient(1)]);const s=new Int32Array(t);let r=0;const a=this.field;for(let i=1;i<a.getSize()&&r<t;i++)e.evaluateAt(i)===0&&(s[r]=a.inverse(i),r++);if(r!==t)throw new Ss("Error locator degree does not match number of roots");return s}findErrorMagnitudes(e,t){const s=t.length,r=new Int32Array(s),a=this.field;for(let i=0;i<s;i++){const o=a.inverse(t[i]);let l=1;for(let u=0;u<s;u++)if(i!==u){const m=a.multiply(t[u],o),w=m&1?m&-2:m|1;l=a.multiply(l,w)}r[i]=a.multiply(e.evaluateAt(o),a.inverse(l)),a.getGeneratorBase()!==0&&(r[i]=a.multiply(r[i],o))}return r}}var ht;(function(y){y[y.UPPER=0]="UPPER",y[y.LOWER=1]="LOWER",y[y.MIXED=2]="MIXED",y[y.DIGIT=3]="DIGIT",y[y.PUNCT=4]="PUNCT",y[y.BINARY=5]="BINARY"})(ht||(ht={}));class He{decode(e){this.ddata=e;let t=e.getBits(),s=this.extractBits(t),r=this.correctBits(s),a=He.convertBoolArrayToByteArray(r),i=He.getEncodedData(r),o=new Us(a,i,null,null);return o.setNumBits(r.length),o}static highLevelDecode(e){return this.getEncodedData(e)}static getEncodedData(e){let t=e.length,s=ht.UPPER,r=ht.UPPER,a="",i=0;for(;i<t;)if(r===ht.BINARY){if(t-i<5)break;let o=He.readCode(e,i,5);if(i+=5,o===0){if(t-i<11)break;o=He.readCode(e,i,11)+31,i+=11}for(let l=0;l<o;l++){if(t-i<8){i=t;break}const u=He.readCode(e,i,8);a+=J.castAsNonUtf8Char(u),i+=8}r=s}else{let o=r===ht.DIGIT?4:5;if(t-i<o)break;let l=He.readCode(e,i,o);i+=o;let u=He.getCharacter(r,l);u.startsWith("CTRL_")?(s=r,r=He.getTable(u.charAt(5)),u.charAt(6)==="L"&&(s=r)):(a+=u,r=s)}return a}static getTable(e){switch(e){case"L":return ht.LOWER;case"P":return ht.PUNCT;case"M":return ht.MIXED;case"D":return ht.DIGIT;case"B":return ht.BINARY;case"U":default:return ht.UPPER}}static getCharacter(e,t){switch(e){case ht.UPPER:return He.UPPER_TABLE[t];case ht.LOWER:return He.LOWER_TABLE[t];case ht.MIXED:return He.MIXED_TABLE[t];case ht.PUNCT:return He.PUNCT_TABLE[t];case ht.DIGIT:return He.DIGIT_TABLE[t];default:throw new Wt("Bad table")}}correctBits(e){let t,s;this.ddata.getNbLayers()<=2?(s=6,t=_e.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(s=8,t=_e.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(s=10,t=_e.AZTEC_DATA_10):(s=12,t=_e.AZTEC_DATA_12);let r=this.ddata.getNbDatablocks(),a=e.length/s;if(a<r)throw new T;let i=e.length%s,o=new Int32Array(a);for(let b=0;b<a;b++,i+=s)o[b]=He.readCode(e,i,s);try{new zs(t).decode(o,a-r)}catch(b){throw new T(b)}let l=(1<<s)-1,u=0;for(let b=0;b<r;b++){let E=o[b];if(E===0||E===l)throw new T;(E===1||E===l-1)&&u++}let m=new Array(r*s-u),w=0;for(let b=0;b<r;b++){let E=o[b];if(E===1||E===l-1)m.fill(E>1,w,w+s-1),w+=s-1;else for(let _=s-1;_>=0;--_)m[w++]=(E&1<<_)!==0}return m}extractBits(e){let t=this.ddata.isCompact(),s=this.ddata.getNbLayers(),r=(t?11:14)+s*4,a=new Int32Array(r),i=new Array(this.totalBitsInLayer(s,t));if(t)for(let o=0;o<a.length;o++)a[o]=o;else{let o=r+1+2*W.truncDivision(W.truncDivision(r,2)-1,15),l=r/2,u=W.truncDivision(o,2);for(let m=0;m<l;m++){let w=m+W.truncDivision(m,15);a[l-m-1]=u-w-1,a[l+m]=u+w+1}}for(let o=0,l=0;o<s;o++){let u=(s-o)*4+(t?9:12),m=o*2,w=r-1-m;for(let b=0;b<u;b++){let E=b*2;for(let _=0;_<2;_++)i[l+E+_]=e.get(a[m+_],a[m+b]),i[l+2*u+E+_]=e.get(a[m+b],a[w-_]),i[l+4*u+E+_]=e.get(a[w-_],a[w-b]),i[l+6*u+E+_]=e.get(a[w-b],a[m+_])}l+=u*8}return i}static readCode(e,t,s){let r=0;for(let a=t;a<t+s;a++)r<<=1,e[a]&&(r|=1);return r}static readByte(e,t){let s=e.length-t;return s>=8?He.readCode(e,t,8):He.readCode(e,t,s)<<8-s}static convertBoolArrayToByteArray(e){let t=new Uint8Array((e.length+7)/8);for(let s=0;s<t.length;s++)t[s]=He.readByte(e,8*s);return t}totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}He.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],He.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],He.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],He.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],He.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class Ie{constructor(){}static round(e){return e===NaN?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0}static distance(e,t,s,r){const a=e-s,i=t-r;return Math.sqrt(a*a+i*i)}static sum(e){let t=0;for(let s=0,r=e.length;s!==r;s++){const a=e[s];t+=a}return t}}class sn{static floatToIntBits(e){return e}}sn.MAX_VALUE=Number.MAX_SAFE_INTEGER;class ce{constructor(e,t){this.x=e,this.y=t}getX(){return this.x}getY(){return this.y}equals(e){if(e instanceof ce){const t=e;return this.x===t.x&&this.y===t.y}return!1}hashCode(){return 31*sn.floatToIntBits(this.x)+sn.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(e){const t=this.distance(e[0],e[1]),s=this.distance(e[1],e[2]),r=this.distance(e[0],e[2]);let a,i,o;if(s>=t&&s>=r?(i=e[0],a=e[1],o=e[2]):r>=s&&r>=t?(i=e[1],a=e[0],o=e[2]):(i=e[2],a=e[0],o=e[1]),this.crossProductZ(a,i,o)<0){const l=a;a=o,o=l}e[0]=a,e[1]=i,e[2]=o}static distance(e,t){return Ie.distance(e.x,e.y,t.x,t.y)}static crossProductZ(e,t,s){const r=t.x,a=t.y;return(s.x-r)*(e.y-a)-(s.y-a)*(e.x-r)}}class nn{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class xr extends nn{constructor(e,t,s,r,a){super(e,t),this.compact=s,this.nbDatablocks=r,this.nbLayers=a}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class ts{constructor(e,t,s,r){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),t==null&&(t=ts.INIT_SIZE),s==null&&(s=e.getWidth()/2|0),r==null&&(r=e.getHeight()/2|0);const a=t/2|0;if(this.leftInit=s-a,this.rightInit=s+a,this.upInit=r-a,this.downInit=r+a,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new H}detect(){let e=this.leftInit,t=this.rightInit,s=this.upInit,r=this.downInit,a=!1,i=!0,o=!1,l=!1,u=!1,m=!1,w=!1;const b=this.width,E=this.height;for(;i;){i=!1;let _=!0;for(;(_||!l)&&t<b;)_=this.containsBlackPoint(s,r,t,!1),_?(t++,i=!0,l=!0):l||t++;if(t>=b){a=!0;break}let O=!0;for(;(O||!u)&&r<E;)O=this.containsBlackPoint(e,t,r,!0),O?(r++,i=!0,u=!0):u||r++;if(r>=E){a=!0;break}let k=!0;for(;(k||!m)&&e>=0;)k=this.containsBlackPoint(s,r,e,!1),k?(e--,i=!0,m=!0):m||e--;if(e<0){a=!0;break}let G=!0;for(;(G||!w)&&s>=0;)G=this.containsBlackPoint(e,t,s,!0),G?(s--,i=!0,w=!0):w||s--;if(s<0){a=!0;break}i&&(o=!0)}if(!a&&o){const _=t-e;let O=null;for(let te=1;O===null&&te<_;te++)O=this.getBlackPointOnSegment(e,r-te,e+te,r);if(O==null)throw new H;let k=null;for(let te=1;k===null&&te<_;te++)k=this.getBlackPointOnSegment(e,s+te,e+te,s);if(k==null)throw new H;let G=null;for(let te=1;G===null&&te<_;te++)G=this.getBlackPointOnSegment(t,s+te,t-te,s);if(G==null)throw new H;let ee=null;for(let te=1;ee===null&&te<_;te++)ee=this.getBlackPointOnSegment(t,r-te,t-te,r);if(ee==null)throw new H;return this.centerEdges(ee,O,G,k)}else throw new H}getBlackPointOnSegment(e,t,s,r){const a=Ie.round(Ie.distance(e,t,s,r)),i=(s-e)/a,o=(r-t)/a,l=this.image;for(let u=0;u<a;u++){const m=Ie.round(e+u*i),w=Ie.round(t+u*o);if(l.get(m,w))return new ce(m,w)}return null}centerEdges(e,t,s,r){const a=e.getX(),i=e.getY(),o=t.getX(),l=t.getY(),u=s.getX(),m=s.getY(),w=r.getX(),b=r.getY(),E=ts.CORR;return a<this.width/2?[new ce(w-E,b+E),new ce(o+E,l+E),new ce(u-E,m-E),new ce(a+E,i-E)]:[new ce(w+E,b+E),new ce(o+E,l-E),new ce(u-E,m+E),new ce(a-E,i-E)]}containsBlackPoint(e,t,s,r){const a=this.image;if(r){for(let i=e;i<=t;i++)if(a.get(i,s))return!0}else for(let i=e;i<=t;i++)if(a.get(s,i))return!0;return!1}}ts.INIT_SIZE=10,ts.CORR=1;class Mn{static checkAndNudgePoints(e,t){const s=e.getWidth(),r=e.getHeight();let a=!0;for(let i=0;i<t.length&&a;i+=2){const o=Math.floor(t[i]),l=Math.floor(t[i+1]);if(o<-1||o>s||l<-1||l>r)throw new H;a=!1,o===-1?(t[i]=0,a=!0):o===s&&(t[i]=s-1,a=!0),l===-1?(t[i+1]=0,a=!0):l===r&&(t[i+1]=r-1,a=!0)}a=!0;for(let i=t.length-2;i>=0&&a;i-=2){const o=Math.floor(t[i]),l=Math.floor(t[i+1]);if(o<-1||o>s||l<-1||l>r)throw new H;a=!1,o===-1?(t[i]=0,a=!0):o===s&&(t[i]=s-1,a=!0),l===-1?(t[i+1]=0,a=!0):l===r&&(t[i+1]=r-1,a=!0)}}}class Ut{constructor(e,t,s,r,a,i,o,l,u){this.a11=e,this.a21=t,this.a31=s,this.a12=r,this.a22=a,this.a32=i,this.a13=o,this.a23=l,this.a33=u}static quadrilateralToQuadrilateral(e,t,s,r,a,i,o,l,u,m,w,b,E,_,O,k){const G=Ut.quadrilateralToSquare(e,t,s,r,a,i,o,l);return Ut.squareToQuadrilateral(u,m,w,b,E,_,O,k).times(G)}transformPoints(e){const t=e.length,s=this.a11,r=this.a12,a=this.a13,i=this.a21,o=this.a22,l=this.a23,u=this.a31,m=this.a32,w=this.a33;for(let b=0;b<t;b+=2){const E=e[b],_=e[b+1],O=a*E+l*_+w;e[b]=(s*E+i*_+u)/O,e[b+1]=(r*E+o*_+m)/O}}transformPointsWithValues(e,t){const s=this.a11,r=this.a12,a=this.a13,i=this.a21,o=this.a22,l=this.a23,u=this.a31,m=this.a32,w=this.a33,b=e.length;for(let E=0;E<b;E++){const _=e[E],O=t[E],k=a*_+l*O+w;e[E]=(s*_+i*O+u)/k,t[E]=(r*_+o*O+m)/k}}static squareToQuadrilateral(e,t,s,r,a,i,o,l){const u=e-s+a-o,m=t-r+i-l;if(u===0&&m===0)return new Ut(s-e,a-s,e,r-t,i-r,t,0,0,1);{const w=s-a,b=o-a,E=r-i,_=l-i,O=w*_-b*E,k=(u*_-b*m)/O,G=(w*m-u*E)/O;return new Ut(s-e+k*s,o-e+G*o,e,r-t+k*r,l-t+G*l,t,k,G,1)}}static quadrilateralToSquare(e,t,s,r,a,i,o,l){return Ut.squareToQuadrilateral(e,t,s,r,a,i,o,l).buildAdjoint()}buildAdjoint(){return new Ut(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(e){return new Ut(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}class mr extends Mn{sampleGrid(e,t,s,r,a,i,o,l,u,m,w,b,E,_,O,k,G,ee,te){const $=Ut.quadrilateralToQuadrilateral(r,a,i,o,l,u,m,w,b,E,_,O,k,G,ee,te);return this.sampleGridWithTransform(e,t,s,$)}sampleGridWithTransform(e,t,s,r){if(t<=0||s<=0)throw new H;const a=new Ce(t,s),i=new Float32Array(2*t);for(let o=0;o<s;o++){const l=i.length,u=o+.5;for(let m=0;m<l;m+=2)i[m]=m/2+.5,i[m+1]=u;r.transformPoints(i),Mn.checkAndNudgePoints(e,i);try{for(let m=0;m<l;m+=2)e.get(Math.floor(i[m]),Math.floor(i[m+1]))&&a.set(m/2,o)}catch{throw new H}}return a}}class is{static setGridSampler(e){is.gridSampler=e}static getInstance(){return is.gridSampler}}is.gridSampler=new mr;class wt{constructor(e,t){this.x=e,this.y=t}toResultPoint(){return new ce(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class gr{constructor(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}detect(){return this.detectMirror(!1)}detectMirror(e){let t=this.getMatrixCenter(),s=this.getBullsEyeCorners(t);if(e){let i=s[0];s[0]=s[2],s[2]=i}this.extractParameters(s);let r=this.sampleGrid(this.image,s[this.shift%4],s[(this.shift+1)%4],s[(this.shift+2)%4],s[(this.shift+3)%4]),a=this.getMatrixCornerPoints(s);return new xr(r,a,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(e){if(!this.isValidPoint(e[0])||!this.isValidPoint(e[1])||!this.isValidPoint(e[2])||!this.isValidPoint(e[3]))throw new H;let t=2*this.nbCenterLayers,s=new Int32Array([this.sampleLine(e[0],e[1],t),this.sampleLine(e[1],e[2],t),this.sampleLine(e[2],e[3],t),this.sampleLine(e[3],e[0],t)]);this.shift=this.getRotation(s,t);let r=0;for(let i=0;i<4;i++){let o=s[(this.shift+i)%4];this.compact?(r<<=7,r+=o>>1&127):(r<<=10,r+=(o>>2&992)+(o>>1&31))}let a=this.getCorrectedParameterData(r,this.compact);this.compact?(this.nbLayers=(a>>6)+1,this.nbDataBlocks=(a&63)+1):(this.nbLayers=(a>>11)+1,this.nbDataBlocks=(a&2047)+1)}getRotation(e,t){let s=0;e.forEach((r,a,i)=>{let o=(r>>t-2<<1)+(r&1);s=(s<<3)+o}),s=((s&1)<<11)+(s>>1);for(let r=0;r<4;r++)if(W.bitCount(s^this.EXPECTED_CORNER_BITS[r])<=2)return r;throw new H}getCorrectedParameterData(e,t){let s,r;t?(s=7,r=2):(s=10,r=4);let a=s-r,i=new Int32Array(s);for(let l=s-1;l>=0;--l)i[l]=e&15,e>>=4;try{new zs(_e.AZTEC_PARAM).decode(i,a)}catch{throw new H}let o=0;for(let l=0;l<r;l++)o=(o<<4)+i[l];return o}getBullsEyeCorners(e){let t=e,s=e,r=e,a=e,i=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let w=this.getFirstDifferent(t,i,1,-1),b=this.getFirstDifferent(s,i,1,1),E=this.getFirstDifferent(r,i,-1,1),_=this.getFirstDifferent(a,i,-1,-1);if(this.nbCenterLayers>2){let O=this.distancePoint(_,w)*this.nbCenterLayers/(this.distancePoint(a,t)*(this.nbCenterLayers+2));if(O<.75||O>1.25||!this.isWhiteOrBlackRectangle(w,b,E,_))break}t=w,s=b,r=E,a=_,i=!i}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new H;this.compact=this.nbCenterLayers===5;let o=new ce(t.getX()+.5,t.getY()-.5),l=new ce(s.getX()+.5,s.getY()+.5),u=new ce(r.getX()-.5,r.getY()+.5),m=new ce(a.getX()-.5,a.getY()-.5);return this.expandSquare([o,l,u,m],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let e,t,s,r;try{let o=new ts(this.image).detect();e=o[0],t=o[1],s=o[2],r=o[3]}catch{let l=this.image.getWidth()/2,u=this.image.getHeight()/2;e=this.getFirstDifferent(new wt(l+7,u-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new wt(l+7,u+7),!1,1,1).toResultPoint(),s=this.getFirstDifferent(new wt(l-7,u+7),!1,-1,1).toResultPoint(),r=this.getFirstDifferent(new wt(l-7,u-7),!1,-1,-1).toResultPoint()}let a=Ie.round((e.getX()+r.getX()+t.getX()+s.getX())/4),i=Ie.round((e.getY()+r.getY()+t.getY()+s.getY())/4);try{let o=new ts(this.image,15,a,i).detect();e=o[0],t=o[1],s=o[2],r=o[3]}catch{e=this.getFirstDifferent(new wt(a+7,i-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new wt(a+7,i+7),!1,1,1).toResultPoint(),s=this.getFirstDifferent(new wt(a-7,i+7),!1,-1,1).toResultPoint(),r=this.getFirstDifferent(new wt(a-7,i-7),!1,-1,-1).toResultPoint()}return a=Ie.round((e.getX()+r.getX()+t.getX()+s.getX())/4),i=Ie.round((e.getY()+r.getY()+t.getY()+s.getY())/4),new wt(a,i)}getMatrixCornerPoints(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())}sampleGrid(e,t,s,r,a){let i=is.getInstance(),o=this.getDimension(),l=o/2-this.nbCenterLayers,u=o/2+this.nbCenterLayers;return i.sampleGrid(e,o,o,l,l,u,l,u,u,l,u,t.getX(),t.getY(),s.getX(),s.getY(),r.getX(),r.getY(),a.getX(),a.getY())}sampleLine(e,t,s){let r=0,a=this.distanceResultPoint(e,t),i=a/s,o=e.getX(),l=e.getY(),u=i*(t.getX()-e.getX())/a,m=i*(t.getY()-e.getY())/a;for(let w=0;w<s;w++)this.image.get(Ie.round(o+w*u),Ie.round(l+w*m))&&(r|=1<<s-w-1);return r}isWhiteOrBlackRectangle(e,t,s,r){let a=3;e=new wt(e.getX()-a,e.getY()+a),t=new wt(t.getX()-a,t.getY()-a),s=new wt(s.getX()+a,s.getY()-a),r=new wt(r.getX()+a,r.getY()+a);let i=this.getColor(r,e);if(i===0)return!1;let o=this.getColor(e,t);return o!==i||(o=this.getColor(t,s),o!==i)?!1:(o=this.getColor(s,r),o===i)}getColor(e,t){let s=this.distancePoint(e,t),r=(t.getX()-e.getX())/s,a=(t.getY()-e.getY())/s,i=0,o=e.getX(),l=e.getY(),u=this.image.get(e.getX(),e.getY()),m=Math.ceil(s);for(let b=0;b<m;b++)o+=r,l+=a,this.image.get(Ie.round(o),Ie.round(l))!==u&&i++;let w=i/s;return w>.1&&w<.9?0:w<=.1===u?1:-1}getFirstDifferent(e,t,s,r){let a=e.getX()+s,i=e.getY()+r;for(;this.isValid(a,i)&&this.image.get(a,i)===t;)a+=s,i+=r;for(a-=s,i-=r;this.isValid(a,i)&&this.image.get(a,i)===t;)a+=s;for(a-=s;this.isValid(a,i)&&this.image.get(a,i)===t;)i+=r;return i-=r,new wt(a,i)}expandSquare(e,t,s){let r=s/(2*t),a=e[0].getX()-e[2].getX(),i=e[0].getY()-e[2].getY(),o=(e[0].getX()+e[2].getX())/2,l=(e[0].getY()+e[2].getY())/2,u=new ce(o+r*a,l+r*i),m=new ce(o-r*a,l-r*i);a=e[1].getX()-e[3].getX(),i=e[1].getY()-e[3].getY(),o=(e[1].getX()+e[3].getX())/2,l=(e[1].getY()+e[3].getY())/2;let w=new ce(o+r*a,l+r*i),b=new ce(o-r*a,l-r*i);return[u,w,m,b]}isValid(e,t){return e>=0&&e<this.image.getWidth()&&t>0&&t<this.image.getHeight()}isValidPoint(e){let t=Ie.round(e.getX()),s=Ie.round(e.getY());return this.isValid(t,s)}distancePoint(e,t){return Ie.distance(e.getX(),e.getY(),t.getX(),t.getY())}distanceResultPoint(e,t){return Ie.distance(e.getX(),e.getY(),t.getX(),t.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(W.truncDivision(this.nbLayers-4,8)+1)+15}}class rn{decode(e,t=null){let s=null,r=new gr(e.getBlackMatrix()),a=null,i=null;try{let m=r.detectMirror(!1);a=m.getPoints(),this.reportFoundResultPoints(t,a),i=new He().decode(m)}catch(m){s=m}if(i==null)try{let m=r.detectMirror(!0);a=m.getPoints(),this.reportFoundResultPoints(t,a),i=new He().decode(m)}catch(m){throw s??m}let o=new dt(i.getText(),i.getRawBytes(),i.getNumBits(),a,xe.AZTEC,U.currentTimeMillis()),l=i.getByteSegments();l!=null&&o.putMetadata(ot.BYTE_SEGMENTS,l);let u=i.getECLevel();return u!=null&&o.putMetadata(ot.ERROR_CORRECTION_LEVEL,u),o}reportFoundResultPoints(e,t){if(e!=null){let s=e.get(v.NEED_RESULT_POINT_CALLBACK);s!=null&&t.forEach((r,a,i)=>{s.foundPossibleResultPoint(r)})}}reset(){}}class Fa extends mt{constructor(e=500){super(new rn,e)}}class st{decode(e,t){try{return this.doDecode(e,t)}catch{if(t&&t.get(v.TRY_HARDER)===!0&&e.isRotateSupported()){const a=e.rotateCounterClockwise(),i=this.doDecode(a,t),o=i.getResultMetadata();let l=270;o!==null&&o.get(ot.ORIENTATION)===!0&&(l=l+o.get(ot.ORIENTATION)%360),i.putMetadata(ot.ORIENTATION,l);const u=i.getResultPoints();if(u!==null){const m=a.getHeight();for(let w=0;w<u.length;w++)u[w]=new ce(m-u[w].getY()-1,u[w].getX())}return i}else throw new H}}reset(){}doDecode(e,t){const s=e.getWidth(),r=e.getHeight();let a=new Y(s);const i=t&&t.get(v.TRY_HARDER)===!0,o=Math.max(1,r>>(i?8:5));let l;i?l=r:l=15;const u=Math.trunc(r/2);for(let m=0;m<l;m++){const w=Math.trunc((m+1)/2),b=(m&1)===0,E=u+o*(b?w:-w);if(E<0||E>=r)break;try{a=e.getBlackRow(E,a)}catch{continue}for(let _=0;_<2;_++){if(_===1&&(a.reverse(),t&&t.get(v.NEED_RESULT_POINT_CALLBACK)===!0)){const O=new Map;t.forEach((k,G)=>O.set(G,k)),O.delete(v.NEED_RESULT_POINT_CALLBACK),t=O}try{const O=this.decodeRow(E,a,t);if(_===1){O.putMetadata(ot.ORIENTATION,180);const k=O.getResultPoints();k!==null&&(k[0]=new ce(s-k[0].getX()-1,k[0].getY()),k[1]=new ce(s-k[1].getX()-1,k[1].getY()))}return O}catch{}}}throw new H}static recordPattern(e,t,s){const r=s.length;for(let u=0;u<r;u++)s[u]=0;const a=e.getSize();if(t>=a)throw new H;let i=!e.get(t),o=0,l=t;for(;l<a;){if(e.get(l)!==i)s[o]++;else{if(++o===r)break;s[o]=1,i=!i}l++}if(!(o===r||o===r-1&&l===a))throw new H}static recordPatternInReverse(e,t,s){let r=s.length,a=e.get(t);for(;t>0&&r>=0;)e.get(--t)!==a&&(r--,a=!a);if(r>=0)throw new H;st.recordPattern(e,t+1,s)}static patternMatchVariance(e,t,s){const r=e.length;let a=0,i=0;for(let u=0;u<r;u++)a+=e[u],i+=t[u];if(a<i)return Number.POSITIVE_INFINITY;const o=a/i;s*=o;let l=0;for(let u=0;u<r;u++){const m=e[u],w=t[u]*o,b=m>w?m-w:w-m;if(b>s)return Number.POSITIVE_INFINITY;l+=b}return l/a}}class ne extends st{static findStartPattern(e){const t=e.getSize(),s=e.getNextSet(0);let r=0,a=Int32Array.from([0,0,0,0,0,0]),i=s,o=!1;const l=6;for(let u=s;u<t;u++)if(e.get(u)!==o)a[r]++;else{if(r===l-1){let m=ne.MAX_AVG_VARIANCE,w=-1;for(let b=ne.CODE_START_A;b<=ne.CODE_START_C;b++){const E=st.patternMatchVariance(a,ne.CODE_PATTERNS[b],ne.MAX_INDIVIDUAL_VARIANCE);E<m&&(m=E,w=b)}if(w>=0&&e.isRange(Math.max(0,i-(u-i)/2),i,!1))return Int32Array.from([i,u,w]);i+=a[0]+a[1],a=a.slice(2,a.length-1),a[r-1]=0,a[r]=0,r--}else r++;a[r]=1,o=!o}throw new H}static decodeCode(e,t,s){st.recordPattern(e,s,t);let r=ne.MAX_AVG_VARIANCE,a=-1;for(let i=0;i<ne.CODE_PATTERNS.length;i++){const o=ne.CODE_PATTERNS[i],l=this.patternMatchVariance(t,o,ne.MAX_INDIVIDUAL_VARIANCE);l<r&&(r=l,a=i)}if(a>=0)return a;throw new H}decodeRow(e,t,s){const r=s&&s.get(v.ASSUME_GS1)===!0,a=ne.findStartPattern(t),i=a[2];let o=0;const l=new Uint8Array(20);l[o++]=i;let u;switch(i){case ne.CODE_START_A:u=ne.CODE_CODE_A;break;case ne.CODE_START_B:u=ne.CODE_CODE_B;break;case ne.CODE_START_C:u=ne.CODE_CODE_C;break;default:throw new T}let m=!1,w=!1,b="",E=a[0],_=a[1];const O=Int32Array.from([0,0,0,0,0,0]);let k=0,G=0,ee=i,te=0,$=!0,ve=!1,be=!1;for(;!m;){const ks=w;switch(w=!1,k=G,G=ne.decodeCode(t,O,_),l[o++]=G,G!==ne.CODE_STOP&&($=!0),G!==ne.CODE_STOP&&(te++,ee+=te*G),E=_,_+=O.reduce((xi,mi)=>xi+mi,0),G){case ne.CODE_START_A:case ne.CODE_START_B:case ne.CODE_START_C:throw new T}switch(u){case ne.CODE_CODE_A:if(G<64)be===ve?b+=String.fromCharCode(32+G):b+=String.fromCharCode(32+G+128),be=!1;else if(G<96)be===ve?b+=String.fromCharCode(G-64):b+=String.fromCharCode(G+64),be=!1;else switch(G!==ne.CODE_STOP&&($=!1),G){case ne.CODE_FNC_1:r&&(b.length===0?b+="]C1":b+="");break;case ne.CODE_FNC_2:case ne.CODE_FNC_3:break;case ne.CODE_FNC_4_A:!ve&&be?(ve=!0,be=!1):ve&&be?(ve=!1,be=!1):be=!0;break;case ne.CODE_SHIFT:w=!0,u=ne.CODE_CODE_B;break;case ne.CODE_CODE_B:u=ne.CODE_CODE_B;break;case ne.CODE_CODE_C:u=ne.CODE_CODE_C;break;case ne.CODE_STOP:m=!0;break}break;case ne.CODE_CODE_B:if(G<96)be===ve?b+=String.fromCharCode(32+G):b+=String.fromCharCode(32+G+128),be=!1;else switch(G!==ne.CODE_STOP&&($=!1),G){case ne.CODE_FNC_1:r&&(b.length===0?b+="]C1":b+="");break;case ne.CODE_FNC_2:case ne.CODE_FNC_3:break;case ne.CODE_FNC_4_B:!ve&&be?(ve=!0,be=!1):ve&&be?(ve=!1,be=!1):be=!0;break;case ne.CODE_SHIFT:w=!0,u=ne.CODE_CODE_A;break;case ne.CODE_CODE_A:u=ne.CODE_CODE_A;break;case ne.CODE_CODE_C:u=ne.CODE_CODE_C;break;case ne.CODE_STOP:m=!0;break}break;case ne.CODE_CODE_C:if(G<100)G<10&&(b+="0"),b+=G;else switch(G!==ne.CODE_STOP&&($=!1),G){case ne.CODE_FNC_1:r&&(b.length===0?b+="]C1":b+="");break;case ne.CODE_CODE_A:u=ne.CODE_CODE_A;break;case ne.CODE_CODE_B:u=ne.CODE_CODE_B;break;case ne.CODE_STOP:m=!0;break}break}ks&&(u=u===ne.CODE_CODE_A?ne.CODE_CODE_B:ne.CODE_CODE_A)}const jt=_-E;if(_=t.getNextUnset(_),!t.isRange(_,Math.min(t.getSize(),_+(_-E)/2),!1))throw new H;if(ee-=te*k,ee%103!==k)throw new Q;const zt=b.length;if(zt===0)throw new H;zt>0&&$&&(u===ne.CODE_CODE_C?b=b.substring(0,zt-2):b=b.substring(0,zt-1));const It=(a[1]+a[0])/2,Ue=E+jt/2,xt=l.length,Tt=new Uint8Array(xt);for(let ks=0;ks<xt;ks++)Tt[ks]=l[ks];const Rs=[new ce(It,e),new ce(Ue,e)];return new dt(b,Tt,0,Rs,xe.CODE_128,new Date().getTime())}}ne.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],ne.MAX_AVG_VARIANCE=.25,ne.MAX_INDIVIDUAL_VARIANCE=.7,ne.CODE_SHIFT=98,ne.CODE_CODE_C=99,ne.CODE_CODE_B=100,ne.CODE_CODE_A=101,ne.CODE_FNC_1=102,ne.CODE_FNC_2=97,ne.CODE_FNC_3=96,ne.CODE_FNC_4_A=101,ne.CODE_FNC_4_B=100,ne.CODE_START_A=103,ne.CODE_START_B=104,ne.CODE_START_C=105,ne.CODE_STOP=106;class nt extends st{constructor(e=!1,t=!1){super(),this.usingCheckDigit=e,this.extendedMode=t,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(e,t,s){let r=this.counters;r.fill(0),this.decodeRowResult="";let a=nt.findAsteriskPattern(t,r),i=t.getNextSet(a[1]),o=t.getSize(),l,u;do{nt.recordPattern(t,i,r);let O=nt.toNarrowWidePattern(r);if(O<0)throw new H;l=nt.patternToChar(O),this.decodeRowResult+=l,u=i;for(let k of r)i+=k;i=t.getNextSet(i)}while(l!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let m=0;for(let O of r)m+=O;let w=i-u-m;if(i!==o&&w*2<m)throw new H;if(this.usingCheckDigit){let O=this.decodeRowResult.length-1,k=0;for(let G=0;G<O;G++)k+=nt.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(G));if(this.decodeRowResult.charAt(O)!==nt.ALPHABET_STRING.charAt(k%43))throw new Q;this.decodeRowResult=this.decodeRowResult.substring(0,O)}if(this.decodeRowResult.length===0)throw new H;let b;this.extendedMode?b=nt.decodeExtended(this.decodeRowResult):b=this.decodeRowResult;let E=(a[1]+a[0])/2,_=u+m/2;return new dt(b,null,0,[new ce(E,e),new ce(_,e)],xe.CODE_39,new Date().getTime())}static findAsteriskPattern(e,t){let s=e.getSize(),r=e.getNextSet(0),a=0,i=r,o=!1,l=t.length;for(let u=r;u<s;u++)if(e.get(u)!==o)t[a]++;else{if(a===l-1){if(this.toNarrowWidePattern(t)===nt.ASTERISK_ENCODING&&e.isRange(Math.max(0,i-Math.floor((u-i)/2)),i,!1))return[i,u];i+=t[0]+t[1],t.copyWithin(0,2,2+a-1),t[a-1]=0,t[a]=0,a--}else a++;t[a]=1,o=!o}throw new H}static toNarrowWidePattern(e){let t=e.length,s=0,r;do{let a=2147483647;for(let l of e)l<a&&l>s&&(a=l);s=a,r=0;let i=0,o=0;for(let l=0;l<t;l++){let u=e[l];u>s&&(o|=1<<t-1-l,r++,i+=u)}if(r===3){for(let l=0;l<t&&r>0;l++){let u=e[l];if(u>s&&(r--,u*2>=i))return-1}return o}}while(r>3);return-1}static patternToChar(e){for(let t=0;t<nt.CHARACTER_ENCODINGS.length;t++)if(nt.CHARACTER_ENCODINGS[t]===e)return nt.ALPHABET_STRING.charAt(t);if(e===nt.ASTERISK_ENCODING)return"*";throw new H}static decodeExtended(e){let t=e.length,s="";for(let r=0;r<t;r++){let a=e.charAt(r);if(a==="+"||a==="$"||a==="%"||a==="/"){let i=e.charAt(r+1),o="\0";switch(a){case"+":if(i>="A"&&i<="Z")o=String.fromCharCode(i.charCodeAt(0)+32);else throw new T;break;case"$":if(i>="A"&&i<="Z")o=String.fromCharCode(i.charCodeAt(0)-64);else throw new T;break;case"%":if(i>="A"&&i<="E")o=String.fromCharCode(i.charCodeAt(0)-38);else if(i>="F"&&i<="J")o=String.fromCharCode(i.charCodeAt(0)-11);else if(i>="K"&&i<="O")o=String.fromCharCode(i.charCodeAt(0)+16);else if(i>="P"&&i<="T")o=String.fromCharCode(i.charCodeAt(0)+43);else if(i==="U")o="\0";else if(i==="V")o="@";else if(i==="W")o="`";else if(i==="X"||i==="Y"||i==="Z")o="";else throw new T;break;case"/":if(i>="A"&&i<="O")o=String.fromCharCode(i.charCodeAt(0)-32);else if(i==="Z")o=":";else throw new T;break}s+=o,r++}else s+=a}return s}}nt.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",nt.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],nt.ASTERISK_ENCODING=148;class Pe extends st{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(e,t,s){let r=this.decodeStart(t),a=this.decodeEnd(t),i=new ae;Pe.decodeMiddle(t,r[1],a[0],i);let o=i.toString(),l=null;s!=null&&(l=s.get(v.ALLOWED_LENGTHS)),l==null&&(l=Pe.DEFAULT_ALLOWED_LENGTHS);let u=o.length,m=!1,w=0;for(let _ of l){if(u===_){m=!0;break}_>w&&(w=_)}if(!m&&u>w&&(m=!0),!m)throw new T;const b=[new ce(r[1],e),new ce(a[0],e)];return new dt(o,null,0,b,xe.ITF,new Date().getTime())}static decodeMiddle(e,t,s,r){let a=new Int32Array(10),i=new Int32Array(5),o=new Int32Array(5);for(a.fill(0),i.fill(0),o.fill(0);t<s;){st.recordPattern(e,t,a);for(let u=0;u<5;u++){let m=2*u;i[u]=a[m],o[u]=a[m+1]}let l=Pe.decodeDigit(i);r.append(l.toString()),l=this.decodeDigit(o),r.append(l.toString()),a.forEach(function(u){t+=u})}}decodeStart(e){let t=Pe.skipWhiteSpace(e),s=Pe.findGuardPattern(e,t,Pe.START_PATTERN);return this.narrowLineWidth=(s[1]-s[0])/4,this.validateQuietZone(e,s[0]),s}validateQuietZone(e,t){let s=this.narrowLineWidth*10;s=s<t?s:t;for(let r=t-1;s>0&&r>=0&&!e.get(r);r--)s--;if(s!==0)throw new H}static skipWhiteSpace(e){const t=e.getSize(),s=e.getNextSet(0);if(s===t)throw new H;return s}decodeEnd(e){e.reverse();try{let t=Pe.skipWhiteSpace(e),s;try{s=Pe.findGuardPattern(e,t,Pe.END_PATTERN_REVERSED[0])}catch(a){a instanceof H&&(s=Pe.findGuardPattern(e,t,Pe.END_PATTERN_REVERSED[1]))}this.validateQuietZone(e,s[0]);let r=s[0];return s[0]=e.getSize()-s[1],s[1]=e.getSize()-r,s}finally{e.reverse()}}static findGuardPattern(e,t,s){let r=s.length,a=new Int32Array(r),i=e.getSize(),o=!1,l=0,u=t;a.fill(0);for(let m=t;m<i;m++)if(e.get(m)!==o)a[l]++;else{if(l===r-1){if(st.patternMatchVariance(a,s,Pe.MAX_INDIVIDUAL_VARIANCE)<Pe.MAX_AVG_VARIANCE)return[u,m];u+=a[0]+a[1],U.arraycopy(a,2,a,0,l-1),a[l-1]=0,a[l]=0,l--}else l++;a[l]=1,o=!o}throw new H}static decodeDigit(e){let t=Pe.MAX_AVG_VARIANCE,s=-1,r=Pe.PATTERNS.length;for(let a=0;a<r;a++){let i=Pe.PATTERNS[a],o=st.patternMatchVariance(e,i,Pe.MAX_INDIVIDUAL_VARIANCE);o<t?(t=o,s=a):o===t&&(s=-1)}if(s>=0)return s%10;throw new H}}Pe.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Pe.MAX_AVG_VARIANCE=.38,Pe.MAX_INDIVIDUAL_VARIANCE=.5,Pe.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Pe.START_PATTERN=Int32Array.from([1,1,1,1]),Pe.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Ze extends st{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(e){let t=!1,s,r=0,a=Int32Array.from([0,0,0]);for(;!t;){a=Int32Array.from([0,0,0]),s=Ze.findGuardPattern(e,r,!1,this.START_END_PATTERN,a);let i=s[0];r=s[1];let o=i-(r-i);o>=0&&(t=e.isRange(o,i,!1))}return s}static checkChecksum(e){return Ze.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(t===0)return!1;let s=parseInt(e.charAt(t-1),10);return Ze.getStandardUPCEANChecksum(e.substring(0,t-1))===s}static getStandardUPCEANChecksum(e){let t=e.length,s=0;for(let r=t-1;r>=0;r-=2){let a=e.charAt(r).charCodeAt(0)-48;if(a<0||a>9)throw new T;s+=a}s*=3;for(let r=t-2;r>=0;r-=2){let a=e.charAt(r).charCodeAt(0)-48;if(a<0||a>9)throw new T;s+=a}return(1e3-s)%10}static decodeEnd(e,t){return Ze.findGuardPattern(e,t,!1,Ze.START_END_PATTERN,new Int32Array(Ze.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(e,t,s,r){return this.findGuardPattern(e,t,s,r,new Int32Array(r.length))}static findGuardPattern(e,t,s,r,a){let i=e.getSize();t=s?e.getNextUnset(t):e.getNextSet(t);let o=0,l=t,u=r.length,m=s;for(let w=t;w<i;w++)if(e.get(w)!==m)a[o]++;else{if(o===u-1){if(st.patternMatchVariance(a,r,Ze.MAX_INDIVIDUAL_VARIANCE)<Ze.MAX_AVG_VARIANCE)return Int32Array.from([l,w]);l+=a[0]+a[1];let b=a.slice(2,a.length-1);for(let E=0;E<o-1;E++)a[E]=b[E];a[o-1]=0,a[o]=0,o--}else o++;a[o]=1,m=!m}throw new H}static decodeDigit(e,t,s,r){this.recordPattern(e,s,t);let a=this.MAX_AVG_VARIANCE,i=-1,o=r.length;for(let l=0;l<o;l++){let u=r[l],m=st.patternMatchVariance(t,u,Ze.MAX_INDIVIDUAL_VARIANCE);m<a&&(a=m,i=l)}if(i>=0)return i;throw new H}}Ze.MAX_AVG_VARIANCE=.48,Ze.MAX_INDIVIDUAL_VARIANCE=.7,Ze.START_END_PATTERN=Int32Array.from([1,1,1]),Ze.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Ze.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Ze.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Vs{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,t,s){let r=this.decodeRowStringBuffer,a=this.decodeMiddle(t,s,r),i=r.toString(),o=Vs.parseExtensionString(i),l=[new ce((s[0]+s[1])/2,e),new ce(a,e)],u=new dt(i,null,0,l,xe.UPC_EAN_EXTENSION,new Date().getTime());return o!=null&&u.putAllMetadata(o),u}decodeMiddle(e,t,s){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let a=e.getSize(),i=t[1],o=0;for(let u=0;u<5&&i<a;u++){let m=Ze.decodeDigit(e,r,i,Ze.L_AND_G_PATTERNS);s+=String.fromCharCode(48+m%10);for(let w of r)i+=w;m>=10&&(o|=1<<4-u),u!==4&&(i=e.getNextSet(i),i=e.getNextUnset(i))}if(s.length!==5)throw new H;let l=this.determineCheckDigit(o);if(Vs.extensionChecksum(s.toString())!==l)throw new H;return i}static extensionChecksum(e){let t=e.length,s=0;for(let r=t-2;r>=0;r-=2)s+=e.charAt(r).charCodeAt(0)-48;s*=3;for(let r=t-1;r>=0;r-=2)s+=e.charAt(r).charCodeAt(0)-48;return s*=3,s%10}determineCheckDigit(e){for(let t=0;t<10;t++)if(e===this.CHECK_DIGIT_ENCODINGS[t])return t;throw new H}static parseExtensionString(e){if(e.length!==5)return null;let t=Vs.parseExtension5String(e);return t==null?null:new Map([[ot.SUGGESTED_PRICE,t]])}static parseExtension5String(e){let t;switch(e.charAt(0)){case"0":t="";break;case"5":t="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}t="";break;default:t="";break}let s=parseInt(e.substring(1)),r=(s/100).toString(),a=s%100,i=a<10?"0"+a:a.toString();return t+r+"."+i}}class Dn{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,t,s){let r=this.decodeRowStringBuffer,a=this.decodeMiddle(t,s,r),i=r.toString(),o=Dn.parseExtensionString(i),l=[new ce((s[0]+s[1])/2,e),new ce(a,e)],u=new dt(i,null,0,l,xe.UPC_EAN_EXTENSION,new Date().getTime());return o!=null&&u.putAllMetadata(o),u}decodeMiddle(e,t,s){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let a=e.getSize(),i=t[1],o=0;for(let l=0;l<2&&i<a;l++){let u=Ze.decodeDigit(e,r,i,Ze.L_AND_G_PATTERNS);s+=String.fromCharCode(48+u%10);for(let m of r)i+=m;u>=10&&(o|=1<<1-l),l!==1&&(i=e.getNextSet(i),i=e.getNextUnset(i))}if(s.length!==2)throw new H;if(parseInt(s.toString())%4!==o)throw new H;return i}static parseExtensionString(e){return e.length!==2?null:new Map([[ot.ISSUE_NUMBER,parseInt(e)]])}}class pr{static decodeRow(e,t,s){let r=Ze.findGuardPattern(t,s,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new Vs().decodeRow(e,t,r)}catch{return new Dn().decodeRow(e,t,r)}}}pr.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Me extends Ze{constructor(){super(),this.decodeRowStringBuffer="",Me.L_AND_G_PATTERNS=Me.L_PATTERNS.map(e=>Int32Array.from(e));for(let e=10;e<20;e++){let t=Me.L_PATTERNS[e-10],s=new Int32Array(t.length);for(let r=0;r<t.length;r++)s[r]=t[t.length-r-1];Me.L_AND_G_PATTERNS[e]=s}}decodeRow(e,t,s){let r=Me.findStartGuardPattern(t),a=s==null?null:s.get(v.NEED_RESULT_POINT_CALLBACK);if(a!=null){const $=new ce((r[0]+r[1])/2,e);a.foundPossibleResultPoint($)}let i=this.decodeMiddle(t,r,this.decodeRowStringBuffer),o=i.rowOffset,l=i.resultString;if(a!=null){const $=new ce(o,e);a.foundPossibleResultPoint($)}let u=this.decodeEnd(t,o);if(a!=null){const $=new ce((u[0]+u[1])/2,e);a.foundPossibleResultPoint($)}let m=u[1],w=m+(m-u[0]);if(w>=t.getSize()||!t.isRange(m,w,!1))throw new H;let b=l.toString();if(b.length<8)throw new T;if(!Me.checkChecksum(b))throw new Q;let E=(r[1]+r[0])/2,_=(u[1]+u[0])/2,O=this.getBarcodeFormat(),k=[new ce(E,e),new ce(_,e)],G=new dt(b,null,0,k,O,new Date().getTime()),ee=0;try{let $=pr.decodeRow(e,t,u[1]);G.putMetadata(ot.UPC_EAN_EXTENSION,$.getText()),G.putAllMetadata($.getResultMetadata()),G.addResultPoints($.getResultPoints()),ee=$.getText().length}catch{}let te=s==null?null:s.get(v.ALLOWED_EAN_EXTENSIONS);if(te!=null){let $=!1;for(let ve in te)if(ee.toString()===ve){$=!0;break}if(!$)throw new H}return G}decodeEnd(e,t){return Me.findGuardPattern(e,t,!1,Me.START_END_PATTERN,new Int32Array(Me.START_END_PATTERN.length).fill(0))}static checkChecksum(e){return Me.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(t===0)return!1;let s=parseInt(e.charAt(t-1),10);return Me.getStandardUPCEANChecksum(e.substring(0,t-1))===s}static getStandardUPCEANChecksum(e){let t=e.length,s=0;for(let r=t-1;r>=0;r-=2){let a=e.charAt(r).charCodeAt(0)-48;if(a<0||a>9)throw new T;s+=a}s*=3;for(let r=t-2;r>=0;r-=2){let a=e.charAt(r).charCodeAt(0)-48;if(a<0||a>9)throw new T;s+=a}return(1e3-s)%10}}class ps extends Me{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,t,s){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let a=e.getSize(),i=t[1],o=0;for(let u=0;u<6&&i<a;u++){let m=Me.decodeDigit(e,r,i,Me.L_AND_G_PATTERNS);s+=String.fromCharCode(48+m%10);for(let w of r)i+=w;m>=10&&(o|=1<<5-u)}s=ps.determineFirstDigit(s,o),i=Me.findGuardPattern(e,i,!0,Me.MIDDLE_PATTERN,new Int32Array(Me.MIDDLE_PATTERN.length).fill(0))[1];for(let u=0;u<6&&i<a;u++){let m=Me.decodeDigit(e,r,i,Me.L_PATTERNS);s+=String.fromCharCode(48+m);for(let w of r)i+=w}return{rowOffset:i,resultString:s}}getBarcodeFormat(){return xe.EAN_13}static determineFirstDigit(e,t){for(let s=0;s<10;s++)if(t===this.FIRST_DIGIT_ENCODINGS[s])return e=String.fromCharCode(48+s)+e,e;throw new H}}ps.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class yr extends Me{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,t,s){const r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let a=e.getSize(),i=t[1];for(let l=0;l<4&&i<a;l++){let u=Me.decodeDigit(e,r,i,Me.L_PATTERNS);s+=String.fromCharCode(48+u);for(let m of r)i+=m}i=Me.findGuardPattern(e,i,!0,Me.MIDDLE_PATTERN,new Int32Array(Me.MIDDLE_PATTERN.length).fill(0))[1];for(let l=0;l<4&&i<a;l++){let u=Me.decodeDigit(e,r,i,Me.L_PATTERNS);s+=String.fromCharCode(48+u);for(let m of r)i+=m}return{rowOffset:i,resultString:s}}getBarcodeFormat(){return xe.EAN_8}}class wr extends Me{constructor(){super(...arguments),this.ean13Reader=new ps}getBarcodeFormat(){return xe.UPC_A}decode(e,t){return this.maybeReturnResult(this.ean13Reader.decode(e))}decodeRow(e,t,s){return this.maybeReturnResult(this.ean13Reader.decodeRow(e,t,s))}decodeMiddle(e,t,s){return this.ean13Reader.decodeMiddle(e,t,s)}maybeReturnResult(e){let t=e.getText();if(t.charAt(0)==="0"){let s=new dt(t.substring(1),null,null,e.getResultPoints(),xe.UPC_A);return e.getResultMetadata()!=null&&s.putAllMetadata(e.getResultMetadata()),s}else throw new H}reset(){this.ean13Reader.reset()}}class Ht extends Me{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(e,t,s){const r=this.decodeMiddleCounters.map(u=>u);r[0]=0,r[1]=0,r[2]=0,r[3]=0;const a=e.getSize();let i=t[1],o=0;for(let u=0;u<6&&i<a;u++){const m=Ht.decodeDigit(e,r,i,Ht.L_AND_G_PATTERNS);s+=String.fromCharCode(48+m%10);for(let w of r)i+=w;m>=10&&(o|=1<<5-u)}let l=Ht.determineNumSysAndCheckDigit(s,o);return{rowOffset:i,resultString:l}}decodeEnd(e,t){return Ht.findGuardPatternWithoutCounters(e,t,!0,Ht.MIDDLE_END_PATTERN)}checkChecksum(e){return Me.checkChecksum(Ht.convertUPCEtoUPCA(e))}static determineNumSysAndCheckDigit(e,t){for(let s=0;s<=1;s++)for(let r=0;r<10;r++)if(t===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[s][r]){let a=String.fromCharCode(48+s),i=String.fromCharCode(48+r);return a+e+i}throw H.getNotFoundInstance()}getBarcodeFormat(){return xe.UPC_E}static convertUPCEtoUPCA(e){const t=e.slice(1,7).split("").map(a=>a.charCodeAt(0)),s=new ae;s.append(e.charAt(0));let r=t[5];switch(r){case 0:case 1:case 2:s.appendChars(t,0,2),s.append(r),s.append("0000"),s.appendChars(t,2,3);break;case 3:s.appendChars(t,0,3),s.append("00000"),s.appendChars(t,3,2);break;case 4:s.appendChars(t,0,4),s.append("00000"),s.append(t[4]);break;default:s.appendChars(t,0,5),s.append("0000"),s.append(r);break}return e.length>=8&&s.append(e.charAt(7)),s.toString()}}Ht.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Ht.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class On extends st{constructor(e){super();let t=e==null?null:e.get(v.POSSIBLE_FORMATS),s=[];x(t)?(s.push(new ps),s.push(new wr),s.push(new yr),s.push(new Ht)):(t.indexOf(xe.EAN_13)>-1&&s.push(new ps),t.indexOf(xe.UPC_A)>-1&&s.push(new wr),t.indexOf(xe.EAN_8)>-1&&s.push(new yr),t.indexOf(xe.UPC_E)>-1&&s.push(new Ht)),this.readers=s}decodeRow(e,t,s){for(let r of this.readers)try{const a=r.decodeRow(e,t,s),i=a.getBarcodeFormat()===xe.EAN_13&&a.getText().charAt(0)==="0",o=s==null?null:s.get(v.POSSIBLE_FORMATS),l=o==null||o.includes(xe.UPC_A);if(i&&l){const u=a.getRawBytes(),m=new dt(a.getText().substring(1),u,u?u.length:null,a.getResultPoints(),xe.UPC_A);return m.putAllMetadata(a.getResultMetadata()),m}return a}catch{}throw new H}reset(){for(let e of this.readers)e.reset()}}class gt extends st{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(e,t){for(let s=0;s<t.length;s++)if(st.patternMatchVariance(e,t[s],gt.MAX_INDIVIDUAL_VARIANCE)<gt.MAX_AVG_VARIANCE)return s;throw new H}static count(e){return Ie.sum(new Int32Array(e))}static increment(e,t){let s=0,r=t[0];for(let a=1;a<e.length;a++)t[a]>r&&(r=t[a],s=a);e[s]++}static decrement(e,t){let s=0,r=t[0];for(let a=1;a<e.length;a++)t[a]<r&&(r=t[a],s=a);e[s]--}static isFinderPattern(e){let t=e[0]+e[1],s=t+e[2]+e[3],r=t/s;if(r>=gt.MIN_FINDER_PATTERN_RATIO&&r<=gt.MAX_FINDER_PATTERN_RATIO){let a=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER;for(let o of e)o>i&&(i=o),o<a&&(a=o);return i<10*a}return!1}}gt.MAX_AVG_VARIANCE=.2,gt.MAX_INDIVIDUAL_VARIANCE=.45,gt.MIN_FINDER_PATTERN_RATIO=9.5/12,gt.MAX_FINDER_PATTERN_RATIO=12.5/14;class js{constructor(e,t){this.value=e,this.checksumPortion=t}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(e){if(!(e instanceof js))return!1;const t=e;return this.value===t.value&&this.checksumPortion===t.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class an{constructor(e,t,s,r,a){this.value=e,this.startEnd=t,this.value=e,this.startEnd=t,this.resultPoints=new Array,this.resultPoints.push(new ce(s,a)),this.resultPoints.push(new ce(r,a))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(e){if(!(e instanceof an))return!1;const t=e;return this.value===t.value}hashCode(){return this.value}}class Yt{constructor(){}static getRSSvalue(e,t,s){let r=0;for(let l of e)r+=l;let a=0,i=0,o=e.length;for(let l=0;l<o-1;l++){let u;for(u=1,i|=1<<l;u<e[l];u++,i&=~(1<<l)){let m=Yt.combins(r-u-1,o-l-2);if(s&&i===0&&r-u-(o-l-1)>=o-l-1&&(m-=Yt.combins(r-u-(o-l),o-l-2)),o-l-1>1){let w=0;for(let b=r-u-(o-l-2);b>t;b--)w+=Yt.combins(r-u-b-1,o-l-3);m-=w*(o-1-l)}else r-u>t&&m--;a+=m}r-=u}return a}static combins(e,t){let s,r;e-t>t?(r=t,s=e-t):(r=e-t,s=t);let a=1,i=1;for(let o=e;o>s;o--)a*=o,i<=r&&(a/=i,i++);for(;i<=r;)a/=i,i++;return a}}class Ua{static buildBitArray(e){let t=e.length*2-1;e[e.length-1].getRightChar()==null&&(t-=1);let s=12*t,r=new Y(s),a=0,o=e[0].getRightChar().getValue();for(let l=11;l>=0;--l)o&1<<l&&r.set(a),a++;for(let l=1;l<e.length;++l){let u=e[l],m=u.getLeftChar().getValue();for(let w=11;w>=0;--w)m&1<<w&&r.set(a),a++;if(u.getRightChar()!=null){let w=u.getRightChar().getValue();for(let b=11;b>=0;--b)w&1<<b&&r.set(a),a++}}return r}}class ys{constructor(e,t){t?this.decodedInformation=null:(this.finished=e,this.decodedInformation=t)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Rn{constructor(e){this.newPosition=e}getNewPosition(){return this.newPosition}}class Et extends Rn{constructor(e,t){super(e),this.value=t}getValue(){return this.value}isFNC1(){return this.value===Et.FNC1}}Et.FNC1="$";class ws extends Rn{constructor(e,t,s){super(e),s?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=t}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class kt extends Rn{constructor(e,t,s){if(super(e),t<0||t>10||s<0||s>10)throw new T;this.firstDigit=t,this.secondDigit=s}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===kt.FNC1}isSecondDigitFNC1(){return this.secondDigit===kt.FNC1}isAnyFNC1(){return this.firstDigit===kt.FNC1||this.secondDigit===kt.FNC1}}kt.FNC1=10;class ie{constructor(){}static parseFieldsInGeneralPurpose(e){if(!e)return null;if(e.length<2)throw new H;let t=e.substring(0,2);for(let a of ie.TWO_DIGIT_DATA_LENGTH)if(a[0]===t)return a[1]===ie.VARIABLE_LENGTH?ie.processVariableAI(2,a[2],e):ie.processFixedAI(2,a[1],e);if(e.length<3)throw new H;let s=e.substring(0,3);for(let a of ie.THREE_DIGIT_DATA_LENGTH)if(a[0]===s)return a[1]===ie.VARIABLE_LENGTH?ie.processVariableAI(3,a[2],e):ie.processFixedAI(3,a[1],e);for(let a of ie.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(a[0]===s)return a[1]===ie.VARIABLE_LENGTH?ie.processVariableAI(4,a[2],e):ie.processFixedAI(4,a[1],e);if(e.length<4)throw new H;let r=e.substring(0,4);for(let a of ie.FOUR_DIGIT_DATA_LENGTH)if(a[0]===r)return a[1]===ie.VARIABLE_LENGTH?ie.processVariableAI(4,a[2],e):ie.processFixedAI(4,a[1],e);throw new H}static processFixedAI(e,t,s){if(s.length<e)throw new H;let r=s.substring(0,e);if(s.length<e+t)throw new H;let a=s.substring(e,e+t),i=s.substring(e+t),o="("+r+")"+a,l=ie.parseFieldsInGeneralPurpose(i);return l==null?o:o+l}static processVariableAI(e,t,s){let r=s.substring(0,e),a;s.length<e+t?a=s.length:a=e+t;let i=s.substring(e,a),o=s.substring(a),l="("+r+")"+i,u=ie.parseFieldsInGeneralPurpose(o);return u==null?l:l+u}}ie.VARIABLE_LENGTH=[],ie.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",ie.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",ie.VARIABLE_LENGTH,20],["22",ie.VARIABLE_LENGTH,29],["30",ie.VARIABLE_LENGTH,8],["37",ie.VARIABLE_LENGTH,8],["90",ie.VARIABLE_LENGTH,30],["91",ie.VARIABLE_LENGTH,30],["92",ie.VARIABLE_LENGTH,30],["93",ie.VARIABLE_LENGTH,30],["94",ie.VARIABLE_LENGTH,30],["95",ie.VARIABLE_LENGTH,30],["96",ie.VARIABLE_LENGTH,30],["97",ie.VARIABLE_LENGTH,3],["98",ie.VARIABLE_LENGTH,30],["99",ie.VARIABLE_LENGTH,30]],ie.THREE_DIGIT_DATA_LENGTH=[["240",ie.VARIABLE_LENGTH,30],["241",ie.VARIABLE_LENGTH,30],["242",ie.VARIABLE_LENGTH,6],["250",ie.VARIABLE_LENGTH,30],["251",ie.VARIABLE_LENGTH,30],["253",ie.VARIABLE_LENGTH,17],["254",ie.VARIABLE_LENGTH,20],["400",ie.VARIABLE_LENGTH,30],["401",ie.VARIABLE_LENGTH,30],["402",17],["403",ie.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",ie.VARIABLE_LENGTH,20],["421",ie.VARIABLE_LENGTH,15],["422",3],["423",ie.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],ie.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",ie.VARIABLE_LENGTH,15],["391",ie.VARIABLE_LENGTH,18],["392",ie.VARIABLE_LENGTH,15],["393",ie.VARIABLE_LENGTH,18],["703",ie.VARIABLE_LENGTH,30]],ie.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",ie.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",ie.VARIABLE_LENGTH,20],["8003",ie.VARIABLE_LENGTH,30],["8004",ie.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",ie.VARIABLE_LENGTH,30],["8008",ie.VARIABLE_LENGTH,12],["8018",18],["8020",ie.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",ie.VARIABLE_LENGTH,70],["8200",ie.VARIABLE_LENGTH,70]];class Is{constructor(e){this.buffer=new ae,this.information=e}decodeAllCodes(e,t){let s=t,r=null;do{let a=this.decodeGeneralPurposeField(s,r),i=ie.parseFieldsInGeneralPurpose(a.getNewString());if(i!=null&&e.append(i),a.isRemaining()?r=""+a.getRemainingValue():r=null,s===a.getNewPosition())break;s=a.getNewPosition()}while(!0);return e.toString()}isStillNumeric(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(let t=e;t<e+3;++t)if(this.information.get(t))return!0;return this.information.get(e+3)}decodeNumeric(e){if(e+7>this.information.getSize()){let a=this.extractNumericValueFromBitArray(e,4);return a===0?new kt(this.information.getSize(),kt.FNC1,kt.FNC1):new kt(this.information.getSize(),a-1,kt.FNC1)}let t=this.extractNumericValueFromBitArray(e,7),s=(t-8)/11,r=(t-8)%11;return new kt(e+7,s,r)}extractNumericValueFromBitArray(e,t){return Is.extractNumericValueFromBitArray(this.information,e,t)}static extractNumericValueFromBitArray(e,t,s){let r=0;for(let a=0;a<s;++a)e.get(t+a)&&(r|=1<<s-a-1);return r}decodeGeneralPurposeField(e,t){this.buffer.setLengthToZero(),t!=null&&this.buffer.append(t),this.current.setPosition(e);let s=this.parseBlocks();return s!=null&&s.isRemaining()?new ws(this.current.getPosition(),this.buffer.toString(),s.getRemainingValue()):new ws(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let e,t;do{let s=this.current.getPosition();if(this.current.isAlpha()?(t=this.parseAlphaBlock(),e=t.isFinished()):this.current.isIsoIec646()?(t=this.parseIsoIec646Block(),e=t.isFinished()):(t=this.parseNumericBlock(),e=t.isFinished()),!(s!==this.current.getPosition())&&!e)break}while(!e);return t.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){let t;return e.isSecondDigitFNC1()?t=new ws(this.current.getPosition(),this.buffer.toString()):t=new ws(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new ys(!0,t)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){let t=new ws(this.current.getPosition(),this.buffer.toString());return new ys(!0,t)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new ys(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let t=new ws(this.current.getPosition(),this.buffer.toString());return new ys(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new ys(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let t=new ws(this.current.getPosition(),this.buffer.toString());return new ys(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new ys(!1)}isStillIsoIec646(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+7>this.information.getSize())return!1;let s=this.extractNumericValueFromBitArray(e,7);if(s>=64&&s<116)return!0;if(e+8>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(e,8);return r>=232&&r<253}decodeIsoIec646(e){let t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new Et(e+5,Et.FNC1);if(t>=5&&t<15)return new Et(e+5,"0"+(t-5));let s=this.extractNumericValueFromBitArray(e,7);if(s>=64&&s<90)return new Et(e+7,""+(s+1));if(s>=90&&s<116)return new Et(e+7,""+(s+7));let r=this.extractNumericValueFromBitArray(e,8),a;switch(r){case 232:a="!";break;case 233:a='"';break;case 234:a="%";break;case 235:a="&";break;case 236:a="'";break;case 237:a="(";break;case 238:a=")";break;case 239:a="*";break;case 240:a="+";break;case 241:a=",";break;case 242:a="-";break;case 243:a=".";break;case 244:a="/";break;case 245:a=":";break;case 246:a=";";break;case 247:a="<";break;case 248:a="=";break;case 249:a=">";break;case 250:a="?";break;case 251:a="_";break;case 252:a=" ";break;default:throw new T}return new Et(e+8,a)}isStillAlpha(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+6>this.information.getSize())return!1;let s=this.extractNumericValueFromBitArray(e,6);return s>=16&&s<63}decodeAlphanumeric(e){let t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new Et(e+5,Et.FNC1);if(t>=5&&t<15)return new Et(e+5,"0"+(t-5));let s=this.extractNumericValueFromBitArray(e,6);if(s>=32&&s<58)return new Et(e+6,""+(s+33));let r;switch(s){case 58:r="*";break;case 59:r=",";break;case 60:r="-";break;case 61:r=".";break;case 62:r="/";break;default:throw new Wt("Decoding invalid alphanumeric value: "+s)}return new Et(e+6,r)}isAlphaTo646ToAlphaLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<5&&t+e<this.information.getSize();++t)if(t===2){if(!this.information.get(e+2))return!1}else if(this.information.get(e+t))return!1;return!0}isAlphaOr646ToNumericLatch(e){if(e+3>this.information.getSize())return!1;for(let t=e;t<e+3;++t)if(this.information.get(t))return!1;return!0}isNumericToAlphaNumericLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<4&&t+e<this.information.getSize();++t)if(this.information.get(e+t))return!1;return!0}}class kn{constructor(e){this.information=e,this.generalDecoder=new Is(e)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class vt extends kn{constructor(e){super(e)}encodeCompressedGtin(e,t){e.append("(01)");let s=e.length();e.append("9"),this.encodeCompressedGtinWithoutAI(e,t,s)}encodeCompressedGtinWithoutAI(e,t,s){for(let r=0;r<4;++r){let a=this.getGeneralDecoder().extractNumericValueFromBitArray(t+10*r,10);a/100===0&&e.append("0"),a/10===0&&e.append("0"),e.append(a)}vt.appendCheckDigit(e,s)}static appendCheckDigit(e,t){let s=0;for(let r=0;r<13;r++){let a=e.charAt(r+t).charCodeAt(0)-48;s+=r&1?a:3*a}s=10-s%10,s===10&&(s=0),e.append(s)}}vt.GTIN_SIZE=40;class Ts extends vt{constructor(e){super(e)}parseInformation(){let e=new ae;e.append("(01)");let t=e.length(),s=this.getGeneralDecoder().extractNumericValueFromBitArray(Ts.HEADER_SIZE,4);return e.append(s),this.encodeCompressedGtinWithoutAI(e,Ts.HEADER_SIZE+4,t),this.getGeneralDecoder().decodeAllCodes(e,Ts.HEADER_SIZE+44)}}Ts.HEADER_SIZE=4;class on extends kn{constructor(e){super(e)}parseInformation(){let e=new ae;return this.getGeneralDecoder().decodeAllCodes(e,on.HEADER_SIZE)}}on.HEADER_SIZE=5;class ln extends vt{constructor(e){super(e)}encodeCompressedWeight(e,t,s){let r=this.getGeneralDecoder().extractNumericValueFromBitArray(t,s);this.addWeightCode(e,r);let a=this.checkWeight(r),i=1e5;for(let o=0;o<5;++o)a/i===0&&e.append("0"),i/=10;e.append(a)}}class Xt extends ln{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()!=Xt.HEADER_SIZE+ln.GTIN_SIZE+Xt.WEIGHT_SIZE)throw new H;let e=new ae;return this.encodeCompressedGtin(e,Xt.HEADER_SIZE),this.encodeCompressedWeight(e,Xt.HEADER_SIZE+ln.GTIN_SIZE,Xt.WEIGHT_SIZE),e.toString()}}Xt.HEADER_SIZE=5,Xt.WEIGHT_SIZE=15;class Ha extends Xt{constructor(e){super(e)}addWeightCode(e,t){e.append("(3103)")}checkWeight(e){return e}}class za extends Xt{constructor(e){super(e)}addWeightCode(e,t){t<1e4?e.append("(3202)"):e.append("(3203)")}checkWeight(e){return e<1e4?e:e-1e4}}class qt extends vt{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<qt.HEADER_SIZE+vt.GTIN_SIZE)throw new H;let e=new ae;this.encodeCompressedGtin(e,qt.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(qt.HEADER_SIZE+vt.GTIN_SIZE,qt.LAST_DIGIT_SIZE);e.append("(392"),e.append(t),e.append(")");let s=this.getGeneralDecoder().decodeGeneralPurposeField(qt.HEADER_SIZE+vt.GTIN_SIZE+qt.LAST_DIGIT_SIZE,null);return e.append(s.getNewString()),e.toString()}}qt.HEADER_SIZE=8,qt.LAST_DIGIT_SIZE=2;class bt extends vt{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<bt.HEADER_SIZE+vt.GTIN_SIZE)throw new H;let e=new ae;this.encodeCompressedGtin(e,bt.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(bt.HEADER_SIZE+vt.GTIN_SIZE,bt.LAST_DIGIT_SIZE);e.append("(393"),e.append(t),e.append(")");let s=this.getGeneralDecoder().extractNumericValueFromBitArray(bt.HEADER_SIZE+vt.GTIN_SIZE+bt.LAST_DIGIT_SIZE,bt.FIRST_THREE_DIGITS_SIZE);s/100==0&&e.append("0"),s/10==0&&e.append("0"),e.append(s);let r=this.getGeneralDecoder().decodeGeneralPurposeField(bt.HEADER_SIZE+vt.GTIN_SIZE+bt.LAST_DIGIT_SIZE+bt.FIRST_THREE_DIGITS_SIZE,null);return e.append(r.getNewString()),e.toString()}}bt.HEADER_SIZE=8,bt.LAST_DIGIT_SIZE=2,bt.FIRST_THREE_DIGITS_SIZE=10;class We extends ln{constructor(e,t,s){super(e),this.dateCode=s,this.firstAIdigits=t}parseInformation(){if(this.getInformation().getSize()!=We.HEADER_SIZE+We.GTIN_SIZE+We.WEIGHT_SIZE+We.DATE_SIZE)throw new H;let e=new ae;return this.encodeCompressedGtin(e,We.HEADER_SIZE),this.encodeCompressedWeight(e,We.HEADER_SIZE+We.GTIN_SIZE,We.WEIGHT_SIZE),this.encodeCompressedDate(e,We.HEADER_SIZE+We.GTIN_SIZE+We.WEIGHT_SIZE),e.toString()}encodeCompressedDate(e,t){let s=this.getGeneralDecoder().extractNumericValueFromBitArray(t,We.DATE_SIZE);if(s==38400)return;e.append("("),e.append(this.dateCode),e.append(")");let r=s%32;s/=32;let a=s%12+1;s/=12;let i=s;i/10==0&&e.append("0"),e.append(i),a/10==0&&e.append("0"),e.append(a),r/10==0&&e.append("0"),e.append(r)}addWeightCode(e,t){e.append("("),e.append(this.firstAIdigits),e.append(t/1e5),e.append(")")}checkWeight(e){return e%1e5}}We.HEADER_SIZE=8,We.WEIGHT_SIZE=20,We.DATE_SIZE=16;function br(y){try{if(y.get(1))return new Ts(y);if(!y.get(2))return new on(y);switch(Is.extractNumericValueFromBitArray(y,1,4)){case 4:return new Ha(y);case 5:return new za(y)}switch(Is.extractNumericValueFromBitArray(y,1,5)){case 12:return new qt(y);case 13:return new bt(y)}switch(Is.extractNumericValueFromBitArray(y,1,7)){case 56:return new We(y,"310","11");case 57:return new We(y,"320","11");case 58:return new We(y,"310","13");case 59:return new We(y,"320","13");case 60:return new We(y,"310","15");case 61:return new We(y,"320","15");case 62:return new We(y,"310","17");case 63:return new We(y,"320","17")}}catch(e){throw console.log(e),new Wt("unknown decoder: "+y)}}class os{constructor(e,t,s,r){this.leftchar=e,this.rightchar=t,this.finderpattern=s,this.maybeLast=r}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(e,t){return e instanceof os?os.equalsOrNull(e.leftchar,t.leftchar)&&os.equalsOrNull(e.rightchar,t.rightchar)&&os.equalsOrNull(e.finderpattern,t.finderpattern):!1}static equalsOrNull(e,t){return e===null?t===null:os.equals(e,t)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class Ln{constructor(e,t,s){this.pairs=e,this.rowNumber=t,this.wasReversed=s}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(e){return this.checkEqualitity(this,e)}toString(){return"{ "+this.pairs+" }"}equals(e,t){return e instanceof Ln?this.checkEqualitity(e,t)&&e.wasReversed===t.wasReversed:!1}checkEqualitity(e,t){if(!e||!t)return;let s;return e.forEach((r,a)=>{t.forEach(i=>{r.getLeftChar().getValue()===i.getLeftChar().getValue()&&r.getRightChar().getValue()===i.getRightChar().getValue()&&r.getFinderPatter().getValue()===i.getFinderPatter().getValue()&&(s=!0)})}),s}}class K extends gt{constructor(e){super(...arguments),this.pairs=new Array(K.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=e===!0}decodeRow(e,t,s){this.pairs.length=0,this.startFromEven=!1;try{return K.constructResult(this.decodeRow2pairs(e,t))}catch(r){this.verbose&&console.log(r)}return this.pairs.length=0,this.startFromEven=!0,K.constructResult(this.decodeRow2pairs(e,t))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(e,t){let s=!1;for(;!s;)try{this.pairs.push(this.retrieveNextPair(t,this.pairs,e))}catch(a){if(a instanceof H){if(!this.pairs.length)throw new H;s=!0}}if(this.checkChecksum())return this.pairs;let r;if(this.rows.length?r=!0:r=!1,this.storeRow(e,!1),r){let a=this.checkRowsBoolean(!1);if(a!=null||(a=this.checkRowsBoolean(!0),a!=null))return a}throw new H}checkRowsBoolean(e){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,e&&(this.rows=this.rows.reverse());let t=null;try{t=this.checkRows(new Array,0)}catch(s){this.verbose&&console.log(s)}return e&&(this.rows=this.rows.reverse()),t}checkRows(e,t){for(let s=t;s<this.rows.length;s++){let r=this.rows[s];this.pairs.length=0;for(let i of e)this.pairs.push(i.getPairs());if(this.pairs.push(r.getPairs()),!K.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let a=new Array(e);a.push(r);try{return this.checkRows(a,s+1)}catch(i){this.verbose&&console.log(i)}}throw new H}static isValidSequence(e){for(let t of K.FINDER_PATTERN_SEQUENCES){if(e.length>t.length)continue;let s=!0;for(let r=0;r<e.length;r++)if(e[r].getFinderPattern().getValue()!=t[r]){s=!1;break}if(s)return!0}return!1}storeRow(e,t){let s=0,r=!1,a=!1;for(;s<this.rows.length;){let i=this.rows[s];if(i.getRowNumber()>e){a=i.isEquivalent(this.pairs);break}r=i.isEquivalent(this.pairs),s++}a||r||K.isPartialRow(this.pairs,this.rows)||(this.rows.push(s,new Ln(this.pairs,e,t)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(e,t){for(let s of t)if(s.getPairs().length!==e.length){for(let r of s.getPairs())for(let a of e)if(os.equals(r,a))break}}static isPartialRow(e,t){for(let s of t){let r=!0;for(let a of e){let i=!1;for(let o of s.getPairs())if(a.equals(o)){i=!0;break}if(!i){r=!1;break}}if(r)return!0}return!1}getRows(){return this.rows}static constructResult(e){let t=Ua.buildBitArray(e),r=br(t).parseInformation(),a=e[0].getFinderPattern().getResultPoints(),i=e[e.length-1].getFinderPattern().getResultPoints(),o=[a[0],a[1],i[0],i[1]];return new dt(r,null,null,o,xe.RSS_EXPANDED,null)}checkChecksum(){let e=this.pairs.get(0),t=e.getLeftChar(),s=e.getRightChar();if(s==null)return!1;let r=s.getChecksumPortion(),a=2;for(let o=1;o<this.pairs.size();++o){let l=this.pairs.get(o);r+=l.getLeftChar().getChecksumPortion(),a++;let u=l.getRightChar();u!=null&&(r+=u.getChecksumPortion(),a++)}return r%=211,211*(a-4)+r==t.getValue()}static getNextSecondBar(e,t){let s;return e.get(t)?(s=e.getNextUnset(t),s=e.getNextSet(s)):(s=e.getNextSet(t),s=e.getNextUnset(s)),s}retrieveNextPair(e,t,s){let r=t.length%2==0;this.startFromEven&&(r=!r);let a,i=!0,o=-1;do this.findNextPair(e,t,o),a=this.parseFoundFinderPattern(e,s,r),a==null?o=K.getNextSecondBar(e,this.startEnd[0]):i=!1;while(i);let l=this.decodeDataCharacter(e,a,r,!0);if(!this.isEmptyPair(t)&&t[t.length-1].mustBeLast())throw new H;let u;try{u=this.decodeDataCharacter(e,a,r,!1)}catch(m){u=null,this.verbose&&console.log(m)}return new os(l,u,a,!0)}isEmptyPair(e){return e.length===0}findNextPair(e,t,s){let r=this.getDecodeFinderCounters();r[0]=0,r[1]=0,r[2]=0,r[3]=0;let a=e.getSize(),i;s>=0?i=s:this.isEmptyPair(t)?i=0:i=t[t.length-1].getFinderPattern().getStartEnd()[1];let o=t.length%2!=0;this.startFromEven&&(o=!o);let l=!1;for(;i<a&&(l=!e.get(i),!!l);)i++;let u=0,m=i;for(let w=i;w<a;w++)if(e.get(w)!=l)r[u]++;else{if(u==3){if(o&&K.reverseCounters(r),K.isFinderPattern(r)){this.startEnd[0]=m,this.startEnd[1]=w;return}o&&K.reverseCounters(r),m+=r[0]+r[1],r[0]=r[2],r[1]=r[3],r[2]=0,r[3]=0,u--}else u++;r[u]=1,l=!l}throw new H}static reverseCounters(e){let t=e.length;for(let s=0;s<t/2;++s){let r=e[s];e[s]=e[t-s-1],e[t-s-1]=r}}parseFoundFinderPattern(e,t,s){let r,a,i;if(s){let u=this.startEnd[0]-1;for(;u>=0&&!e.get(u);)u--;u++,r=this.startEnd[0]-u,a=u,i=this.startEnd[1]}else a=this.startEnd[0],i=e.getNextUnset(this.startEnd[1]+1),r=i-this.startEnd[1];let o=this.getDecodeFinderCounters();U.arraycopy(o,0,o,1,o.length-1),o[0]=r;let l;try{l=this.parseFinderValue(o,K.FINDER_PATTERNS)}catch{return null}return new an(l,[a,i],a,i,t)}decodeDataCharacter(e,t,s,r){let a=this.getDataCharacterCounters();for(let Ue=0;Ue<a.length;Ue++)a[Ue]=0;if(r)K.recordPatternInReverse(e,t.getStartEnd()[0],a);else{K.recordPattern(e,t.getStartEnd()[1],a);for(let Ue=0,xt=a.length-1;Ue<xt;Ue++,xt--){let Tt=a[Ue];a[Ue]=a[xt],a[xt]=Tt}}let i=17,o=Ie.sum(new Int32Array(a))/i,l=(t.getStartEnd()[1]-t.getStartEnd()[0])/15;if(Math.abs(o-l)/l>.3)throw new H;let u=this.getOddCounts(),m=this.getEvenCounts(),w=this.getOddRoundingErrors(),b=this.getEvenRoundingErrors();for(let Ue=0;Ue<a.length;Ue++){let xt=1*a[Ue]/o,Tt=xt+.5;if(Tt<1){if(xt<.3)throw new H;Tt=1}else if(Tt>8){if(xt>8.7)throw new H;Tt=8}let Rs=Ue/2;Ue&1?(m[Rs]=Tt,b[Rs]=xt-Tt):(u[Rs]=Tt,w[Rs]=xt-Tt)}this.adjustOddEvenCounts(i);let E=4*t.getValue()+(s?0:2)+(r?0:1)-1,_=0,O=0;for(let Ue=u.length-1;Ue>=0;Ue--){if(K.isNotA1left(t,s,r)){let xt=K.WEIGHTS[E][2*Ue];O+=u[Ue]*xt}_+=u[Ue]}let k=0;for(let Ue=m.length-1;Ue>=0;Ue--)if(K.isNotA1left(t,s,r)){let xt=K.WEIGHTS[E][2*Ue+1];k+=m[Ue]*xt}let G=O+k;if(_&1||_>13||_<4)throw new H;let ee=(13-_)/2,te=K.SYMBOL_WIDEST[ee],$=9-te,ve=Yt.getRSSvalue(u,te,!0),be=Yt.getRSSvalue(m,$,!1),jt=K.EVEN_TOTAL_SUBSET[ee],zt=K.GSUM[ee],It=ve*jt+be+zt;return new js(It,G)}static isNotA1left(e,t,s){return!(e.getValue()==0&&t&&s)}adjustOddEvenCounts(e){let t=Ie.sum(new Int32Array(this.getOddCounts())),s=Ie.sum(new Int32Array(this.getEvenCounts())),r=!1,a=!1;t>13?a=!0:t<4&&(r=!0);let i=!1,o=!1;s>13?o=!0:s<4&&(i=!0);let l=t+s-e,u=(t&1)==1,m=(s&1)==0;if(l==1)if(u){if(m)throw new H;a=!0}else{if(!m)throw new H;o=!0}else if(l==-1)if(u){if(m)throw new H;r=!0}else{if(!m)throw new H;i=!0}else if(l==0){if(u){if(!m)throw new H;t<s?(r=!0,o=!0):(a=!0,i=!0)}else if(m)throw new H}else throw new H;if(r){if(a)throw new H;K.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(a&&K.decrement(this.getOddCounts(),this.getOddRoundingErrors()),i){if(o)throw new H;K.increment(this.getEvenCounts(),this.getOddRoundingErrors())}o&&K.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}K.SYMBOL_WIDEST=[7,5,4,3,1],K.EVEN_TOTAL_SUBSET=[4,20,52,104,204],K.GSUM=[0,348,1388,2948,3988],K.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],K.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],K.FINDER_PAT_A=0,K.FINDER_PAT_B=1,K.FINDER_PAT_C=2,K.FINDER_PAT_D=3,K.FINDER_PAT_E=4,K.FINDER_PAT_F=5,K.FINDER_PATTERN_SEQUENCES=[[K.FINDER_PAT_A,K.FINDER_PAT_A],[K.FINDER_PAT_A,K.FINDER_PAT_B,K.FINDER_PAT_B],[K.FINDER_PAT_A,K.FINDER_PAT_C,K.FINDER_PAT_B,K.FINDER_PAT_D],[K.FINDER_PAT_A,K.FINDER_PAT_E,K.FINDER_PAT_B,K.FINDER_PAT_D,K.FINDER_PAT_C],[K.FINDER_PAT_A,K.FINDER_PAT_E,K.FINDER_PAT_B,K.FINDER_PAT_D,K.FINDER_PAT_D,K.FINDER_PAT_F],[K.FINDER_PAT_A,K.FINDER_PAT_E,K.FINDER_PAT_B,K.FINDER_PAT_D,K.FINDER_PAT_E,K.FINDER_PAT_F,K.FINDER_PAT_F],[K.FINDER_PAT_A,K.FINDER_PAT_A,K.FINDER_PAT_B,K.FINDER_PAT_B,K.FINDER_PAT_C,K.FINDER_PAT_C,K.FINDER_PAT_D,K.FINDER_PAT_D],[K.FINDER_PAT_A,K.FINDER_PAT_A,K.FINDER_PAT_B,K.FINDER_PAT_B,K.FINDER_PAT_C,K.FINDER_PAT_C,K.FINDER_PAT_D,K.FINDER_PAT_E,K.FINDER_PAT_E],[K.FINDER_PAT_A,K.FINDER_PAT_A,K.FINDER_PAT_B,K.FINDER_PAT_B,K.FINDER_PAT_C,K.FINDER_PAT_C,K.FINDER_PAT_D,K.FINDER_PAT_E,K.FINDER_PAT_F,K.FINDER_PAT_F],[K.FINDER_PAT_A,K.FINDER_PAT_A,K.FINDER_PAT_B,K.FINDER_PAT_B,K.FINDER_PAT_C,K.FINDER_PAT_D,K.FINDER_PAT_D,K.FINDER_PAT_E,K.FINDER_PAT_E,K.FINDER_PAT_F,K.FINDER_PAT_F]],K.MAX_PAIRS=11;class Va extends js{constructor(e,t,s){super(e,t),this.count=0,this.finderPattern=s}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Qe extends gt{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(e,t,s){const r=this.decodePair(t,!1,e,s);Qe.addOrTally(this.possibleLeftPairs,r),t.reverse();let a=this.decodePair(t,!0,e,s);Qe.addOrTally(this.possibleRightPairs,a),t.reverse();for(let i of this.possibleLeftPairs)if(i.getCount()>1){for(let o of this.possibleRightPairs)if(o.getCount()>1&&Qe.checkChecksum(i,o))return Qe.constructResult(i,o)}throw new H}static addOrTally(e,t){if(t==null)return;let s=!1;for(let r of e)if(r.getValue()===t.getValue()){r.incrementCount(),s=!0;break}s||e.push(t)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(e,t){let s=4537077*e.getValue()+t.getValue(),r=new String(s).toString(),a=new ae;for(let u=13-r.length;u>0;u--)a.append("0");a.append(r);let i=0;for(let u=0;u<13;u++){let m=a.charAt(u).charCodeAt(0)-48;i+=u&1?m:3*m}i=10-i%10,i===10&&(i=0),a.append(i.toString());let o=e.getFinderPattern().getResultPoints(),l=t.getFinderPattern().getResultPoints();return new dt(a.toString(),null,0,[o[0],o[1],l[0],l[1]],xe.RSS_14,new Date().getTime())}static checkChecksum(e,t){let s=(e.getChecksumPortion()+16*t.getChecksumPortion())%79,r=9*e.getFinderPattern().getValue()+t.getFinderPattern().getValue();return r>72&&r--,r>8&&r--,s===r}decodePair(e,t,s,r){try{let a=this.findFinderPattern(e,t),i=this.parseFoundFinderPattern(e,s,t,a),o=r==null?null:r.get(v.NEED_RESULT_POINT_CALLBACK);if(o!=null){let m=(a[0]+a[1])/2;t&&(m=e.getSize()-1-m),o.foundPossibleResultPoint(new ce(m,s))}let l=this.decodeDataCharacter(e,i,!0),u=this.decodeDataCharacter(e,i,!1);return new Va(1597*l.getValue()+u.getValue(),l.getChecksumPortion()+4*u.getChecksumPortion(),i)}catch{return null}}decodeDataCharacter(e,t,s){let r=this.getDataCharacterCounters();for(let k=0;k<r.length;k++)r[k]=0;if(s)st.recordPatternInReverse(e,t.getStartEnd()[0],r);else{st.recordPattern(e,t.getStartEnd()[1]+1,r);for(let k=0,G=r.length-1;k<G;k++,G--){let ee=r[k];r[k]=r[G],r[G]=ee}}let a=s?16:15,i=Ie.sum(new Int32Array(r))/a,o=this.getOddCounts(),l=this.getEvenCounts(),u=this.getOddRoundingErrors(),m=this.getEvenRoundingErrors();for(let k=0;k<r.length;k++){let G=r[k]/i,ee=Math.floor(G+.5);ee<1?ee=1:ee>8&&(ee=8);let te=Math.floor(k/2);k&1?(l[te]=ee,m[te]=G-ee):(o[te]=ee,u[te]=G-ee)}this.adjustOddEvenCounts(s,a);let w=0,b=0;for(let k=o.length-1;k>=0;k--)b*=9,b+=o[k],w+=o[k];let E=0,_=0;for(let k=l.length-1;k>=0;k--)E*=9,E+=l[k],_+=l[k];let O=b+3*E;if(s){if(w&1||w>12||w<4)throw new H;let k=(12-w)/2,G=Qe.OUTSIDE_ODD_WIDEST[k],ee=9-G,te=Yt.getRSSvalue(o,G,!1),$=Yt.getRSSvalue(l,ee,!0),ve=Qe.OUTSIDE_EVEN_TOTAL_SUBSET[k],be=Qe.OUTSIDE_GSUM[k];return new js(te*ve+$+be,O)}else{if(_&1||_>10||_<4)throw new H;let k=(10-_)/2,G=Qe.INSIDE_ODD_WIDEST[k],ee=9-G,te=Yt.getRSSvalue(o,G,!0),$=Yt.getRSSvalue(l,ee,!1),ve=Qe.INSIDE_ODD_TOTAL_SUBSET[k],be=Qe.INSIDE_GSUM[k];return new js($*ve+te+be,O)}}findFinderPattern(e,t){let s=this.getDecodeFinderCounters();s[0]=0,s[1]=0,s[2]=0,s[3]=0;let r=e.getSize(),a=!1,i=0;for(;i<r&&(a=!e.get(i),t!==a);)i++;let o=0,l=i;for(let u=i;u<r;u++)if(e.get(u)!==a)s[o]++;else{if(o===3){if(gt.isFinderPattern(s))return[l,u];l+=s[0]+s[1],s[0]=s[2],s[1]=s[3],s[2]=0,s[3]=0,o--}else o++;s[o]=1,a=!a}throw new H}parseFoundFinderPattern(e,t,s,r){let a=e.get(r[0]),i=r[0]-1;for(;i>=0&&a!==e.get(i);)i--;i++;const o=r[0]-i,l=this.getDecodeFinderCounters(),u=new Int32Array(l.length);U.arraycopy(l,0,u,1,l.length-1),u[0]=o;const m=this.parseFinderValue(u,Qe.FINDER_PATTERNS);let w=i,b=r[1];return s&&(w=e.getSize()-1-w,b=e.getSize()-1-b),new an(m,[i,r[1]],w,b,t)}adjustOddEvenCounts(e,t){let s=Ie.sum(new Int32Array(this.getOddCounts())),r=Ie.sum(new Int32Array(this.getEvenCounts())),a=!1,i=!1,o=!1,l=!1;e?(s>12?i=!0:s<4&&(a=!0),r>12?l=!0:r<4&&(o=!0)):(s>11?i=!0:s<5&&(a=!0),r>10?l=!0:r<4&&(o=!0));let u=s+r-t,m=(s&1)===(e?1:0),w=(r&1)===1;if(u===1)if(m){if(w)throw new H;i=!0}else{if(!w)throw new H;l=!0}else if(u===-1)if(m){if(w)throw new H;a=!0}else{if(!w)throw new H;o=!0}else if(u===0){if(m){if(!w)throw new H;s<r?(a=!0,l=!0):(i=!0,o=!0)}else if(w)throw new H}else throw new H;if(a){if(i)throw new H;gt.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(i&&gt.decrement(this.getOddCounts(),this.getOddRoundingErrors()),o){if(l)throw new H;gt.increment(this.getEvenCounts(),this.getOddRoundingErrors())}l&&gt.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Qe.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Qe.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Qe.OUTSIDE_GSUM=[0,161,961,2015,2715],Qe.INSIDE_GSUM=[0,336,1036,1516],Qe.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Qe.INSIDE_ODD_WIDEST=[2,4,6,8],Qe.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class _s extends st{constructor(e,t){super(),this.readers=[],this.verbose=t===!0;const s=e?e.get(v.POSSIBLE_FORMATS):null,r=e&&e.get(v.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;s?((s.includes(xe.EAN_13)||s.includes(xe.UPC_A)||s.includes(xe.EAN_8)||s.includes(xe.UPC_E))&&this.readers.push(new On(e)),s.includes(xe.CODE_39)&&this.readers.push(new nt(r)),s.includes(xe.CODE_128)&&this.readers.push(new ne),s.includes(xe.ITF)&&this.readers.push(new Pe),s.includes(xe.RSS_14)&&this.readers.push(new Qe),s.includes(xe.RSS_EXPANDED)&&this.readers.push(new K(this.verbose))):(this.readers.push(new On(e)),this.readers.push(new nt),this.readers.push(new On(e)),this.readers.push(new ne),this.readers.push(new Pe),this.readers.push(new Qe),this.readers.push(new K(this.verbose)))}decodeRow(e,t,s){for(let r=0;r<this.readers.length;r++)try{return this.readers[r].decodeRow(e,t,s)}catch{}throw new H}reset(){this.readers.forEach(e=>e.reset())}}class Ga extends mt{constructor(e=500,t){super(new _s(t),e,t)}}class Re{constructor(e,t,s){this.ecCodewords=e,this.ecBlocks=[t],s&&this.ecBlocks.push(s)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class De{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Se{constructor(e,t,s,r,a,i){this.versionNumber=e,this.symbolSizeRows=t,this.symbolSizeColumns=s,this.dataRegionSizeRows=r,this.dataRegionSizeColumns=a,this.ecBlocks=i;let o=0;const l=i.getECCodewords(),u=i.getECBlocks();for(let m of u)o+=m.getCount()*(m.getDataCodewords()+l);this.totalCodewords=o}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(e,t){if(e&1||t&1)throw new T;for(let s of Se.VERSIONS)if(s.symbolSizeRows===e&&s.symbolSizeColumns===t)return s;throw new T}toString(){return""+this.versionNumber}static buildVersions(){return[new Se(1,10,10,8,8,new Re(5,new De(1,3))),new Se(2,12,12,10,10,new Re(7,new De(1,5))),new Se(3,14,14,12,12,new Re(10,new De(1,8))),new Se(4,16,16,14,14,new Re(12,new De(1,12))),new Se(5,18,18,16,16,new Re(14,new De(1,18))),new Se(6,20,20,18,18,new Re(18,new De(1,22))),new Se(7,22,22,20,20,new Re(20,new De(1,30))),new Se(8,24,24,22,22,new Re(24,new De(1,36))),new Se(9,26,26,24,24,new Re(28,new De(1,44))),new Se(10,32,32,14,14,new Re(36,new De(1,62))),new Se(11,36,36,16,16,new Re(42,new De(1,86))),new Se(12,40,40,18,18,new Re(48,new De(1,114))),new Se(13,44,44,20,20,new Re(56,new De(1,144))),new Se(14,48,48,22,22,new Re(68,new De(1,174))),new Se(15,52,52,24,24,new Re(42,new De(2,102))),new Se(16,64,64,14,14,new Re(56,new De(2,140))),new Se(17,72,72,16,16,new Re(36,new De(4,92))),new Se(18,80,80,18,18,new Re(48,new De(4,114))),new Se(19,88,88,20,20,new Re(56,new De(4,144))),new Se(20,96,96,22,22,new Re(68,new De(4,174))),new Se(21,104,104,24,24,new Re(56,new De(6,136))),new Se(22,120,120,18,18,new Re(68,new De(6,175))),new Se(23,132,132,20,20,new Re(62,new De(8,163))),new Se(24,144,144,22,22,new Re(62,new De(8,156),new De(2,155))),new Se(25,8,18,6,16,new Re(7,new De(1,5))),new Se(26,8,32,6,14,new Re(11,new De(1,10))),new Se(27,12,26,10,24,new Re(14,new De(1,16))),new Se(28,12,36,10,16,new Re(18,new De(1,22))),new Se(29,16,36,14,16,new Re(24,new De(1,32))),new Se(30,16,48,14,22,new Re(28,new De(1,49)))]}}Se.VERSIONS=Se.buildVersions();class Bn{constructor(e){const t=e.getHeight();if(t<8||t>144||t&1)throw new T;this.version=Bn.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new Ce(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(e){const t=e.getHeight(),s=e.getWidth();return Se.getVersionForDimensions(t,s)}readCodewords(){const e=new Int8Array(this.version.getTotalCodewords());let t=0,s=4,r=0;const a=this.mappingBitMatrix.getHeight(),i=this.mappingBitMatrix.getWidth();let o=!1,l=!1,u=!1,m=!1;do if(s===a&&r===0&&!o)e[t++]=this.readCorner1(a,i)&255,s-=2,r+=2,o=!0;else if(s===a-2&&r===0&&i&3&&!l)e[t++]=this.readCorner2(a,i)&255,s-=2,r+=2,l=!0;else if(s===a+4&&r===2&&!(i&7)&&!u)e[t++]=this.readCorner3(a,i)&255,s-=2,r+=2,u=!0;else if(s===a-2&&r===0&&(i&7)===4&&!m)e[t++]=this.readCorner4(a,i)&255,s-=2,r+=2,m=!0;else{do s<a&&r>=0&&!this.readMappingMatrix.get(r,s)&&(e[t++]=this.readUtah(s,r,a,i)&255),s-=2,r+=2;while(s>=0&&r<i);s+=1,r+=3;do s>=0&&r<i&&!this.readMappingMatrix.get(r,s)&&(e[t++]=this.readUtah(s,r,a,i)&255),s+=2,r-=2;while(s<a&&r>=0);s+=3,r+=1}while(s<a||r<i);if(t!==this.version.getTotalCodewords())throw new T;return e}readModule(e,t,s,r){return e<0&&(e+=s,t+=4-(s+4&7)),t<0&&(t+=r,e+=4-(r+4&7)),this.readMappingMatrix.set(t,e),this.mappingBitMatrix.get(t,e)}readUtah(e,t,s,r){let a=0;return this.readModule(e-2,t-2,s,r)&&(a|=1),a<<=1,this.readModule(e-2,t-1,s,r)&&(a|=1),a<<=1,this.readModule(e-1,t-2,s,r)&&(a|=1),a<<=1,this.readModule(e-1,t-1,s,r)&&(a|=1),a<<=1,this.readModule(e-1,t,s,r)&&(a|=1),a<<=1,this.readModule(e,t-2,s,r)&&(a|=1),a<<=1,this.readModule(e,t-1,s,r)&&(a|=1),a<<=1,this.readModule(e,t,s,r)&&(a|=1),a}readCorner1(e,t){let s=0;return this.readModule(e-1,0,e,t)&&(s|=1),s<<=1,this.readModule(e-1,1,e,t)&&(s|=1),s<<=1,this.readModule(e-1,2,e,t)&&(s|=1),s<<=1,this.readModule(0,t-2,e,t)&&(s|=1),s<<=1,this.readModule(0,t-1,e,t)&&(s|=1),s<<=1,this.readModule(1,t-1,e,t)&&(s|=1),s<<=1,this.readModule(2,t-1,e,t)&&(s|=1),s<<=1,this.readModule(3,t-1,e,t)&&(s|=1),s}readCorner2(e,t){let s=0;return this.readModule(e-3,0,e,t)&&(s|=1),s<<=1,this.readModule(e-2,0,e,t)&&(s|=1),s<<=1,this.readModule(e-1,0,e,t)&&(s|=1),s<<=1,this.readModule(0,t-4,e,t)&&(s|=1),s<<=1,this.readModule(0,t-3,e,t)&&(s|=1),s<<=1,this.readModule(0,t-2,e,t)&&(s|=1),s<<=1,this.readModule(0,t-1,e,t)&&(s|=1),s<<=1,this.readModule(1,t-1,e,t)&&(s|=1),s}readCorner3(e,t){let s=0;return this.readModule(e-1,0,e,t)&&(s|=1),s<<=1,this.readModule(e-1,t-1,e,t)&&(s|=1),s<<=1,this.readModule(0,t-3,e,t)&&(s|=1),s<<=1,this.readModule(0,t-2,e,t)&&(s|=1),s<<=1,this.readModule(0,t-1,e,t)&&(s|=1),s<<=1,this.readModule(1,t-3,e,t)&&(s|=1),s<<=1,this.readModule(1,t-2,e,t)&&(s|=1),s<<=1,this.readModule(1,t-1,e,t)&&(s|=1),s}readCorner4(e,t){let s=0;return this.readModule(e-3,0,e,t)&&(s|=1),s<<=1,this.readModule(e-2,0,e,t)&&(s|=1),s<<=1,this.readModule(e-1,0,e,t)&&(s|=1),s<<=1,this.readModule(0,t-2,e,t)&&(s|=1),s<<=1,this.readModule(0,t-1,e,t)&&(s|=1),s<<=1,this.readModule(1,t-1,e,t)&&(s|=1),s<<=1,this.readModule(2,t-1,e,t)&&(s|=1),s<<=1,this.readModule(3,t-1,e,t)&&(s|=1),s}extractDataRegion(e){const t=this.version.getSymbolSizeRows(),s=this.version.getSymbolSizeColumns();if(e.getHeight()!==t)throw new S("Dimension of bitMatrix must match the version size");const r=this.version.getDataRegionSizeRows(),a=this.version.getDataRegionSizeColumns(),i=t/r|0,o=s/a|0,l=i*r,u=o*a,m=new Ce(u,l);for(let w=0;w<i;++w){const b=w*r;for(let E=0;E<o;++E){const _=E*a;for(let O=0;O<r;++O){const k=w*(r+2)+1+O,G=b+O;for(let ee=0;ee<a;++ee){const te=E*(a+2)+1+ee;if(e.get(te,k)){const $=_+ee;m.set($,G)}}}}}return m}}class Pn{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t){const s=t.getECBlocks();let r=0;const a=s.getECBlocks();for(let O of a)r+=O.getCount();const i=new Array(r);let o=0;for(let O of a)for(let k=0;k<O.getCount();k++){const G=O.getDataCodewords(),ee=s.getECCodewords()+G;i[o++]=new Pn(G,new Uint8Array(ee))}const u=i[0].codewords.length-s.getECCodewords(),m=u-1;let w=0;for(let O=0;O<m;O++)for(let k=0;k<o;k++)i[k].codewords[O]=e[w++];const b=t.getVersionNumber()===24,E=b?8:o;for(let O=0;O<E;O++)i[O].codewords[u-1]=e[w++];const _=i[0].codewords.length;for(let O=u;O<_;O++)for(let k=0;k<o;k++){const G=b?(k+8)%o:k,ee=b&&G>7?O-1:O;i[G].codewords[ee]=e[w++]}if(w!==e.length)throw new S;return i}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Fn{constructor(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(e){if(e<1||e>32||e>this.available())throw new S(""+e);let t=0,s=this.bitOffset,r=this.byteOffset;const a=this.bytes;if(s>0){const i=8-s,o=e<i?e:i,l=i-o,u=255>>8-o<<l;t=(a[r]&u)>>l,e-=o,s+=o,s===8&&(s=0,r++)}if(e>0){for(;e>=8;)t=t<<8|a[r]&255,r++,e-=8;if(e>0){const i=8-e,o=255>>i<<i;t=t<<e|(a[r]&o)>>i,s+=e}}return this.bitOffset=s,this.byteOffset=r,t}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var rt;(function(y){y[y.PAD_ENCODE=0]="PAD_ENCODE",y[y.ASCII_ENCODE=1]="ASCII_ENCODE",y[y.C40_ENCODE=2]="C40_ENCODE",y[y.TEXT_ENCODE=3]="TEXT_ENCODE",y[y.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",y[y.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",y[y.BASE256_ENCODE=6]="BASE256_ENCODE"})(rt||(rt={}));class ls{static decode(e){const t=new Fn(e),s=new ae,r=new ae,a=new Array;let i=rt.ASCII_ENCODE;do if(i===rt.ASCII_ENCODE)i=this.decodeAsciiSegment(t,s,r);else{switch(i){case rt.C40_ENCODE:this.decodeC40Segment(t,s);break;case rt.TEXT_ENCODE:this.decodeTextSegment(t,s);break;case rt.ANSIX12_ENCODE:this.decodeAnsiX12Segment(t,s);break;case rt.EDIFACT_ENCODE:this.decodeEdifactSegment(t,s);break;case rt.BASE256_ENCODE:this.decodeBase256Segment(t,s,a);break;default:throw new T}i=rt.ASCII_ENCODE}while(i!==rt.PAD_ENCODE&&t.available()>0);return r.length()>0&&s.append(r.toString()),new Us(e,s.toString(),a.length===0?null:a,null)}static decodeAsciiSegment(e,t,s){let r=!1;do{let a=e.readBits(8);if(a===0)throw new T;if(a<=128)return r&&(a+=128),t.append(String.fromCharCode(a-1)),rt.ASCII_ENCODE;if(a===129)return rt.PAD_ENCODE;if(a<=229){const i=a-130;i<10&&t.append("0"),t.append(""+i)}else switch(a){case 230:return rt.C40_ENCODE;case 231:return rt.BASE256_ENCODE;case 232:t.append("");break;case 233:case 234:break;case 235:r=!0;break;case 236:t.append("[)>05"),s.insert(0,"");break;case 237:t.append("[)>06"),s.insert(0,"");break;case 238:return rt.ANSIX12_ENCODE;case 239:return rt.TEXT_ENCODE;case 240:return rt.EDIFACT_ENCODE;case 241:break;default:if(a!==254||e.available()!==0)throw new T;break}}while(e.available()>0);return rt.ASCII_ENCODE}static decodeC40Segment(e,t){let s=!1;const r=[];let a=0;do{if(e.available()===8)return;const i=e.readBits(8);if(i===254)return;this.parseTwoBytes(i,e.readBits(8),r);for(let o=0;o<3;o++){const l=r[o];switch(a){case 0:if(l<3)a=l+1;else if(l<this.C40_BASIC_SET_CHARS.length){const u=this.C40_BASIC_SET_CHARS[l];s?(t.append(String.fromCharCode(u.charCodeAt(0)+128)),s=!1):t.append(u)}else throw new T;break;case 1:s?(t.append(String.fromCharCode(l+128)),s=!1):t.append(String.fromCharCode(l)),a=0;break;case 2:if(l<this.C40_SHIFT2_SET_CHARS.length){const u=this.C40_SHIFT2_SET_CHARS[l];s?(t.append(String.fromCharCode(u.charCodeAt(0)+128)),s=!1):t.append(u)}else switch(l){case 27:t.append("");break;case 30:s=!0;break;default:throw new T}a=0;break;case 3:s?(t.append(String.fromCharCode(l+224)),s=!1):t.append(String.fromCharCode(l+96)),a=0;break;default:throw new T}}}while(e.available()>0)}static decodeTextSegment(e,t){let s=!1,r=[],a=0;do{if(e.available()===8)return;const i=e.readBits(8);if(i===254)return;this.parseTwoBytes(i,e.readBits(8),r);for(let o=0;o<3;o++){const l=r[o];switch(a){case 0:if(l<3)a=l+1;else if(l<this.TEXT_BASIC_SET_CHARS.length){const u=this.TEXT_BASIC_SET_CHARS[l];s?(t.append(String.fromCharCode(u.charCodeAt(0)+128)),s=!1):t.append(u)}else throw new T;break;case 1:s?(t.append(String.fromCharCode(l+128)),s=!1):t.append(String.fromCharCode(l)),a=0;break;case 2:if(l<this.TEXT_SHIFT2_SET_CHARS.length){const u=this.TEXT_SHIFT2_SET_CHARS[l];s?(t.append(String.fromCharCode(u.charCodeAt(0)+128)),s=!1):t.append(u)}else switch(l){case 27:t.append("");break;case 30:s=!0;break;default:throw new T}a=0;break;case 3:if(l<this.TEXT_SHIFT3_SET_CHARS.length){const u=this.TEXT_SHIFT3_SET_CHARS[l];s?(t.append(String.fromCharCode(u.charCodeAt(0)+128)),s=!1):t.append(u),a=0}else throw new T;break;default:throw new T}}}while(e.available()>0)}static decodeAnsiX12Segment(e,t){const s=[];do{if(e.available()===8)return;const r=e.readBits(8);if(r===254)return;this.parseTwoBytes(r,e.readBits(8),s);for(let a=0;a<3;a++){const i=s[a];switch(i){case 0:t.append("\r");break;case 1:t.append("*");break;case 2:t.append(">");break;case 3:t.append(" ");break;default:if(i<14)t.append(String.fromCharCode(i+44));else if(i<40)t.append(String.fromCharCode(i+51));else throw new T;break}}}while(e.available()>0)}static parseTwoBytes(e,t,s){let r=(e<<8)+t-1,a=Math.floor(r/1600);s[0]=a,r-=a*1600,a=Math.floor(r/40),s[1]=a,s[2]=r-a*40}static decodeEdifactSegment(e,t){do{if(e.available()<=16)return;for(let s=0;s<4;s++){let r=e.readBits(6);if(r===31){const a=8-e.getBitOffset();a!==8&&e.readBits(a);return}r&32||(r|=64),t.append(String.fromCharCode(r))}}while(e.available()>0)}static decodeBase256Segment(e,t,s){let r=1+e.getByteOffset();const a=this.unrandomize255State(e.readBits(8),r++);let i;if(a===0?i=e.available()/8|0:a<250?i=a:i=250*(a-249)+this.unrandomize255State(e.readBits(8),r++),i<0)throw new T;const o=new Uint8Array(i);for(let l=0;l<i;l++){if(e.available()<8)throw new T;o[l]=this.unrandomize255State(e.readBits(8),r++)}s.push(o);try{t.append(q.decode(o,J.ISO88591))}catch(l){throw new Wt("Platform does not support required encoding: "+l.message)}}static unrandomize255State(e,t){const s=149*t%255+1,r=e-s;return r>=0?r:r+256}}ls.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],ls.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],ls.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],ls.TEXT_SHIFT2_SET_CHARS=ls.C40_SHIFT2_SET_CHARS,ls.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Wa{constructor(){this.rsDecoder=new zs(_e.DATA_MATRIX_FIELD_256)}decode(e){const t=new Bn(e),s=t.getVersion(),r=t.readCodewords(),a=Pn.getDataBlocks(r,s);let i=0;for(let u of a)i+=u.getNumDataCodewords();const o=new Uint8Array(i),l=a.length;for(let u=0;u<l;u++){const m=a[u],w=m.getCodewords(),b=m.getNumDataCodewords();this.correctErrors(w,b);for(let E=0;E<b;E++)o[E*l+u]=w[E]}return ls.decode(o)}correctErrors(e,t){const s=new Int32Array(e);try{this.rsDecoder.decode(s,e.length-t)}catch{throw new Q}for(let r=0;r<t;r++)e[r]=s[r]}}class tt{constructor(e){this.image=e,this.rectangleDetector=new ts(this.image)}detect(){const e=this.rectangleDetector.detect();let t=this.detectSolid1(e);if(t=this.detectSolid2(t),t[3]=this.correctTopRight(t),!t[3])throw new H;t=this.shiftToModuleCenter(t);const s=t[0],r=t[1],a=t[2],i=t[3];let o=this.transitionsBetween(s,i)+1,l=this.transitionsBetween(a,i)+1;(o&1)===1&&(o+=1),(l&1)===1&&(l+=1),4*o<7*l&&4*l<7*o&&(o=l=Math.max(o,l));let u=tt.sampleGrid(this.image,s,r,a,i,o,l);return new nn(u,[s,r,a,i])}static shiftPoint(e,t,s){let r=(t.getX()-e.getX())/(s+1),a=(t.getY()-e.getY())/(s+1);return new ce(e.getX()+r,e.getY()+a)}static moveAway(e,t,s){let r=e.getX(),a=e.getY();return r<t?r-=1:r+=1,a<s?a-=1:a+=1,new ce(r,a)}detectSolid1(e){let t=e[0],s=e[1],r=e[3],a=e[2],i=this.transitionsBetween(t,s),o=this.transitionsBetween(s,r),l=this.transitionsBetween(r,a),u=this.transitionsBetween(a,t),m=i,w=[a,t,s,r];return m>o&&(m=o,w[0]=t,w[1]=s,w[2]=r,w[3]=a),m>l&&(m=l,w[0]=s,w[1]=r,w[2]=a,w[3]=t),m>u&&(w[0]=r,w[1]=a,w[2]=t,w[3]=s),w}detectSolid2(e){let t=e[0],s=e[1],r=e[2],a=e[3],i=this.transitionsBetween(t,a),o=tt.shiftPoint(s,r,(i+1)*4),l=tt.shiftPoint(r,s,(i+1)*4),u=this.transitionsBetween(o,t),m=this.transitionsBetween(l,a);return u<m?(e[0]=t,e[1]=s,e[2]=r,e[3]=a):(e[0]=s,e[1]=r,e[2]=a,e[3]=t),e}correctTopRight(e){let t=e[0],s=e[1],r=e[2],a=e[3],i=this.transitionsBetween(t,a),o=this.transitionsBetween(s,a),l=tt.shiftPoint(t,s,(o+1)*4),u=tt.shiftPoint(r,s,(i+1)*4);i=this.transitionsBetween(l,a),o=this.transitionsBetween(u,a);let m=new ce(a.getX()+(r.getX()-s.getX())/(i+1),a.getY()+(r.getY()-s.getY())/(i+1)),w=new ce(a.getX()+(t.getX()-s.getX())/(o+1),a.getY()+(t.getY()-s.getY())/(o+1));if(!this.isValid(m))return this.isValid(w)?w:null;if(!this.isValid(w))return m;let b=this.transitionsBetween(l,m)+this.transitionsBetween(u,m),E=this.transitionsBetween(l,w)+this.transitionsBetween(u,w);return b>E?m:w}shiftToModuleCenter(e){let t=e[0],s=e[1],r=e[2],a=e[3],i=this.transitionsBetween(t,a)+1,o=this.transitionsBetween(r,a)+1,l=tt.shiftPoint(t,s,o*4),u=tt.shiftPoint(r,s,i*4);i=this.transitionsBetween(l,a)+1,o=this.transitionsBetween(u,a)+1,(i&1)===1&&(i+=1),(o&1)===1&&(o+=1);let m=(t.getX()+s.getX()+r.getX()+a.getX())/4,w=(t.getY()+s.getY()+r.getY()+a.getY())/4;t=tt.moveAway(t,m,w),s=tt.moveAway(s,m,w),r=tt.moveAway(r,m,w),a=tt.moveAway(a,m,w);let b,E;return l=tt.shiftPoint(t,s,o*4),l=tt.shiftPoint(l,a,i*4),b=tt.shiftPoint(s,t,o*4),b=tt.shiftPoint(b,r,i*4),u=tt.shiftPoint(r,a,o*4),u=tt.shiftPoint(u,s,i*4),E=tt.shiftPoint(a,r,o*4),E=tt.shiftPoint(E,t,i*4),[l,b,u,E]}isValid(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()}static sampleGrid(e,t,s,r,a,i,o){return is.getInstance().sampleGrid(e,i,o,.5,.5,i-.5,.5,i-.5,o-.5,.5,o-.5,t.getX(),t.getY(),a.getX(),a.getY(),r.getX(),r.getY(),s.getX(),s.getY())}transitionsBetween(e,t){let s=Math.trunc(e.getX()),r=Math.trunc(e.getY()),a=Math.trunc(t.getX()),i=Math.trunc(t.getY()),o=Math.abs(i-r)>Math.abs(a-s);if(o){let O=s;s=r,r=O,O=a,a=i,i=O}let l=Math.abs(a-s),u=Math.abs(i-r),m=-l/2,w=r<i?1:-1,b=s<a?1:-1,E=0,_=this.image.get(o?r:s,o?s:r);for(let O=s,k=r;O!==a;O+=b){let G=this.image.get(o?k:O,o?O:k);if(G!==_&&(E++,_=G),m+=u,m>0){if(k===i)break;k+=w,m-=l}}return E}}class cs{constructor(){this.decoder=new Wa}decode(e,t=null){let s,r;if(t!=null&&t.has(v.PURE_BARCODE)){const u=cs.extractPureBits(e.getBlackMatrix());s=this.decoder.decode(u),r=cs.NO_POINTS}else{const u=new tt(e.getBlackMatrix()).detect();s=this.decoder.decode(u.getBits()),r=u.getPoints()}const a=s.getRawBytes(),i=new dt(s.getText(),a,8*a.length,r,xe.DATA_MATRIX,U.currentTimeMillis()),o=s.getByteSegments();o!=null&&i.putMetadata(ot.BYTE_SEGMENTS,o);const l=s.getECLevel();return l!=null&&i.putMetadata(ot.ERROR_CORRECTION_LEVEL,l),i}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),s=e.getBottomRightOnBit();if(t==null||s==null)throw new H;const r=this.moduleSize(t,e);let a=t[1];const i=s[1];let o=t[0];const u=(s[0]-o+1)/r,m=(i-a+1)/r;if(u<=0||m<=0)throw new H;const w=r/2;a+=w,o+=w;const b=new Ce(u,m);for(let E=0;E<m;E++){const _=a+E*r;for(let O=0;O<u;O++)e.get(o+O*r,_)&&b.set(O,E)}return b}static moduleSize(e,t){const s=t.getWidth();let r=e[0];const a=e[1];for(;r<s&&t.get(r,a);)r++;if(r===s)throw new H;const i=r-e[0];if(i===0)throw new H;return i}}cs.NO_POINTS=[];class Ya extends mt{constructor(e=500){super(new cs,e)}}var Ms;(function(y){y[y.L=0]="L",y[y.M=1]="M",y[y.Q=2]="Q",y[y.H=3]="H"})(Ms||(Ms={}));class ze{constructor(e,t,s){this.value=e,this.stringValue=t,this.bits=s,ze.FOR_BITS.set(s,this),ze.FOR_VALUE.set(e,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(e){switch(e){case"L":return ze.L;case"M":return ze.M;case"Q":return ze.Q;case"H":return ze.H;default:throw new A(e+"not available")}}toString(){return this.stringValue}equals(e){if(!(e instanceof ze))return!1;const t=e;return this.value===t.value}static forBits(e){if(e<0||e>=ze.FOR_BITS.size)throw new S;return ze.FOR_BITS.get(e)}}ze.FOR_BITS=new Map,ze.FOR_VALUE=new Map,ze.L=new ze(Ms.L,"L",1),ze.M=new ze(Ms.M,"M",0),ze.Q=new ze(Ms.Q,"Q",3),ze.H=new ze(Ms.H,"H",2);class pt{constructor(e){this.errorCorrectionLevel=ze.forBits(e>>3&3),this.dataMask=e&7}static numBitsDiffering(e,t){return W.bitCount(e^t)}static decodeFormatInformation(e,t){const s=pt.doDecodeFormatInformation(e,t);return s!==null?s:pt.doDecodeFormatInformation(e^pt.FORMAT_INFO_MASK_QR,t^pt.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(e,t){let s=Number.MAX_SAFE_INTEGER,r=0;for(const a of pt.FORMAT_INFO_DECODE_LOOKUP){const i=a[0];if(i===e||i===t)return new pt(a[1]);let o=pt.numBitsDiffering(e,i);o<s&&(r=a[1],s=o),e!==t&&(o=pt.numBitsDiffering(t,i),o<s&&(r=a[1],s=o))}return s<=3?new pt(r):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(e){if(!(e instanceof pt))return!1;const t=e;return this.errorCorrectionLevel===t.errorCorrectionLevel&&this.dataMask===t.dataMask}}pt.FORMAT_INFO_MASK_QR=21522,pt.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class L{constructor(e,...t){this.ecCodewordsPerBlock=e,this.ecBlocks=t}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let e=0;const t=this.ecBlocks;for(const s of t)e+=s.getCount();return e}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class C{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class he{constructor(e,t,...s){this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=s;let r=0;const a=s[0].getECCodewordsPerBlock(),i=s[0].getECBlocks();for(const o of i)r+=o.getCount()*(o.getDataCodewords()+a);this.totalCodewords=r}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(e){return this.ecBlocks[e.getValue()]}static getProvisionalVersionForDimension(e){if(e%4!==1)throw new T;try{return this.getVersionForNumber((e-17)/4)}catch{throw new T}}static getVersionForNumber(e){if(e<1||e>40)throw new S;return he.VERSIONS[e-1]}static decodeVersionInformation(e){let t=Number.MAX_SAFE_INTEGER,s=0;for(let r=0;r<he.VERSION_DECODE_INFO.length;r++){const a=he.VERSION_DECODE_INFO[r];if(a===e)return he.getVersionForNumber(r+7);const i=pt.numBitsDiffering(e,a);i<t&&(s=r+7,t=i)}return t<=3?he.getVersionForNumber(s):null}buildFunctionPattern(){const e=this.getDimensionForVersion(),t=new Ce(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);const s=this.alignmentPatternCenters.length;for(let r=0;r<s;r++){const a=this.alignmentPatternCenters[r]-2;for(let i=0;i<s;i++)r===0&&(i===0||i===s-1)||r===s-1&&i===0||t.setRegion(this.alignmentPatternCenters[i]-2,a,5,5)}return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t}toString(){return""+this.versionNumber}}he.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),he.VERSIONS=[new he(1,new Int32Array(0),new L(7,new C(1,19)),new L(10,new C(1,16)),new L(13,new C(1,13)),new L(17,new C(1,9))),new he(2,Int32Array.from([6,18]),new L(10,new C(1,34)),new L(16,new C(1,28)),new L(22,new C(1,22)),new L(28,new C(1,16))),new he(3,Int32Array.from([6,22]),new L(15,new C(1,55)),new L(26,new C(1,44)),new L(18,new C(2,17)),new L(22,new C(2,13))),new he(4,Int32Array.from([6,26]),new L(20,new C(1,80)),new L(18,new C(2,32)),new L(26,new C(2,24)),new L(16,new C(4,9))),new he(5,Int32Array.from([6,30]),new L(26,new C(1,108)),new L(24,new C(2,43)),new L(18,new C(2,15),new C(2,16)),new L(22,new C(2,11),new C(2,12))),new he(6,Int32Array.from([6,34]),new L(18,new C(2,68)),new L(16,new C(4,27)),new L(24,new C(4,19)),new L(28,new C(4,15))),new he(7,Int32Array.from([6,22,38]),new L(20,new C(2,78)),new L(18,new C(4,31)),new L(18,new C(2,14),new C(4,15)),new L(26,new C(4,13),new C(1,14))),new he(8,Int32Array.from([6,24,42]),new L(24,new C(2,97)),new L(22,new C(2,38),new C(2,39)),new L(22,new C(4,18),new C(2,19)),new L(26,new C(4,14),new C(2,15))),new he(9,Int32Array.from([6,26,46]),new L(30,new C(2,116)),new L(22,new C(3,36),new C(2,37)),new L(20,new C(4,16),new C(4,17)),new L(24,new C(4,12),new C(4,13))),new he(10,Int32Array.from([6,28,50]),new L(18,new C(2,68),new C(2,69)),new L(26,new C(4,43),new C(1,44)),new L(24,new C(6,19),new C(2,20)),new L(28,new C(6,15),new C(2,16))),new he(11,Int32Array.from([6,30,54]),new L(20,new C(4,81)),new L(30,new C(1,50),new C(4,51)),new L(28,new C(4,22),new C(4,23)),new L(24,new C(3,12),new C(8,13))),new he(12,Int32Array.from([6,32,58]),new L(24,new C(2,92),new C(2,93)),new L(22,new C(6,36),new C(2,37)),new L(26,new C(4,20),new C(6,21)),new L(28,new C(7,14),new C(4,15))),new he(13,Int32Array.from([6,34,62]),new L(26,new C(4,107)),new L(22,new C(8,37),new C(1,38)),new L(24,new C(8,20),new C(4,21)),new L(22,new C(12,11),new C(4,12))),new he(14,Int32Array.from([6,26,46,66]),new L(30,new C(3,115),new C(1,116)),new L(24,new C(4,40),new C(5,41)),new L(20,new C(11,16),new C(5,17)),new L(24,new C(11,12),new C(5,13))),new he(15,Int32Array.from([6,26,48,70]),new L(22,new C(5,87),new C(1,88)),new L(24,new C(5,41),new C(5,42)),new L(30,new C(5,24),new C(7,25)),new L(24,new C(11,12),new C(7,13))),new he(16,Int32Array.from([6,26,50,74]),new L(24,new C(5,98),new C(1,99)),new L(28,new C(7,45),new C(3,46)),new L(24,new C(15,19),new C(2,20)),new L(30,new C(3,15),new C(13,16))),new he(17,Int32Array.from([6,30,54,78]),new L(28,new C(1,107),new C(5,108)),new L(28,new C(10,46),new C(1,47)),new L(28,new C(1,22),new C(15,23)),new L(28,new C(2,14),new C(17,15))),new he(18,Int32Array.from([6,30,56,82]),new L(30,new C(5,120),new C(1,121)),new L(26,new C(9,43),new C(4,44)),new L(28,new C(17,22),new C(1,23)),new L(28,new C(2,14),new C(19,15))),new he(19,Int32Array.from([6,30,58,86]),new L(28,new C(3,113),new C(4,114)),new L(26,new C(3,44),new C(11,45)),new L(26,new C(17,21),new C(4,22)),new L(26,new C(9,13),new C(16,14))),new he(20,Int32Array.from([6,34,62,90]),new L(28,new C(3,107),new C(5,108)),new L(26,new C(3,41),new C(13,42)),new L(30,new C(15,24),new C(5,25)),new L(28,new C(15,15),new C(10,16))),new he(21,Int32Array.from([6,28,50,72,94]),new L(28,new C(4,116),new C(4,117)),new L(26,new C(17,42)),new L(28,new C(17,22),new C(6,23)),new L(30,new C(19,16),new C(6,17))),new he(22,Int32Array.from([6,26,50,74,98]),new L(28,new C(2,111),new C(7,112)),new L(28,new C(17,46)),new L(30,new C(7,24),new C(16,25)),new L(24,new C(34,13))),new he(23,Int32Array.from([6,30,54,78,102]),new L(30,new C(4,121),new C(5,122)),new L(28,new C(4,47),new C(14,48)),new L(30,new C(11,24),new C(14,25)),new L(30,new C(16,15),new C(14,16))),new he(24,Int32Array.from([6,28,54,80,106]),new L(30,new C(6,117),new C(4,118)),new L(28,new C(6,45),new C(14,46)),new L(30,new C(11,24),new C(16,25)),new L(30,new C(30,16),new C(2,17))),new he(25,Int32Array.from([6,32,58,84,110]),new L(26,new C(8,106),new C(4,107)),new L(28,new C(8,47),new C(13,48)),new L(30,new C(7,24),new C(22,25)),new L(30,new C(22,15),new C(13,16))),new he(26,Int32Array.from([6,30,58,86,114]),new L(28,new C(10,114),new C(2,115)),new L(28,new C(19,46),new C(4,47)),new L(28,new C(28,22),new C(6,23)),new L(30,new C(33,16),new C(4,17))),new he(27,Int32Array.from([6,34,62,90,118]),new L(30,new C(8,122),new C(4,123)),new L(28,new C(22,45),new C(3,46)),new L(30,new C(8,23),new C(26,24)),new L(30,new C(12,15),new C(28,16))),new he(28,Int32Array.from([6,26,50,74,98,122]),new L(30,new C(3,117),new C(10,118)),new L(28,new C(3,45),new C(23,46)),new L(30,new C(4,24),new C(31,25)),new L(30,new C(11,15),new C(31,16))),new he(29,Int32Array.from([6,30,54,78,102,126]),new L(30,new C(7,116),new C(7,117)),new L(28,new C(21,45),new C(7,46)),new L(30,new C(1,23),new C(37,24)),new L(30,new C(19,15),new C(26,16))),new he(30,Int32Array.from([6,26,52,78,104,130]),new L(30,new C(5,115),new C(10,116)),new L(28,new C(19,47),new C(10,48)),new L(30,new C(15,24),new C(25,25)),new L(30,new C(23,15),new C(25,16))),new he(31,Int32Array.from([6,30,56,82,108,134]),new L(30,new C(13,115),new C(3,116)),new L(28,new C(2,46),new C(29,47)),new L(30,new C(42,24),new C(1,25)),new L(30,new C(23,15),new C(28,16))),new he(32,Int32Array.from([6,34,60,86,112,138]),new L(30,new C(17,115)),new L(28,new C(10,46),new C(23,47)),new L(30,new C(10,24),new C(35,25)),new L(30,new C(19,15),new C(35,16))),new he(33,Int32Array.from([6,30,58,86,114,142]),new L(30,new C(17,115),new C(1,116)),new L(28,new C(14,46),new C(21,47)),new L(30,new C(29,24),new C(19,25)),new L(30,new C(11,15),new C(46,16))),new he(34,Int32Array.from([6,34,62,90,118,146]),new L(30,new C(13,115),new C(6,116)),new L(28,new C(14,46),new C(23,47)),new L(30,new C(44,24),new C(7,25)),new L(30,new C(59,16),new C(1,17))),new he(35,Int32Array.from([6,30,54,78,102,126,150]),new L(30,new C(12,121),new C(7,122)),new L(28,new C(12,47),new C(26,48)),new L(30,new C(39,24),new C(14,25)),new L(30,new C(22,15),new C(41,16))),new he(36,Int32Array.from([6,24,50,76,102,128,154]),new L(30,new C(6,121),new C(14,122)),new L(28,new C(6,47),new C(34,48)),new L(30,new C(46,24),new C(10,25)),new L(30,new C(2,15),new C(64,16))),new he(37,Int32Array.from([6,28,54,80,106,132,158]),new L(30,new C(17,122),new C(4,123)),new L(28,new C(29,46),new C(14,47)),new L(30,new C(49,24),new C(10,25)),new L(30,new C(24,15),new C(46,16))),new he(38,Int32Array.from([6,32,58,84,110,136,162]),new L(30,new C(4,122),new C(18,123)),new L(28,new C(13,46),new C(32,47)),new L(30,new C(48,24),new C(14,25)),new L(30,new C(42,15),new C(32,16))),new he(39,Int32Array.from([6,26,54,82,110,138,166]),new L(30,new C(20,117),new C(4,118)),new L(28,new C(40,47),new C(7,48)),new L(30,new C(43,24),new C(22,25)),new L(30,new C(10,15),new C(67,16))),new he(40,Int32Array.from([6,30,58,86,114,142,170]),new L(30,new C(19,118),new C(6,119)),new L(28,new C(18,47),new C(31,48)),new L(30,new C(34,24),new C(34,25)),new L(30,new C(20,15),new C(61,16)))];var lt;(function(y){y[y.DATA_MASK_000=0]="DATA_MASK_000",y[y.DATA_MASK_001=1]="DATA_MASK_001",y[y.DATA_MASK_010=2]="DATA_MASK_010",y[y.DATA_MASK_011=3]="DATA_MASK_011",y[y.DATA_MASK_100=4]="DATA_MASK_100",y[y.DATA_MASK_101=5]="DATA_MASK_101",y[y.DATA_MASK_110=6]="DATA_MASK_110",y[y.DATA_MASK_111=7]="DATA_MASK_111"})(lt||(lt={}));class Lt{constructor(e,t){this.value=e,this.isMasked=t}unmaskBitMatrix(e,t){for(let s=0;s<t;s++)for(let r=0;r<t;r++)this.isMasked(s,r)&&e.flip(r,s)}}Lt.values=new Map([[lt.DATA_MASK_000,new Lt(lt.DATA_MASK_000,(y,e)=>(y+e&1)===0)],[lt.DATA_MASK_001,new Lt(lt.DATA_MASK_001,(y,e)=>(y&1)===0)],[lt.DATA_MASK_010,new Lt(lt.DATA_MASK_010,(y,e)=>e%3===0)],[lt.DATA_MASK_011,new Lt(lt.DATA_MASK_011,(y,e)=>(y+e)%3===0)],[lt.DATA_MASK_100,new Lt(lt.DATA_MASK_100,(y,e)=>(Math.floor(y/2)+Math.floor(e/3)&1)===0)],[lt.DATA_MASK_101,new Lt(lt.DATA_MASK_101,(y,e)=>y*e%6===0)],[lt.DATA_MASK_110,new Lt(lt.DATA_MASK_110,(y,e)=>y*e%6<3)],[lt.DATA_MASK_111,new Lt(lt.DATA_MASK_111,(y,e)=>(y+e+y*e%3&1)===0)]]);class Xa{constructor(e){const t=e.getHeight();if(t<21||(t&3)!==1)throw new T;this.bitMatrix=e}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let e=0;for(let a=0;a<6;a++)e=this.copyBit(a,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(let a=5;a>=0;a--)e=this.copyBit(8,a,e);const t=this.bitMatrix.getHeight();let s=0;const r=t-7;for(let a=t-1;a>=r;a--)s=this.copyBit(8,a,s);for(let a=t-8;a<t;a++)s=this.copyBit(a,8,s);if(this.parsedFormatInfo=pt.decodeFormatInformation(e,s),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new T}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const e=this.bitMatrix.getHeight(),t=Math.floor((e-17)/4);if(t<=6)return he.getVersionForNumber(t);let s=0;const r=e-11;for(let i=5;i>=0;i--)for(let o=e-9;o>=r;o--)s=this.copyBit(o,i,s);let a=he.decodeVersionInformation(s);if(a!==null&&a.getDimensionForVersion()===e)return this.parsedVersion=a,a;s=0;for(let i=5;i>=0;i--)for(let o=e-9;o>=r;o--)s=this.copyBit(i,o,s);if(a=he.decodeVersionInformation(s),a!==null&&a.getDimensionForVersion()===e)return this.parsedVersion=a,a;throw new T}copyBit(e,t,s){return(this.isMirror?this.bitMatrix.get(t,e):this.bitMatrix.get(e,t))?s<<1|1:s<<1}readCodewords(){const e=this.readFormatInformation(),t=this.readVersion(),s=Lt.values.get(e.getDataMask()),r=this.bitMatrix.getHeight();s.unmaskBitMatrix(this.bitMatrix,r);const a=t.buildFunctionPattern();let i=!0;const o=new Uint8Array(t.getTotalCodewords());let l=0,u=0,m=0;for(let w=r-1;w>0;w-=2){w===6&&w--;for(let b=0;b<r;b++){const E=i?r-1-b:b;for(let _=0;_<2;_++)a.get(w-_,E)||(m++,u<<=1,this.bitMatrix.get(w-_,E)&&(u|=1),m===8&&(o[l++]=u,m=0,u=0))}i=!i}if(l!==t.getTotalCodewords())throw new T;return o}remask(){if(this.parsedFormatInfo===null)return;const e=Lt.values[this.parsedFormatInfo.getDataMask()],t=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,t)}setMirror(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e}mirror(){const e=this.bitMatrix;for(let t=0,s=e.getWidth();t<s;t++)for(let r=t+1,a=e.getHeight();r<a;r++)e.get(t,r)!==e.get(r,t)&&(e.flip(r,t),e.flip(t,r))}}class Un{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t,s){if(e.length!==t.getTotalCodewords())throw new S;const r=t.getECBlocksForLevel(s);let a=0;const i=r.getECBlocks();for(const _ of i)a+=_.getCount();const o=new Array(a);let l=0;for(const _ of i)for(let O=0;O<_.getCount();O++){const k=_.getDataCodewords(),G=r.getECCodewordsPerBlock()+k;o[l++]=new Un(k,new Uint8Array(G))}const u=o[0].codewords.length;let m=o.length-1;for(;m>=0&&o[m].codewords.length!==u;)m--;m++;const w=u-r.getECCodewordsPerBlock();let b=0;for(let _=0;_<w;_++)for(let O=0;O<l;O++)o[O].codewords[_]=e[b++];for(let _=m;_<l;_++)o[_].codewords[w]=e[b++];const E=o[0].codewords.length;for(let _=w;_<E;_++)for(let O=0;O<l;O++){const k=O<m?_:_+1;o[O].codewords[k]=e[b++]}return o}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Bt;(function(y){y[y.TERMINATOR=0]="TERMINATOR",y[y.NUMERIC=1]="NUMERIC",y[y.ALPHANUMERIC=2]="ALPHANUMERIC",y[y.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",y[y.BYTE=4]="BYTE",y[y.ECI=5]="ECI",y[y.KANJI=6]="KANJI",y[y.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",y[y.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",y[y.HANZI=9]="HANZI"})(Bt||(Bt={}));class fe{constructor(e,t,s,r){this.value=e,this.stringValue=t,this.characterCountBitsForVersions=s,this.bits=r,fe.FOR_BITS.set(r,this),fe.FOR_VALUE.set(e,this)}static forBits(e){const t=fe.FOR_BITS.get(e);if(t===void 0)throw new S;return t}getCharacterCountBits(e){const t=e.getVersionNumber();let s;return t<=9?s=0:t<=26?s=1:s=2,this.characterCountBitsForVersions[s]}getValue(){return this.value}getBits(){return this.bits}equals(e){if(!(e instanceof fe))return!1;const t=e;return this.value===t.value}toString(){return this.stringValue}}fe.FOR_BITS=new Map,fe.FOR_VALUE=new Map,fe.TERMINATOR=new fe(Bt.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),fe.NUMERIC=new fe(Bt.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),fe.ALPHANUMERIC=new fe(Bt.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),fe.STRUCTURED_APPEND=new fe(Bt.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),fe.BYTE=new fe(Bt.BYTE,"BYTE",Int32Array.from([8,16,16]),4),fe.ECI=new fe(Bt.ECI,"ECI",Int32Array.from([0,0,0]),7),fe.KANJI=new fe(Bt.KANJI,"KANJI",Int32Array.from([8,10,12]),8),fe.FNC1_FIRST_POSITION=new fe(Bt.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),fe.FNC1_SECOND_POSITION=new fe(Bt.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),fe.HANZI=new fe(Bt.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class Xe{static decode(e,t,s,r){const a=new Fn(e);let i=new ae;const o=new Array;let l=-1,u=-1;try{let m=null,w=!1,b;do{if(a.available()<4)b=fe.TERMINATOR;else{const E=a.readBits(4);b=fe.forBits(E)}switch(b){case fe.TERMINATOR:break;case fe.FNC1_FIRST_POSITION:case fe.FNC1_SECOND_POSITION:w=!0;break;case fe.STRUCTURED_APPEND:if(a.available()<16)throw new T;l=a.readBits(8),u=a.readBits(8);break;case fe.ECI:const E=Xe.parseECIValue(a);if(m=P.getCharacterSetECIByValue(E),m===null)throw new T;break;case fe.HANZI:const _=a.readBits(4),O=a.readBits(b.getCharacterCountBits(t));_===Xe.GB2312_SUBSET&&Xe.decodeHanziSegment(a,i,O);break;default:const k=a.readBits(b.getCharacterCountBits(t));switch(b){case fe.NUMERIC:Xe.decodeNumericSegment(a,i,k);break;case fe.ALPHANUMERIC:Xe.decodeAlphanumericSegment(a,i,k,w);break;case fe.BYTE:Xe.decodeByteSegment(a,i,k,m,o,r);break;case fe.KANJI:Xe.decodeKanjiSegment(a,i,k);break;default:throw new T}break}}while(b!==fe.TERMINATOR)}catch{throw new T}return new Us(e,i.toString(),o.length===0?null:o,s===null?null:s.toString(),l,u)}static decodeHanziSegment(e,t,s){if(s*13>e.available())throw new T;const r=new Uint8Array(2*s);let a=0;for(;s>0;){const i=e.readBits(13);let o=i/96<<8&4294967295|i%96;o<959?o+=41377:o+=42657,r[a]=o>>8&255,r[a+1]=o&255,a+=2,s--}try{t.append(q.decode(r,J.GB2312))}catch(i){throw new T(i)}}static decodeKanjiSegment(e,t,s){if(s*13>e.available())throw new T;const r=new Uint8Array(2*s);let a=0;for(;s>0;){const i=e.readBits(13);let o=i/192<<8&4294967295|i%192;o<7936?o+=33088:o+=49472,r[a]=o>>8,r[a+1]=o,a+=2,s--}try{t.append(q.decode(r,J.SHIFT_JIS))}catch(i){throw new T(i)}}static decodeByteSegment(e,t,s,r,a,i){if(8*s>e.available())throw new T;const o=new Uint8Array(s);for(let u=0;u<s;u++)o[u]=e.readBits(8);let l;r===null?l=J.guessEncoding(o,i):l=r.getName();try{t.append(q.decode(o,l))}catch(u){throw new T(u)}a.push(o)}static toAlphaNumericChar(e){if(e>=Xe.ALPHANUMERIC_CHARS.length)throw new T;return Xe.ALPHANUMERIC_CHARS[e]}static decodeAlphanumericSegment(e,t,s,r){const a=t.length();for(;s>1;){if(e.available()<11)throw new T;const i=e.readBits(11);t.append(Xe.toAlphaNumericChar(Math.floor(i/45))),t.append(Xe.toAlphaNumericChar(i%45)),s-=2}if(s===1){if(e.available()<6)throw new T;t.append(Xe.toAlphaNumericChar(e.readBits(6)))}if(r)for(let i=a;i<t.length();i++)t.charAt(i)==="%"&&(i<t.length()-1&&t.charAt(i+1)==="%"?t.deleteCharAt(i+1):t.setCharAt(i,""))}static decodeNumericSegment(e,t,s){for(;s>=3;){if(e.available()<10)throw new T;const r=e.readBits(10);if(r>=1e3)throw new T;t.append(Xe.toAlphaNumericChar(Math.floor(r/100))),t.append(Xe.toAlphaNumericChar(Math.floor(r/10)%10)),t.append(Xe.toAlphaNumericChar(r%10)),s-=3}if(s===2){if(e.available()<7)throw new T;const r=e.readBits(7);if(r>=100)throw new T;t.append(Xe.toAlphaNumericChar(Math.floor(r/10))),t.append(Xe.toAlphaNumericChar(r%10))}else if(s===1){if(e.available()<4)throw new T;const r=e.readBits(4);if(r>=10)throw new T;t.append(Xe.toAlphaNumericChar(r))}}static parseECIValue(e){const t=e.readBits(8);if(!(t&128))return t&127;if((t&192)===128){const s=e.readBits(8);return(t&63)<<8&4294967295|s}if((t&224)===192){const s=e.readBits(16);return(t&31)<<16&4294967295|s}throw new T}}Xe.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Xe.GB2312_SUBSET=1;class Nr{constructor(e){this.mirrored=e}isMirrored(){return this.mirrored}applyMirroredCorrection(e){if(!this.mirrored||e===null||e.length<3)return;const t=e[0];e[0]=e[2],e[2]=t}}class qa{constructor(){this.rsDecoder=new zs(_e.QR_CODE_FIELD_256)}decodeBooleanArray(e,t){return this.decodeBitMatrix(Ce.parseFromBooleanArray(e),t)}decodeBitMatrix(e,t){const s=new Xa(e);let r=null;try{return this.decodeBitMatrixParser(s,t)}catch(a){r=a}try{s.remask(),s.setMirror(!0),s.readVersion(),s.readFormatInformation(),s.mirror();const a=this.decodeBitMatrixParser(s,t);return a.setOther(new Nr(!0)),a}catch(a){throw r!==null?r:a}}decodeBitMatrixParser(e,t){const s=e.readVersion(),r=e.readFormatInformation().getErrorCorrectionLevel(),a=e.readCodewords(),i=Un.getDataBlocks(a,s,r);let o=0;for(const m of i)o+=m.getNumDataCodewords();const l=new Uint8Array(o);let u=0;for(const m of i){const w=m.getCodewords(),b=m.getNumDataCodewords();this.correctErrors(w,b);for(let E=0;E<b;E++)l[u++]=w[E]}return Xe.decode(l,s,r,t)}correctErrors(e,t){const s=new Int32Array(e);try{this.rsDecoder.decode(s,e.length-t)}catch{throw new Q}for(let r=0;r<t;r++)e[r]=s[r]}}class Hn extends ce{constructor(e,t,s){super(e,t),this.estimatedModuleSize=s}aboutEquals(e,t,s){if(Math.abs(t-this.getY())<=e&&Math.abs(s-this.getX())<=e){const r=Math.abs(e-this.estimatedModuleSize);return r<=1||r<=this.estimatedModuleSize}return!1}combineEstimate(e,t,s){const r=(this.getX()+t)/2,a=(this.getY()+e)/2,i=(this.estimatedModuleSize+s)/2;return new Hn(r,a,i)}}class cn{constructor(e,t,s,r,a,i,o){this.image=e,this.startX=t,this.startY=s,this.width=r,this.height=a,this.moduleSize=i,this.resultPointCallback=o,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const e=this.startX,t=this.height,s=this.width,r=e+s,a=this.startY+t/2,i=new Int32Array(3),o=this.image;for(let l=0;l<t;l++){const u=a+(l&1?-Math.floor((l+1)/2):Math.floor((l+1)/2));i[0]=0,i[1]=0,i[2]=0;let m=e;for(;m<r&&!o.get(m,u);)m++;let w=0;for(;m<r;){if(o.get(m,u))if(w===1)i[1]++;else if(w===2){if(this.foundPatternCross(i)){const b=this.handlePossibleCenter(i,u,m);if(b!==null)return b}i[0]=i[2],i[1]=1,i[2]=0,w=1}else i[++w]++;else w===1&&w++,i[w]++;m++}if(this.foundPatternCross(i)){const b=this.handlePossibleCenter(i,u,r);if(b!==null)return b}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new H}static centerFromEnd(e,t){return t-e[2]-e[1]/2}foundPatternCross(e){const t=this.moduleSize,s=t/2;for(let r=0;r<3;r++)if(Math.abs(t-e[r])>=s)return!1;return!0}crossCheckVertical(e,t,s,r){const a=this.image,i=a.getHeight(),o=this.crossCheckStateCount;o[0]=0,o[1]=0,o[2]=0;let l=e;for(;l>=0&&a.get(t,l)&&o[1]<=s;)o[1]++,l--;if(l<0||o[1]>s)return NaN;for(;l>=0&&!a.get(t,l)&&o[0]<=s;)o[0]++,l--;if(o[0]>s)return NaN;for(l=e+1;l<i&&a.get(t,l)&&o[1]<=s;)o[1]++,l++;if(l===i||o[1]>s)return NaN;for(;l<i&&!a.get(t,l)&&o[2]<=s;)o[2]++,l++;if(o[2]>s)return NaN;const u=o[0]+o[1]+o[2];return 5*Math.abs(u-r)>=2*r?NaN:this.foundPatternCross(o)?cn.centerFromEnd(o,l):NaN}handlePossibleCenter(e,t,s){const r=e[0]+e[1]+e[2],a=cn.centerFromEnd(e,s),i=this.crossCheckVertical(t,a,2*e[1],r);if(!isNaN(i)){const o=(e[0]+e[1]+e[2])/3;for(const u of this.possibleCenters)if(u.aboutEquals(o,i,a))return u.combineEstimate(i,a,o);const l=new Hn(a,i,o);this.possibleCenters.push(l),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(l)}return null}}class zn extends ce{constructor(e,t,s,r){super(e,t),this.estimatedModuleSize=s,this.count=r,r===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(e,t,s){if(Math.abs(t-this.getY())<=e&&Math.abs(s-this.getX())<=e){const r=Math.abs(e-this.estimatedModuleSize);return r<=1||r<=this.estimatedModuleSize}return!1}combineEstimate(e,t,s){const r=this.count+1,a=(this.count*this.getX()+t)/r,i=(this.count*this.getY()+e)/r,o=(this.count*this.estimatedModuleSize+s)/r;return new zn(a,i,o,r)}}class Za{constructor(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class ct{constructor(e,t){this.image=e,this.resultPointCallback=t,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=t}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(e){const t=e!=null&&e.get(v.TRY_HARDER)!==void 0,s=e!=null&&e.get(v.PURE_BARCODE)!==void 0,r=this.image,a=r.getHeight(),i=r.getWidth();let o=Math.floor(3*a/(4*ct.MAX_MODULES));(o<ct.MIN_SKIP||t)&&(o=ct.MIN_SKIP);let l=!1;const u=new Int32Array(5);for(let w=o-1;w<a&&!l;w+=o){u[0]=0,u[1]=0,u[2]=0,u[3]=0,u[4]=0;let b=0;for(let E=0;E<i;E++)if(r.get(E,w))(b&1)===1&&b++,u[b]++;else if(b&1)u[b]++;else if(b===4)if(ct.foundPatternCross(u)){if(this.handlePossibleCenter(u,w,E,s)===!0)if(o=2,this.hasSkipped===!0)l=this.haveMultiplyConfirmedCenters();else{const O=this.findRowSkip();O>u[2]&&(w+=O-u[2]-o,E=i-1)}else{u[0]=u[2],u[1]=u[3],u[2]=u[4],u[3]=1,u[4]=0,b=3;continue}b=0,u[0]=0,u[1]=0,u[2]=0,u[3]=0,u[4]=0}else u[0]=u[2],u[1]=u[3],u[2]=u[4],u[3]=1,u[4]=0,b=3;else u[++b]++;ct.foundPatternCross(u)&&this.handlePossibleCenter(u,w,i,s)===!0&&(o=u[0],this.hasSkipped&&(l=this.haveMultiplyConfirmedCenters()))}const m=this.selectBestPatterns();return ce.orderBestPatterns(m),new Za(m)}static centerFromEnd(e,t){return t-e[4]-e[3]-e[2]/2}static foundPatternCross(e){let t=0;for(let a=0;a<5;a++){const i=e[a];if(i===0)return!1;t+=i}if(t<7)return!1;const s=t/7,r=s/2;return Math.abs(s-e[0])<r&&Math.abs(s-e[1])<r&&Math.abs(3*s-e[2])<3*r&&Math.abs(s-e[3])<r&&Math.abs(s-e[4])<r}getCrossCheckStateCount(){const e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e}crossCheckDiagonal(e,t,s,r){const a=this.getCrossCheckStateCount();let i=0;const o=this.image;for(;e>=i&&t>=i&&o.get(t-i,e-i);)a[2]++,i++;if(e<i||t<i)return!1;for(;e>=i&&t>=i&&!o.get(t-i,e-i)&&a[1]<=s;)a[1]++,i++;if(e<i||t<i||a[1]>s)return!1;for(;e>=i&&t>=i&&o.get(t-i,e-i)&&a[0]<=s;)a[0]++,i++;if(a[0]>s)return!1;const l=o.getHeight(),u=o.getWidth();for(i=1;e+i<l&&t+i<u&&o.get(t+i,e+i);)a[2]++,i++;if(e+i>=l||t+i>=u)return!1;for(;e+i<l&&t+i<u&&!o.get(t+i,e+i)&&a[3]<s;)a[3]++,i++;if(e+i>=l||t+i>=u||a[3]>=s)return!1;for(;e+i<l&&t+i<u&&o.get(t+i,e+i)&&a[4]<s;)a[4]++,i++;if(a[4]>=s)return!1;const m=a[0]+a[1]+a[2]+a[3]+a[4];return Math.abs(m-r)<2*r&&ct.foundPatternCross(a)}crossCheckVertical(e,t,s,r){const a=this.image,i=a.getHeight(),o=this.getCrossCheckStateCount();let l=e;for(;l>=0&&a.get(t,l);)o[2]++,l--;if(l<0)return NaN;for(;l>=0&&!a.get(t,l)&&o[1]<=s;)o[1]++,l--;if(l<0||o[1]>s)return NaN;for(;l>=0&&a.get(t,l)&&o[0]<=s;)o[0]++,l--;if(o[0]>s)return NaN;for(l=e+1;l<i&&a.get(t,l);)o[2]++,l++;if(l===i)return NaN;for(;l<i&&!a.get(t,l)&&o[3]<s;)o[3]++,l++;if(l===i||o[3]>=s)return NaN;for(;l<i&&a.get(t,l)&&o[4]<s;)o[4]++,l++;if(o[4]>=s)return NaN;const u=o[0]+o[1]+o[2]+o[3]+o[4];return 5*Math.abs(u-r)>=2*r?NaN:ct.foundPatternCross(o)?ct.centerFromEnd(o,l):NaN}crossCheckHorizontal(e,t,s,r){const a=this.image,i=a.getWidth(),o=this.getCrossCheckStateCount();let l=e;for(;l>=0&&a.get(l,t);)o[2]++,l--;if(l<0)return NaN;for(;l>=0&&!a.get(l,t)&&o[1]<=s;)o[1]++,l--;if(l<0||o[1]>s)return NaN;for(;l>=0&&a.get(l,t)&&o[0]<=s;)o[0]++,l--;if(o[0]>s)return NaN;for(l=e+1;l<i&&a.get(l,t);)o[2]++,l++;if(l===i)return NaN;for(;l<i&&!a.get(l,t)&&o[3]<s;)o[3]++,l++;if(l===i||o[3]>=s)return NaN;for(;l<i&&a.get(l,t)&&o[4]<s;)o[4]++,l++;if(o[4]>=s)return NaN;const u=o[0]+o[1]+o[2]+o[3]+o[4];return 5*Math.abs(u-r)>=r?NaN:ct.foundPatternCross(o)?ct.centerFromEnd(o,l):NaN}handlePossibleCenter(e,t,s,r){const a=e[0]+e[1]+e[2]+e[3]+e[4];let i=ct.centerFromEnd(e,s),o=this.crossCheckVertical(t,Math.floor(i),e[2],a);if(!isNaN(o)&&(i=this.crossCheckHorizontal(Math.floor(i),Math.floor(o),e[2],a),!isNaN(i)&&(!r||this.crossCheckDiagonal(Math.floor(o),Math.floor(i),e[2],a)))){const l=a/7;let u=!1;const m=this.possibleCenters;for(let w=0,b=m.length;w<b;w++){const E=m[w];if(E.aboutEquals(l,o,i)){m[w]=E.combineEstimate(o,i,l),u=!0;break}}if(!u){const w=new zn(i,o,l);m.push(w),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(w)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let t=null;for(const s of this.possibleCenters)if(s.getCount()>=ct.CENTER_QUORUM)if(t==null)t=s;else return this.hasSkipped=!0,Math.floor((Math.abs(t.getX()-s.getX())-Math.abs(t.getY()-s.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let e=0,t=0;const s=this.possibleCenters.length;for(const i of this.possibleCenters)i.getCount()>=ct.CENTER_QUORUM&&(e++,t+=i.getEstimatedModuleSize());if(e<3)return!1;const r=t/s;let a=0;for(const i of this.possibleCenters)a+=Math.abs(i.getEstimatedModuleSize()-r);return a<=.05*t}selectBestPatterns(){const e=this.possibleCenters.length;if(e<3)throw new H;const t=this.possibleCenters;let s;if(e>3){let r=0,a=0;for(const l of this.possibleCenters){const u=l.getEstimatedModuleSize();r+=u,a+=u*u}s=r/e;let i=Math.sqrt(a/e-s*s);t.sort((l,u)=>{const m=Math.abs(u.getEstimatedModuleSize()-s),w=Math.abs(l.getEstimatedModuleSize()-s);return m<w?-1:m>w?1:0});const o=Math.max(.2*s,i);for(let l=0;l<t.length&&t.length>3;l++){const u=t[l];Math.abs(u.getEstimatedModuleSize()-s)>o&&(t.splice(l,1),l--)}}if(t.length>3){let r=0;for(const a of t)r+=a.getEstimatedModuleSize();s=r/t.length,t.sort((a,i)=>{if(i.getCount()===a.getCount()){const o=Math.abs(i.getEstimatedModuleSize()-s),l=Math.abs(a.getEstimatedModuleSize()-s);return o<l?1:o>l?-1:0}else return i.getCount()-a.getCount()}),t.splice(3)}return[t[0],t[1],t[2]]}}ct.CENTER_QUORUM=2,ct.MIN_SKIP=3,ct.MAX_MODULES=57;class Gs{constructor(e){this.image=e}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(e){this.resultPointCallback=e==null?null:e.get(v.NEED_RESULT_POINT_CALLBACK);const s=new ct(this.image,this.resultPointCallback).find(e);return this.processFinderPatternInfo(s)}processFinderPatternInfo(e){const t=e.getTopLeft(),s=e.getTopRight(),r=e.getBottomLeft(),a=this.calculateModuleSize(t,s,r);if(a<1)throw new H("No pattern found in proccess finder.");const i=Gs.computeDimension(t,s,r,a),o=he.getProvisionalVersionForDimension(i),l=o.getDimensionForVersion()-7;let u=null;if(o.getAlignmentPatternCenters().length>0){const E=s.getX()-t.getX()+r.getX(),_=s.getY()-t.getY()+r.getY(),O=1-3/l,k=Math.floor(t.getX()+O*(E-t.getX())),G=Math.floor(t.getY()+O*(_-t.getY()));for(let ee=4;ee<=16;ee<<=1)try{u=this.findAlignmentInRegion(a,k,G,ee);break}catch(te){if(!(te instanceof H))throw te}}const m=Gs.createTransform(t,s,r,u,i),w=Gs.sampleGrid(this.image,m,i);let b;return u===null?b=[r,t,s]:b=[r,t,s,u],new nn(w,b)}static createTransform(e,t,s,r,a){const i=a-3.5;let o,l,u,m;return r!==null?(o=r.getX(),l=r.getY(),u=i-3,m=u):(o=t.getX()-e.getX()+s.getX(),l=t.getY()-e.getY()+s.getY(),u=i,m=i),Ut.quadrilateralToQuadrilateral(3.5,3.5,i,3.5,u,m,3.5,i,e.getX(),e.getY(),t.getX(),t.getY(),o,l,s.getX(),s.getY())}static sampleGrid(e,t,s){return is.getInstance().sampleGridWithTransform(e,s,s,t)}static computeDimension(e,t,s,r){const a=Ie.round(ce.distance(e,t)/r),i=Ie.round(ce.distance(e,s)/r);let o=Math.floor((a+i)/2)+7;switch(o&3){case 0:o++;break;case 2:o--;break;case 3:throw new H("Dimensions could be not found.")}return o}calculateModuleSize(e,t,s){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,s))/2}calculateModuleSizeOneWay(e,t){const s=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY())),r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(s)?r/7:isNaN(r)?s/7:(s+r)/14}sizeOfBlackWhiteBlackRunBothWays(e,t,s,r){let a=this.sizeOfBlackWhiteBlackRun(e,t,s,r),i=1,o=e-(s-e);o<0?(i=e/(e-o),o=0):o>=this.image.getWidth()&&(i=(this.image.getWidth()-1-e)/(o-e),o=this.image.getWidth()-1);let l=Math.floor(t-(r-t)*i);return i=1,l<0?(i=t/(t-l),l=0):l>=this.image.getHeight()&&(i=(this.image.getHeight()-1-t)/(l-t),l=this.image.getHeight()-1),o=Math.floor(e+(o-e)*i),a+=this.sizeOfBlackWhiteBlackRun(e,t,o,l),a-1}sizeOfBlackWhiteBlackRun(e,t,s,r){const a=Math.abs(r-t)>Math.abs(s-e);if(a){let E=e;e=t,t=E,E=s,s=r,r=E}const i=Math.abs(s-e),o=Math.abs(r-t);let l=-i/2;const u=e<s?1:-1,m=t<r?1:-1;let w=0;const b=s+u;for(let E=e,_=t;E!==b;E+=u){const O=a?_:E,k=a?E:_;if(w===1===this.image.get(O,k)){if(w===2)return Ie.distance(E,_,e,t);w++}if(l+=o,l>0){if(_===r)break;_+=m,l-=i}}return w===2?Ie.distance(s+u,r,e,t):NaN}findAlignmentInRegion(e,t,s,r){const a=Math.floor(r*e),i=Math.max(0,t-a),o=Math.min(this.image.getWidth()-1,t+a);if(o-i<e*3)throw new H("Alignment top exceeds estimated module size.");const l=Math.max(0,s-a),u=Math.min(this.image.getHeight()-1,s+a);if(u-l<e*3)throw new H("Alignment bottom exceeds estimated module size.");return new cn(this.image,i,l,o-i,u-l,e,this.resultPointCallback).find()}}class ds{constructor(){this.decoder=new qa}getDecoder(){return this.decoder}decode(e,t){let s,r;if(t!=null&&t.get(v.PURE_BARCODE)!==void 0){const l=ds.extractPureBits(e.getBlackMatrix());s=this.decoder.decodeBitMatrix(l,t),r=ds.NO_POINTS}else{const l=new Gs(e.getBlackMatrix()).detect(t);s=this.decoder.decodeBitMatrix(l.getBits(),t),r=l.getPoints()}s.getOther()instanceof Nr&&s.getOther().applyMirroredCorrection(r);const a=new dt(s.getText(),s.getRawBytes(),void 0,r,xe.QR_CODE,void 0),i=s.getByteSegments();i!==null&&a.putMetadata(ot.BYTE_SEGMENTS,i);const o=s.getECLevel();return o!==null&&a.putMetadata(ot.ERROR_CORRECTION_LEVEL,o),s.hasStructuredAppend()&&(a.putMetadata(ot.STRUCTURED_APPEND_SEQUENCE,s.getStructuredAppendSequenceNumber()),a.putMetadata(ot.STRUCTURED_APPEND_PARITY,s.getStructuredAppendParity())),a}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),s=e.getBottomRightOnBit();if(t===null||s===null)throw new H;const r=this.moduleSize(t,e);let a=t[1],i=s[1],o=t[0],l=s[0];if(o>=l||a>=i)throw new H;if(i-a!==l-o&&(l=o+(i-a),l>=e.getWidth()))throw new H;const u=Math.round((l-o+1)/r),m=Math.round((i-a+1)/r);if(u<=0||m<=0)throw new H;if(m!==u)throw new H;const w=Math.floor(r/2);a+=w,o+=w;const b=o+Math.floor((u-1)*r)-l;if(b>0){if(b>w)throw new H;o-=b}const E=a+Math.floor((m-1)*r)-i;if(E>0){if(E>w)throw new H;a-=E}const _=new Ce(u,m);for(let O=0;O<m;O++){const k=a+Math.floor(O*r);for(let G=0;G<u;G++)e.get(o+Math.floor(G*r),k)&&_.set(G,O)}return _}static moduleSize(e,t){const s=t.getHeight(),r=t.getWidth();let a=e[0],i=e[1],o=!0,l=0;for(;a<r&&i<s;){if(o!==t.get(a,i)){if(++l===5)break;o=!o}a++,i++}if(a===r||i===s)throw new H;return(a-e[0])/7}}ds.NO_POINTS=new Array;class pe{PDF417Common(){}static getBitCountSum(e){return Ie.sum(e)}static toIntArray(e){if(e==null||!e.length)return pe.EMPTY_INT_ARRAY;const t=new Int32Array(e.length);let s=0;for(const r of e)t[s++]=r;return t}static getCodeword(e){const t=X.binarySearch(pe.SYMBOL_TABLE,e&262143);return t<0?-1:(pe.CODEWORD_TABLE[t]-1)%pe.NUMBER_OF_CODEWORDS}}pe.NUMBER_OF_CODEWORDS=929,pe.MAX_CODEWORDS_IN_BARCODE=pe.NUMBER_OF_CODEWORDS-1,pe.MIN_ROWS_IN_BARCODE=3,pe.MAX_ROWS_IN_BARCODE=90,pe.MODULES_IN_CODEWORD=17,pe.MODULES_IN_STOP_PATTERN=18,pe.BARS_IN_MODULE=8,pe.EMPTY_INT_ARRAY=new Int32Array([]),pe.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),pe.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class Qa{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class Ne{static detectMultiple(e,t,s){let r=e.getBlackMatrix(),a=Ne.detect(s,r);return a.length||(r=r.clone(),r.rotate180(),a=Ne.detect(s,r)),new Qa(r,a)}static detect(e,t){const s=new Array;let r=0,a=0,i=!1;for(;r<t.getHeight();){const o=Ne.findVertices(t,r,a);if(o[0]==null&&o[3]==null){if(!i)break;i=!1,a=0;for(const l of s)l[1]!=null&&(r=Math.trunc(Math.max(r,l[1].getY()))),l[3]!=null&&(r=Math.max(r,Math.trunc(l[3].getY())));r+=Ne.ROW_STEP;continue}if(i=!0,s.push(o),!e)break;o[2]!=null?(a=Math.trunc(o[2].getX()),r=Math.trunc(o[2].getY())):(a=Math.trunc(o[4].getX()),r=Math.trunc(o[4].getY()))}return s}static findVertices(e,t,s){const r=e.getHeight(),a=e.getWidth(),i=new Array(8);return Ne.copyToResult(i,Ne.findRowsWithPattern(e,r,a,t,s,Ne.START_PATTERN),Ne.INDEXES_START_PATTERN),i[4]!=null&&(s=Math.trunc(i[4].getX()),t=Math.trunc(i[4].getY())),Ne.copyToResult(i,Ne.findRowsWithPattern(e,r,a,t,s,Ne.STOP_PATTERN),Ne.INDEXES_STOP_PATTERN),i}static copyToResult(e,t,s){for(let r=0;r<s.length;r++)e[s[r]]=t[r]}static findRowsWithPattern(e,t,s,r,a,i){const o=new Array(4);let l=!1;const u=new Int32Array(i.length);for(;r<t;r+=Ne.ROW_STEP){let w=Ne.findGuardPattern(e,a,r,s,!1,i,u);if(w!=null){for(;r>0;){const b=Ne.findGuardPattern(e,a,--r,s,!1,i,u);if(b!=null)w=b;else{r++;break}}o[0]=new ce(w[0],r),o[1]=new ce(w[1],r),l=!0;break}}let m=r+1;if(l){let w=0,b=Int32Array.from([Math.trunc(o[0].getX()),Math.trunc(o[1].getX())]);for(;m<t;m++){const E=Ne.findGuardPattern(e,b[0],m,s,!1,i,u);if(E!=null&&Math.abs(b[0]-E[0])<Ne.MAX_PATTERN_DRIFT&&Math.abs(b[1]-E[1])<Ne.MAX_PATTERN_DRIFT)b=E,w=0;else{if(w>Ne.SKIPPED_ROW_COUNT_MAX)break;w++}}m-=w+1,o[2]=new ce(b[0],m),o[3]=new ce(b[1],m)}return m-r<Ne.BARCODE_MIN_HEIGHT&&X.fill(o,null),o}static findGuardPattern(e,t,s,r,a,i,o){X.fillWithin(o,0,o.length,0);let l=t,u=0;for(;e.get(l,s)&&l>0&&u++<Ne.MAX_PIXEL_DRIFT;)l--;let m=l,w=0,b=i.length;for(let E=a;m<r;m++)if(e.get(m,s)!==E)o[w]++;else{if(w===b-1){if(Ne.patternMatchVariance(o,i,Ne.MAX_INDIVIDUAL_VARIANCE)<Ne.MAX_AVG_VARIANCE)return new Int32Array([l,m]);l+=o[0]+o[1],U.arraycopy(o,2,o,0,w-1),o[w-1]=0,o[w]=0,w--}else w++;o[w]=1,E=!E}return w===b-1&&Ne.patternMatchVariance(o,i,Ne.MAX_INDIVIDUAL_VARIANCE)<Ne.MAX_AVG_VARIANCE?new Int32Array([l,m-1]):null}static patternMatchVariance(e,t,s){let r=e.length,a=0,i=0;for(let u=0;u<r;u++)a+=e[u],i+=t[u];if(a<i)return 1/0;let o=a/i;s*=o;let l=0;for(let u=0;u<r;u++){let m=e[u],w=t[u]*o,b=m>w?m-w:w-m;if(b>s)return 1/0;l+=b}return l/a}}Ne.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Ne.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Ne.MAX_AVG_VARIANCE=.42,Ne.MAX_INDIVIDUAL_VARIANCE=.8,Ne.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Ne.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Ne.MAX_PIXEL_DRIFT=3,Ne.MAX_PATTERN_DRIFT=5,Ne.SKIPPED_ROW_COUNT_MAX=25,Ne.ROW_STEP=5,Ne.BARCODE_MIN_HEIGHT=10;class ut{constructor(e,t){if(t.length===0)throw new S;this.field=e;let s=t.length;if(s>1&&t[0]===0){let r=1;for(;r<s&&t[r]===0;)r++;r===s?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(s-r),U.arraycopy(t,r,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(e===0)return this.getCoefficient(0);if(e===1){let r=0;for(let a of this.coefficients)r=this.field.add(r,a);return r}let t=this.coefficients[0],s=this.coefficients.length;for(let r=1;r<s;r++)t=this.field.add(this.field.multiply(e,t),this.coefficients[r]);return t}add(e){if(!this.field.equals(e.field))throw new S("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,s=e.coefficients;if(t.length>s.length){let i=t;t=s,s=i}let r=new Int32Array(s.length),a=s.length-t.length;U.arraycopy(s,0,r,0,a);for(let i=a;i<s.length;i++)r[i]=this.field.add(t[i-a],s[i]);return new ut(this.field,r)}subtract(e){if(!this.field.equals(e.field))throw new S("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())}multiply(e){return e instanceof ut?this.multiplyOther(e):this.multiplyScalar(e)}multiplyOther(e){if(!this.field.equals(e.field))throw new S("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new ut(this.field,new Int32Array([0]));let t=this.coefficients,s=t.length,r=e.coefficients,a=r.length,i=new Int32Array(s+a-1);for(let o=0;o<s;o++){let l=t[o];for(let u=0;u<a;u++)i[o+u]=this.field.add(i[o+u],this.field.multiply(l,r[u]))}return new ut(this.field,i)}negative(){let e=this.coefficients.length,t=new Int32Array(e);for(let s=0;s<e;s++)t[s]=this.field.subtract(0,this.coefficients[s]);return new ut(this.field,t)}multiplyScalar(e){if(e===0)return new ut(this.field,new Int32Array([0]));if(e===1)return this;let t=this.coefficients.length,s=new Int32Array(t);for(let r=0;r<t;r++)s[r]=this.field.multiply(this.coefficients[r],e);return new ut(this.field,s)}multiplyByMonomial(e,t){if(e<0)throw new S;if(t===0)return new ut(this.field,new Int32Array([0]));let s=this.coefficients.length,r=new Int32Array(s+e);for(let a=0;a<s;a++)r[a]=this.field.multiply(this.coefficients[a],t);return new ut(this.field,r)}toString(){let e=new ae;for(let t=this.getDegree();t>=0;t--){let s=this.getCoefficient(t);s!==0&&(s<0?(e.append(" - "),s=-s):e.length()>0&&e.append(" + "),(t===0||s!==1)&&e.append(s),t!==0&&(t===1?e.append("x"):(e.append("x^"),e.append(t))))}return e.toString()}}class Ka{add(e,t){return(e+t)%this.modulus}subtract(e,t){return(this.modulus+e-t)%this.modulus}exp(e){return this.expTable[e]}log(e){if(e===0)throw new S;return this.logTable[e]}inverse(e){if(e===0)throw new tn;return this.expTable[this.modulus-this.logTable[e]-1]}multiply(e,t){return e===0||t===0?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.modulus-1)]}getSize(){return this.modulus}equals(e){return e===this}}class Vn extends Ka{constructor(e,t){super(),this.modulus=e,this.expTable=new Int32Array(e),this.logTable=new Int32Array(e);let s=1;for(let r=0;r<e;r++)this.expTable[r]=s,s=s*t%e;for(let r=0;r<e-1;r++)this.logTable[this.expTable[r]]=r;this.zero=new ut(this,new Int32Array([0])),this.one=new ut(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new S;if(t===0)return this.zero;let s=new Int32Array(e+1);return s[0]=t,new ut(this,s)}}Vn.PDF417_GF=new Vn(pe.NUMBER_OF_CODEWORDS,3);class Cr{constructor(){this.field=Vn.PDF417_GF}decode(e,t,s){let r=new ut(this.field,e),a=new Int32Array(t),i=!1;for(let _=t;_>0;_--){let O=r.evaluateAt(this.field.exp(_));a[t-_]=O,O!==0&&(i=!0)}if(!i)return 0;let o=this.field.getOne();if(s!=null)for(const _ of s){let O=this.field.exp(e.length-1-_),k=new ut(this.field,new Int32Array([this.field.subtract(0,O),1]));o=o.multiply(k)}let l=new ut(this.field,a),u=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),l,t),m=u[0],w=u[1],b=this.findErrorLocations(m),E=this.findErrorMagnitudes(w,m,b);for(let _=0;_<b.length;_++){let O=e.length-1-this.field.log(b[_]);if(O<0)throw Q.getChecksumInstance();e[O]=this.field.subtract(e[O],E[_])}return b.length}runEuclideanAlgorithm(e,t,s){if(e.getDegree()<t.getDegree()){let b=e;e=t,t=b}let r=e,a=t,i=this.field.getZero(),o=this.field.getOne();for(;a.getDegree()>=Math.round(s/2);){let b=r,E=i;if(r=a,i=o,r.isZero())throw Q.getChecksumInstance();a=b;let _=this.field.getZero(),O=r.getCoefficient(r.getDegree()),k=this.field.inverse(O);for(;a.getDegree()>=r.getDegree()&&!a.isZero();){let G=a.getDegree()-r.getDegree(),ee=this.field.multiply(a.getCoefficient(a.getDegree()),k);_=_.add(this.field.buildMonomial(G,ee)),a=a.subtract(r.multiplyByMonomial(G,ee))}o=_.multiply(i).subtract(E).negative()}let l=o.getCoefficient(0);if(l===0)throw Q.getChecksumInstance();let u=this.field.inverse(l),m=o.multiply(u),w=a.multiply(u);return[m,w]}findErrorLocations(e){let t=e.getDegree(),s=new Int32Array(t),r=0;for(let a=1;a<this.field.getSize()&&r<t;a++)e.evaluateAt(a)===0&&(s[r]=this.field.inverse(a),r++);if(r!==t)throw Q.getChecksumInstance();return s}findErrorMagnitudes(e,t,s){let r=t.getDegree(),a=new Int32Array(r);for(let u=1;u<=r;u++)a[r-u]=this.field.multiply(u,t.getCoefficient(u));let i=new ut(this.field,a),o=s.length,l=new Int32Array(o);for(let u=0;u<o;u++){let m=this.field.inverse(s[u]),w=this.field.subtract(0,e.evaluateAt(m)),b=this.field.inverse(i.evaluateAt(m));l[u]=this.field.multiply(w,b)}return l}}class bs{constructor(e,t,s,r,a){e instanceof bs?this.constructor_2(e):this.constructor_1(e,t,s,r,a)}constructor_1(e,t,s,r,a){const i=t==null||s==null,o=r==null||a==null;if(i&&o)throw new H;i?(t=new ce(0,r.getY()),s=new ce(0,a.getY())):o&&(r=new ce(e.getWidth()-1,t.getY()),a=new ce(e.getWidth()-1,s.getY())),this.image=e,this.topLeft=t,this.bottomLeft=s,this.topRight=r,this.bottomRight=a,this.minX=Math.trunc(Math.min(t.getX(),s.getX())),this.maxX=Math.trunc(Math.max(r.getX(),a.getX())),this.minY=Math.trunc(Math.min(t.getY(),r.getY())),this.maxY=Math.trunc(Math.max(s.getY(),a.getY()))}constructor_2(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()}static merge(e,t){return e==null?t:t==null?e:new bs(e.image,e.topLeft,e.bottomLeft,t.topRight,t.bottomRight)}addMissingRows(e,t,s){let r=this.topLeft,a=this.bottomLeft,i=this.topRight,o=this.bottomRight;if(e>0){let l=s?this.topLeft:this.topRight,u=Math.trunc(l.getY()-e);u<0&&(u=0);let m=new ce(l.getX(),u);s?r=m:i=m}if(t>0){let l=s?this.bottomLeft:this.bottomRight,u=Math.trunc(l.getY()+t);u>=this.image.getHeight()&&(u=this.image.getHeight()-1);let m=new ce(l.getX(),u);s?a=m:o=m}return new bs(this.image,r,a,i,o)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class Ja{constructor(e,t,s,r){this.columnCount=e,this.errorCorrectionLevel=r,this.rowCountUpperPart=t,this.rowCountLowerPart=s,this.rowCount=t+s}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Ws{constructor(){this.buffer=""}static form(e,t){let s=-1;function r(i,o,l,u,m,w){if(i==="%%")return"%";if(t[++s]===void 0)return;i=u?parseInt(u.substr(1)):void 0;let b=m?parseInt(m.substr(1)):void 0,E;switch(w){case"s":E=t[s];break;case"c":E=t[s][0];break;case"f":E=parseFloat(t[s]).toFixed(i);break;case"p":E=parseFloat(t[s]).toPrecision(i);break;case"e":E=parseFloat(t[s]).toExponential(i);break;case"x":E=parseInt(t[s]).toString(b||16);break;case"d":E=parseFloat(parseInt(t[s],b||10).toPrecision(i)).toFixed(0);break}E=typeof E=="object"?JSON.stringify(E):(+E).toString(b);let _=parseInt(l),O=l&&l[0]+""=="0"?"0":" ";for(;E.length<_;)E=o!==void 0?E+O:O+E;return E}let a=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(a,r)}format(e,...t){this.buffer+=Ws.form(e,t)}toString(){return this.buffer}}class Ys{constructor(e){this.boundingBox=new bs(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}getCodewordNearby(e){let t=this.getCodeword(e);if(t!=null)return t;for(let s=1;s<Ys.MAX_NEARBY_DISTANCE;s++){let r=this.imageRowToCodewordIndex(e)-s;if(r>=0&&(t=this.codewords[r],t!=null)||(r=this.imageRowToCodewordIndex(e)+s,r<this.codewords.length&&(t=this.codewords[r],t!=null)))return t}return null}imageRowToCodewordIndex(e){return e-this.boundingBox.getMinY()}setCodeword(e,t){this.codewords[this.imageRowToCodewordIndex(e)]=t}getCodeword(e){return this.codewords[this.imageRowToCodewordIndex(e)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const e=new Ws;let t=0;for(const s of this.codewords){if(s==null){e.format("%3d:    |   %n",t++);continue}e.format("%3d: %3d|%3d%n",t++,s.getRowNumber(),s.getValue())}return e.toString()}}Ys.MAX_NEARBY_DISTANCE=5;class Xs{constructor(){this.values=new Map}setValue(e){e=Math.trunc(e);let t=this.values.get(e);t==null&&(t=0),t++,this.values.set(e,t)}getValue(){let e=-1,t=new Array;for(const[s,r]of this.values.entries()){const a={getKey:()=>s,getValue:()=>r};a.getValue()>e?(e=a.getValue(),t=[],t.push(a.getKey())):a.getValue()===e&&t.push(a.getKey())}return pe.toIntArray(t)}getConfidence(e){return this.values.get(e)}}class Ar extends Ys{constructor(e,t){super(e),this._isLeft=t}setRowNumbers(){for(let e of this.getCodewords())e!=null&&e.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(e){let t=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(t,e);let s=this.getBoundingBox(),r=this._isLeft?s.getTopLeft():s.getTopRight(),a=this._isLeft?s.getBottomLeft():s.getBottomRight(),i=this.imageRowToCodewordIndex(Math.trunc(r.getY())),o=this.imageRowToCodewordIndex(Math.trunc(a.getY())),l=-1,u=1,m=0;for(let w=i;w<o;w++){if(t[w]==null)continue;let b=t[w],E=b.getRowNumber()-l;if(E===0)m++;else if(E===1)u=Math.max(u,m),m=1,l=b.getRowNumber();else if(E<0||b.getRowNumber()>=e.getRowCount()||E>w)t[w]=null;else{let _;u>2?_=(u-2)*E:_=E;let O=_>=w;for(let k=1;k<=_&&!O;k++)O=t[w-k]!=null;O?t[w]=null:(l=b.getRowNumber(),m=1)}}}getRowHeights(){let e=this.getBarcodeMetadata();if(e==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(e);let t=new Int32Array(e.getRowCount());for(let s of this.getCodewords())if(s!=null){let r=s.getRowNumber();if(r>=t.length)continue;t[r]++}return t}adjustIncompleteIndicatorColumnRowNumbers(e){let t=this.getBoundingBox(),s=this._isLeft?t.getTopLeft():t.getTopRight(),r=this._isLeft?t.getBottomLeft():t.getBottomRight(),a=this.imageRowToCodewordIndex(Math.trunc(s.getY())),i=this.imageRowToCodewordIndex(Math.trunc(r.getY())),o=this.getCodewords(),l=-1;for(let u=a;u<i;u++){if(o[u]==null)continue;let m=o[u];m.setRowNumberAsRowIndicatorColumn();let w=m.getRowNumber()-l;w===0||(w===1?l=m.getRowNumber():m.getRowNumber()>=e.getRowCount()?o[u]=null:l=m.getRowNumber())}}getBarcodeMetadata(){let e=this.getCodewords(),t=new Xs,s=new Xs,r=new Xs,a=new Xs;for(let o of e){if(o==null)continue;o.setRowNumberAsRowIndicatorColumn();let l=o.getValue()%30,u=o.getRowNumber();switch(this._isLeft||(u+=2),u%3){case 0:s.setValue(l*3+1);break;case 1:a.setValue(l/3),r.setValue(l%3);break;case 2:t.setValue(l+1);break}}if(t.getValue().length===0||s.getValue().length===0||r.getValue().length===0||a.getValue().length===0||t.getValue()[0]<1||s.getValue()[0]+r.getValue()[0]<pe.MIN_ROWS_IN_BARCODE||s.getValue()[0]+r.getValue()[0]>pe.MAX_ROWS_IN_BARCODE)return null;let i=new Ja(t.getValue()[0],s.getValue()[0],r.getValue()[0],a.getValue()[0]);return this.removeIncorrectCodewords(e,i),i}removeIncorrectCodewords(e,t){for(let s=0;s<e.length;s++){let r=e[s];if(e[s]==null)continue;let a=r.getValue()%30,i=r.getRowNumber();if(i>t.getRowCount()){e[s]=null;continue}switch(this._isLeft||(i+=2),i%3){case 0:a*3+1!==t.getRowCountUpperPart()&&(e[s]=null);break;case 1:(Math.trunc(a/3)!==t.getErrorCorrectionLevel()||a%3!==t.getRowCountLowerPart())&&(e[s]=null);break;case 2:a+1!==t.getColumnCount()&&(e[s]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class qs{constructor(e,t){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=t,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let e=pe.MAX_CODEWORDS_IN_BARCODE,t;do t=e,e=this.adjustRowNumbersAndGetCount();while(e>0&&e<t);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(e){e!=null&&e.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let e=this.adjustRowNumbersByRow();if(e===0)return 0;for(let t=1;t<this.barcodeColumnCount+1;t++){let s=this.detectionResultColumns[t].getCodewords();for(let r=0;r<s.length;r++)s[r]!=null&&(s[r].hasValidRowNumber()||this.adjustRowNumbers(t,r,s))}return e}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let e=this.detectionResultColumns[0].getCodewords(),t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let s=0;s<e.length;s++)if(e[s]!=null&&t[s]!=null&&e[s].getRowNumber()===t[s].getRowNumber())for(let r=1;r<=this.barcodeColumnCount;r++){let a=this.detectionResultColumns[r].getCodewords()[s];a!=null&&(a.setRowNumber(e[s].getRowNumber()),a.hasValidRowNumber()||(this.detectionResultColumns[r].getCodewords()[s]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let e=0,t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let s=0;s<t.length;s++){if(t[s]==null)continue;let r=t[s].getRowNumber(),a=0;for(let i=this.barcodeColumnCount+1;i>0&&a<this.ADJUST_ROW_NUMBER_SKIP;i--){let o=this.detectionResultColumns[i].getCodewords()[s];o!=null&&(a=qs.adjustRowNumberIfValid(r,a,o),o.hasValidRowNumber()||e++)}}return e}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let e=0,t=this.detectionResultColumns[0].getCodewords();for(let s=0;s<t.length;s++){if(t[s]==null)continue;let r=t[s].getRowNumber(),a=0;for(let i=1;i<this.barcodeColumnCount+1&&a<this.ADJUST_ROW_NUMBER_SKIP;i++){let o=this.detectionResultColumns[i].getCodewords()[s];o!=null&&(a=qs.adjustRowNumberIfValid(r,a,o),o.hasValidRowNumber()||e++)}}return e}static adjustRowNumberIfValid(e,t,s){return s==null||s.hasValidRowNumber()||(s.isValidRowNumber(e)?(s.setRowNumber(e),t=0):++t),t}adjustRowNumbers(e,t,s){if(!this.detectionResultColumns[e-1])return;let r=s[t],a=this.detectionResultColumns[e-1].getCodewords(),i=a;this.detectionResultColumns[e+1]!=null&&(i=this.detectionResultColumns[e+1].getCodewords());let o=new Array(14);o[2]=a[t],o[3]=i[t],t>0&&(o[0]=s[t-1],o[4]=a[t-1],o[5]=i[t-1]),t>1&&(o[8]=s[t-2],o[10]=a[t-2],o[11]=i[t-2]),t<s.length-1&&(o[1]=s[t+1],o[6]=a[t+1],o[7]=i[t+1]),t<s.length-2&&(o[9]=s[t+2],o[12]=a[t+2],o[13]=i[t+2]);for(let l of o)if(qs.adjustRowNumber(r,l))return}static adjustRowNumber(e,t){return t==null?!1:t.hasValidRowNumber()&&t.getBucket()===e.getBucket()?(e.setRowNumber(t.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(e){this.boundingBox=e}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(e,t){this.detectionResultColumns[e]=t}getDetectionResultColumn(e){return this.detectionResultColumns[e]}toString(){let e=this.detectionResultColumns[0];e==null&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);let t=new Ws;for(let s=0;s<e.getCodewords().length;s++){t.format("CW %3d:",s);for(let r=0;r<this.barcodeColumnCount+2;r++){if(this.detectionResultColumns[r]==null){t.format("    |   ");continue}let a=this.detectionResultColumns[r].getCodewords()[s];if(a==null){t.format("    |   ");continue}t.format(" %3d|%3d",a.getRowNumber(),a.getValue())}t.format("%n")}return t.toString()}}class Zs{constructor(e,t,s,r){this.rowNumber=Zs.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(t),this.bucket=Math.trunc(s),this.value=Math.trunc(r)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(e){return e!==Zs.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(e){this.rowNumber=e}toString(){return this.rowNumber+"|"+this.value}}Zs.BARCODE_ROW_UNKNOWN=-1;class St{static initialize(){for(let e=0;e<pe.SYMBOL_TABLE.length;e++){let t=pe.SYMBOL_TABLE[e],s=t&1;for(let r=0;r<pe.BARS_IN_MODULE;r++){let a=0;for(;(t&1)===s;)a+=1,t>>=1;s=t&1,St.RATIOS_TABLE[e]||(St.RATIOS_TABLE[e]=new Array(pe.BARS_IN_MODULE)),St.RATIOS_TABLE[e][pe.BARS_IN_MODULE-r-1]=Math.fround(a/pe.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(e){let t=St.getDecodedCodewordValue(St.sampleBitCounts(e));return t!==-1?t:St.getClosestDecodedValue(e)}static sampleBitCounts(e){let t=Ie.sum(e),s=new Int32Array(pe.BARS_IN_MODULE),r=0,a=0;for(let i=0;i<pe.MODULES_IN_CODEWORD;i++){let o=t/(2*pe.MODULES_IN_CODEWORD)+i*t/pe.MODULES_IN_CODEWORD;a+e[r]<=o&&(a+=e[r],r++),s[r]++}return s}static getDecodedCodewordValue(e){let t=St.getBitValue(e);return pe.getCodeword(t)===-1?-1:t}static getBitValue(e){let t=0;for(let s=0;s<e.length;s++)for(let r=0;r<e[s];r++)t=t<<1|(s%2===0?1:0);return Math.trunc(t)}static getClosestDecodedValue(e){let t=Ie.sum(e),s=new Array(pe.BARS_IN_MODULE);if(t>1)for(let i=0;i<s.length;i++)s[i]=Math.fround(e[i]/t);let r=sn.MAX_VALUE,a=-1;this.bSymbolTableReady||St.initialize();for(let i=0;i<St.RATIOS_TABLE.length;i++){let o=0,l=St.RATIOS_TABLE[i];for(let u=0;u<pe.BARS_IN_MODULE;u++){let m=Math.fround(l[u]-s[u]);if(o+=Math.fround(m*m),o>=r)break}o<r&&(r=o,a=pe.SYMBOL_TABLE[i])}return a}}St.bSymbolTableReady=!1,St.RATIOS_TABLE=new Array(pe.SYMBOL_TABLE.length).map(y=>new Array(pe.BARS_IN_MODULE));class Er{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(e){this.segmentIndex=e}getFileId(){return this.fileId}setFileId(e){this.fileId=e}getOptionalData(){return this.optionalData}setOptionalData(e){this.optionalData=e}isLastSegment(){return this.lastSegment}setLastSegment(e){this.lastSegment=e}getSegmentCount(){return this.segmentCount}setSegmentCount(e){this.segmentCount=e}getSender(){return this.sender||null}setSender(e){this.sender=e}getAddressee(){return this.addressee||null}setAddressee(e){this.addressee=e}getFileName(){return this.fileName}setFileName(e){this.fileName=e}getFileSize(){return this.fileSize}setFileSize(e){this.fileSize=e}getChecksum(){return this.checksum}setChecksum(e){this.checksum=e}getTimestamp(){return this.timestamp}setTimestamp(e){this.timestamp=e}}class vr{static parseLong(e,t=void 0){return parseInt(e,t)}}class Sr extends p{}Sr.kind="NullPointerException";class $a{writeBytes(e){this.writeBytesOffset(e,0,e.length)}writeBytesOffset(e,t,s){if(e==null)throw new Sr;if(t<0||t>e.length||s<0||t+s>e.length||t+s<0)throw new z;if(s===0)return;for(let r=0;r<s;r++)this.write(e[t+r])}flush(){}close(){}}class ei extends p{}class ti extends $a{constructor(e=32){if(super(),this.count=0,e<0)throw new S("Negative initial size: "+e);this.buf=new Uint8Array(e)}ensureCapacity(e){e-this.buf.length>0&&this.grow(e)}grow(e){let s=this.buf.length<<1;if(s-e<0&&(s=e),s<0){if(e<0)throw new ei;s=W.MAX_VALUE}this.buf=X.copyOfUint8Array(this.buf,s)}write(e){this.ensureCapacity(this.count+1),this.buf[this.count]=e,this.count+=1}writeBytesOffset(e,t,s){if(t<0||t>e.length||s<0||t+s-e.length>0)throw new z;this.ensureCapacity(this.count+s),U.arraycopy(e,t,this.buf,this.count,s),this.count+=s}writeTo(e){e.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return X.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(e){return e?typeof e=="string"?this.toString_string(e):this.toString_number(e):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(e){return new String(this.buf).toString()}toString_number(e){return new String(this.buf).toString()}close(){}}var Le;(function(y){y[y.ALPHA=0]="ALPHA",y[y.LOWER=1]="LOWER",y[y.MIXED=2]="MIXED",y[y.PUNCT=3]="PUNCT",y[y.ALPHA_SHIFT=4]="ALPHA_SHIFT",y[y.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Le||(Le={}));function jr(){if(typeof window<"u")return window.BigInt||null;if(typeof Js<"u")return Js.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let dn;function hs(y){if(typeof dn>"u"&&(dn=jr()),dn===null)throw new Error("BigInt is not supported!");return dn(y)}function si(){let y=[];y[0]=hs(1);let e=hs(900);y[1]=e;for(let t=2;t<16;t++)y[t]=y[t-1]*e;return y}class V{static decode(e,t){let s=new ae(""),r=P.ISO8859_1;s.enableDecoding(r);let a=1,i=e[a++],o=new Er;for(;a<e[0];){switch(i){case V.TEXT_COMPACTION_MODE_LATCH:a=V.textCompaction(e,a,s);break;case V.BYTE_COMPACTION_MODE_LATCH:case V.BYTE_COMPACTION_MODE_LATCH_6:a=V.byteCompaction(i,e,r,a,s);break;case V.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:s.append(e[a++]);break;case V.NUMERIC_COMPACTION_MODE_LATCH:a=V.numericCompaction(e,a,s);break;case V.ECI_CHARSET:P.getCharacterSetECIByValue(e[a++]);break;case V.ECI_GENERAL_PURPOSE:a+=2;break;case V.ECI_USER_DEFINED:a++;break;case V.BEGIN_MACRO_PDF417_CONTROL_BLOCK:a=V.decodeMacroBlock(e,a,o);break;case V.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case V.MACRO_PDF417_TERMINATOR:throw new T;default:a--,a=V.textCompaction(e,a,s);break}if(a<e.length)i=e[a++];else throw T.getFormatInstance()}if(s.length()===0)throw T.getFormatInstance();let l=new Us(null,s.toString(),null,t);return l.setOther(o),l}static decodeMacroBlock(e,t,s){if(t+V.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw T.getFormatInstance();let r=new Int32Array(V.NUMBER_OF_SEQUENCE_CODEWORDS);for(let o=0;o<V.NUMBER_OF_SEQUENCE_CODEWORDS;o++,t++)r[o]=e[t];s.setSegmentIndex(W.parseInt(V.decodeBase900toBase10(r,V.NUMBER_OF_SEQUENCE_CODEWORDS)));let a=new ae;t=V.textCompaction(e,t,a),s.setFileId(a.toString());let i=-1;for(e[t]===V.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(i=t+1);t<e[0];)switch(e[t]){case V.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(t++,e[t]){case V.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let o=new ae;t=V.textCompaction(e,t+1,o),s.setFileName(o.toString());break;case V.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let l=new ae;t=V.textCompaction(e,t+1,l),s.setSender(l.toString());break;case V.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let u=new ae;t=V.textCompaction(e,t+1,u),s.setAddressee(u.toString());break;case V.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let m=new ae;t=V.numericCompaction(e,t+1,m),s.setSegmentCount(W.parseInt(m.toString()));break;case V.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let w=new ae;t=V.numericCompaction(e,t+1,w),s.setTimestamp(vr.parseLong(w.toString()));break;case V.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let b=new ae;t=V.numericCompaction(e,t+1,b),s.setChecksum(W.parseInt(b.toString()));break;case V.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let E=new ae;t=V.numericCompaction(e,t+1,E),s.setFileSize(vr.parseLong(E.toString()));break;default:throw T.getFormatInstance()}break;case V.MACRO_PDF417_TERMINATOR:t++,s.setLastSegment(!0);break;default:throw T.getFormatInstance()}if(i!==-1){let o=t-i;s.isLastSegment()&&o--,s.setOptionalData(X.copyOfRange(e,i,i+o))}return t}static textCompaction(e,t,s){let r=new Int32Array((e[0]-t)*2),a=new Int32Array((e[0]-t)*2),i=0,o=!1;for(;t<e[0]&&!o;){let l=e[t++];if(l<V.TEXT_COMPACTION_MODE_LATCH)r[i]=l/30,r[i+1]=l%30,i+=2;else switch(l){case V.TEXT_COMPACTION_MODE_LATCH:r[i++]=V.TEXT_COMPACTION_MODE_LATCH;break;case V.BYTE_COMPACTION_MODE_LATCH:case V.BYTE_COMPACTION_MODE_LATCH_6:case V.NUMERIC_COMPACTION_MODE_LATCH:case V.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case V.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case V.MACRO_PDF417_TERMINATOR:t--,o=!0;break;case V.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r[i]=V.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,l=e[t++],a[i]=l,i++;break}}return V.decodeTextCompaction(r,a,i,s),t}static decodeTextCompaction(e,t,s,r){let a=Le.ALPHA,i=Le.ALPHA,o=0;for(;o<s;){let l=e[o],u="";switch(a){case Le.ALPHA:if(l<26)u=String.fromCharCode(65+l);else switch(l){case 26:u=" ";break;case V.LL:a=Le.LOWER;break;case V.ML:a=Le.MIXED;break;case V.PS:i=a,a=Le.PUNCT_SHIFT;break;case V.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[o]);break;case V.TEXT_COMPACTION_MODE_LATCH:a=Le.ALPHA;break}break;case Le.LOWER:if(l<26)u=String.fromCharCode(97+l);else switch(l){case 26:u=" ";break;case V.AS:i=a,a=Le.ALPHA_SHIFT;break;case V.ML:a=Le.MIXED;break;case V.PS:i=a,a=Le.PUNCT_SHIFT;break;case V.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[o]);break;case V.TEXT_COMPACTION_MODE_LATCH:a=Le.ALPHA;break}break;case Le.MIXED:if(l<V.PL)u=V.MIXED_CHARS[l];else switch(l){case V.PL:a=Le.PUNCT;break;case 26:u=" ";break;case V.LL:a=Le.LOWER;break;case V.AL:a=Le.ALPHA;break;case V.PS:i=a,a=Le.PUNCT_SHIFT;break;case V.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[o]);break;case V.TEXT_COMPACTION_MODE_LATCH:a=Le.ALPHA;break}break;case Le.PUNCT:if(l<V.PAL)u=V.PUNCT_CHARS[l];else switch(l){case V.PAL:a=Le.ALPHA;break;case V.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[o]);break;case V.TEXT_COMPACTION_MODE_LATCH:a=Le.ALPHA;break}break;case Le.ALPHA_SHIFT:if(a=i,l<26)u=String.fromCharCode(65+l);else switch(l){case 26:u=" ";break;case V.TEXT_COMPACTION_MODE_LATCH:a=Le.ALPHA;break}break;case Le.PUNCT_SHIFT:if(a=i,l<V.PAL)u=V.PUNCT_CHARS[l];else switch(l){case V.PAL:a=Le.ALPHA;break;case V.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[o]);break;case V.TEXT_COMPACTION_MODE_LATCH:a=Le.ALPHA;break}break}u!==""&&r.append(u),o++}}static byteCompaction(e,t,s,r,a){let i=new ti,o=0,l=0,u=!1;switch(e){case V.BYTE_COMPACTION_MODE_LATCH:let m=new Int32Array(6),w=t[r++];for(;r<t[0]&&!u;)switch(m[o++]=w,l=900*l+w,w=t[r++],w){case V.TEXT_COMPACTION_MODE_LATCH:case V.BYTE_COMPACTION_MODE_LATCH:case V.NUMERIC_COMPACTION_MODE_LATCH:case V.BYTE_COMPACTION_MODE_LATCH_6:case V.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case V.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case V.MACRO_PDF417_TERMINATOR:r--,u=!0;break;default:if(o%5===0&&o>0){for(let b=0;b<6;++b)i.write(Number(hs(l)>>hs(8*(5-b))));l=0,o=0}break}r===t[0]&&w<V.TEXT_COMPACTION_MODE_LATCH&&(m[o++]=w);for(let b=0;b<o;b++)i.write(m[b]);break;case V.BYTE_COMPACTION_MODE_LATCH_6:for(;r<t[0]&&!u;){let b=t[r++];if(b<V.TEXT_COMPACTION_MODE_LATCH)o++,l=900*l+b;else switch(b){case V.TEXT_COMPACTION_MODE_LATCH:case V.BYTE_COMPACTION_MODE_LATCH:case V.NUMERIC_COMPACTION_MODE_LATCH:case V.BYTE_COMPACTION_MODE_LATCH_6:case V.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case V.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case V.MACRO_PDF417_TERMINATOR:r--,u=!0;break}if(o%5===0&&o>0){for(let E=0;E<6;++E)i.write(Number(hs(l)>>hs(8*(5-E))));l=0,o=0}}break}return a.append(q.decode(i.toByteArray(),s)),r}static numericCompaction(e,t,s){let r=0,a=!1,i=new Int32Array(V.MAX_NUMERIC_CODEWORDS);for(;t<e[0]&&!a;){let o=e[t++];if(t===e[0]&&(a=!0),o<V.TEXT_COMPACTION_MODE_LATCH)i[r]=o,r++;else switch(o){case V.TEXT_COMPACTION_MODE_LATCH:case V.BYTE_COMPACTION_MODE_LATCH:case V.BYTE_COMPACTION_MODE_LATCH_6:case V.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case V.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case V.MACRO_PDF417_TERMINATOR:t--,a=!0;break}(r%V.MAX_NUMERIC_CODEWORDS===0||o===V.NUMERIC_COMPACTION_MODE_LATCH||a)&&r>0&&(s.append(V.decodeBase900toBase10(i,r)),r=0)}return t}static decodeBase900toBase10(e,t){let s=hs(0);for(let a=0;a<t;a++)s+=V.EXP900[t-a-1]*hs(e[a]);let r=s.toString();if(r.charAt(0)!=="1")throw new T;return r.substring(1)}}V.TEXT_COMPACTION_MODE_LATCH=900,V.BYTE_COMPACTION_MODE_LATCH=901,V.NUMERIC_COMPACTION_MODE_LATCH=902,V.BYTE_COMPACTION_MODE_LATCH_6=924,V.ECI_USER_DEFINED=925,V.ECI_GENERAL_PURPOSE=926,V.ECI_CHARSET=927,V.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,V.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,V.MACRO_PDF417_TERMINATOR=922,V.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,V.MAX_NUMERIC_CODEWORDS=15,V.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,V.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,V.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,V.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,V.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,V.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,V.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,V.PL=25,V.LL=27,V.AS=27,V.ML=28,V.AL=28,V.PS=29,V.PAL=29,V.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,V.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",V.EXP900=jr()?si():[],V.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Ae{constructor(){}static decode(e,t,s,r,a,i,o){let l=new bs(e,t,s,r,a),u=null,m=null,w;for(let _=!0;;_=!1){if(t!=null&&(u=Ae.getRowIndicatorColumn(e,l,t,!0,i,o)),r!=null&&(m=Ae.getRowIndicatorColumn(e,l,r,!1,i,o)),w=Ae.merge(u,m),w==null)throw H.getNotFoundInstance();let O=w.getBoundingBox();if(_&&O!=null&&(O.getMinY()<l.getMinY()||O.getMaxY()>l.getMaxY()))l=O;else break}w.setBoundingBox(l);let b=w.getBarcodeColumnCount()+1;w.setDetectionResultColumn(0,u),w.setDetectionResultColumn(b,m);let E=u!=null;for(let _=1;_<=b;_++){let O=E?_:b-_;if(w.getDetectionResultColumn(O)!==void 0)continue;let k;O===0||O===b?k=new Ar(l,O===0):k=new Ys(l),w.setDetectionResultColumn(O,k);let G=-1,ee=G;for(let te=l.getMinY();te<=l.getMaxY();te++){if(G=Ae.getStartColumn(w,O,te,E),G<0||G>l.getMaxX()){if(ee===-1)continue;G=ee}let $=Ae.detectCodeword(e,l.getMinX(),l.getMaxX(),E,G,te,i,o);$!=null&&(k.setCodeword(te,$),ee=G,i=Math.min(i,$.getWidth()),o=Math.max(o,$.getWidth()))}}return Ae.createDecoderResult(w)}static merge(e,t){if(e==null&&t==null)return null;let s=Ae.getBarcodeMetadata(e,t);if(s==null)return null;let r=bs.merge(Ae.adjustBoundingBox(e),Ae.adjustBoundingBox(t));return new qs(s,r)}static adjustBoundingBox(e){if(e==null)return null;let t=e.getRowHeights();if(t==null)return null;let s=Ae.getMax(t),r=0;for(let o of t)if(r+=s-o,o>0)break;let a=e.getCodewords();for(let o=0;r>0&&a[o]==null;o++)r--;let i=0;for(let o=t.length-1;o>=0&&(i+=s-t[o],!(t[o]>0));o--);for(let o=a.length-1;i>0&&a[o]==null;o--)i--;return e.getBoundingBox().addMissingRows(r,i,e.isLeft())}static getMax(e){let t=-1;for(let s of e)t=Math.max(t,s);return t}static getBarcodeMetadata(e,t){let s;if(e==null||(s=e.getBarcodeMetadata())==null)return t==null?null:t.getBarcodeMetadata();let r;return t==null||(r=t.getBarcodeMetadata())==null?s:s.getColumnCount()!==r.getColumnCount()&&s.getErrorCorrectionLevel()!==r.getErrorCorrectionLevel()&&s.getRowCount()!==r.getRowCount()?null:s}static getRowIndicatorColumn(e,t,s,r,a,i){let o=new Ar(t,r);for(let l=0;l<2;l++){let u=l===0?1:-1,m=Math.trunc(Math.trunc(s.getX()));for(let w=Math.trunc(Math.trunc(s.getY()));w<=t.getMaxY()&&w>=t.getMinY();w+=u){let b=Ae.detectCodeword(e,0,e.getWidth(),r,m,w,a,i);b!=null&&(o.setCodeword(w,b),r?m=b.getStartX():m=b.getEndX())}}return o}static adjustCodewordCount(e,t){let s=t[0][1],r=s.getValue(),a=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-Ae.getNumberOfECCodeWords(e.getBarcodeECLevel());if(r.length===0){if(a<1||a>pe.MAX_CODEWORDS_IN_BARCODE)throw H.getNotFoundInstance();s.setValue(a)}else r[0]!==a&&s.setValue(a)}static createDecoderResult(e){let t=Ae.createBarcodeMatrix(e);Ae.adjustCodewordCount(e,t);let s=new Array,r=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),a=[],i=new Array;for(let l=0;l<e.getBarcodeRowCount();l++)for(let u=0;u<e.getBarcodeColumnCount();u++){let m=t[l][u+1].getValue(),w=l*e.getBarcodeColumnCount()+u;m.length===0?s.push(w):m.length===1?r[w]=m[0]:(i.push(w),a.push(m))}let o=new Array(a.length);for(let l=0;l<o.length;l++)o[l]=a[l];return Ae.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),r,pe.toIntArray(s),pe.toIntArray(i),o)}static createDecoderResultFromAmbiguousValues(e,t,s,r,a){let i=new Int32Array(r.length),o=100;for(;o-- >0;){for(let l=0;l<i.length;l++)t[r[l]]=a[l][i[l]];try{return Ae.decodeCodewords(t,e,s)}catch(l){if(!(l instanceof Q))throw l}if(i.length===0)throw Q.getChecksumInstance();for(let l=0;l<i.length;l++)if(i[l]<a[l].length-1){i[l]++;break}else if(i[l]=0,l===i.length-1)throw Q.getChecksumInstance()}throw Q.getChecksumInstance()}static createBarcodeMatrix(e){let t=Array.from({length:e.getBarcodeRowCount()},()=>new Array(e.getBarcodeColumnCount()+2));for(let r=0;r<t.length;r++)for(let a=0;a<t[r].length;a++)t[r][a]=new Xs;let s=0;for(let r of e.getDetectionResultColumns()){if(r!=null){for(let a of r.getCodewords())if(a!=null){let i=a.getRowNumber();if(i>=0){if(i>=t.length)continue;t[i][s].setValue(a.getValue())}}}s++}return t}static isValidBarcodeColumn(e,t){return t>=0&&t<=e.getBarcodeColumnCount()+1}static getStartColumn(e,t,s,r){let a=r?1:-1,i=null;if(Ae.isValidBarcodeColumn(e,t-a)&&(i=e.getDetectionResultColumn(t-a).getCodeword(s)),i!=null)return r?i.getEndX():i.getStartX();if(i=e.getDetectionResultColumn(t).getCodewordNearby(s),i!=null)return r?i.getStartX():i.getEndX();if(Ae.isValidBarcodeColumn(e,t-a)&&(i=e.getDetectionResultColumn(t-a).getCodewordNearby(s)),i!=null)return r?i.getEndX():i.getStartX();let o=0;for(;Ae.isValidBarcodeColumn(e,t-a);){t-=a;for(let l of e.getDetectionResultColumn(t).getCodewords())if(l!=null)return(r?l.getEndX():l.getStartX())+a*o*(l.getEndX()-l.getStartX());o++}return r?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()}static detectCodeword(e,t,s,r,a,i,o,l){a=Ae.adjustCodewordStartColumn(e,t,s,r,a,i);let u=Ae.getModuleBitCount(e,t,s,r,a,i);if(u==null)return null;let m,w=Ie.sum(u);if(r)m=a+w;else{for(let _=0;_<u.length/2;_++){let O=u[_];u[_]=u[u.length-1-_],u[u.length-1-_]=O}m=a,a=m-w}if(!Ae.checkCodewordSkew(w,o,l))return null;let b=St.getDecodedValue(u),E=pe.getCodeword(b);return E===-1?null:new Zs(a,m,Ae.getCodewordBucketNumber(b),E)}static getModuleBitCount(e,t,s,r,a,i){let o=a,l=new Int32Array(8),u=0,m=r?1:-1,w=r;for(;(r?o<s:o>=t)&&u<l.length;)e.get(o,i)===w?(l[u]++,o+=m):(u++,w=!w);return u===l.length||o===(r?s:t)&&u===l.length-1?l:null}static getNumberOfECCodeWords(e){return 2<<e}static adjustCodewordStartColumn(e,t,s,r,a,i){let o=a,l=r?-1:1;for(let u=0;u<2;u++){for(;(r?o>=t:o<s)&&r===e.get(o,i);){if(Math.abs(a-o)>Ae.CODEWORD_SKEW_SIZE)return a;o+=l}l=-l,r=!r}return o}static checkCodewordSkew(e,t,s){return t-Ae.CODEWORD_SKEW_SIZE<=e&&e<=s+Ae.CODEWORD_SKEW_SIZE}static decodeCodewords(e,t,s){if(e.length===0)throw T.getFormatInstance();let r=1<<t+1,a=Ae.correctErrors(e,s,r);Ae.verifyCodewordCount(e,r);let i=V.decode(e,""+t);return i.setErrorsCorrected(a),i.setErasures(s.length),i}static correctErrors(e,t,s){if(t!=null&&t.length>s/2+Ae.MAX_ERRORS||s<0||s>Ae.MAX_EC_CODEWORDS)throw Q.getChecksumInstance();return Ae.errorCorrection.decode(e,s,t)}static verifyCodewordCount(e,t){if(e.length<4)throw T.getFormatInstance();let s=e[0];if(s>e.length)throw T.getFormatInstance();if(s===0)if(t<e.length)e[0]=e.length-t;else throw T.getFormatInstance()}static getBitCountForCodeword(e){let t=new Int32Array(8),s=0,r=t.length-1;for(;!((e&1)!==s&&(s=e&1,r--,r<0));)t[r]++,e>>=1;return t}static getCodewordBucketNumber(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)}static getCodewordBucketNumber_number(e){return Ae.getCodewordBucketNumber(Ae.getBitCountForCodeword(e))}static getCodewordBucketNumber_Int32Array(e){return(e[0]-e[2]+e[4]-e[6]+9)%9}static toString(e){let t=new Ws;for(let s=0;s<e.length;s++){t.format("Row %2d: ",s);for(let r=0;r<e[s].length;r++){let a=e[s][r];a.getValue().length===0?t.format("        ",null):t.format("%4d(%2d)",a.getValue()[0],a.getConfidence(a.getValue()[0]))}t.format("%n")}return t.toString()}}Ae.CODEWORD_SKEW_SIZE=2,Ae.MAX_ERRORS=3,Ae.MAX_EC_CODEWORDS=512,Ae.errorCorrection=new Cr;class ft{decode(e,t=null){let s=ft.decode(e,t,!1);if(s==null||s.length===0||s[0]==null)throw H.getNotFoundInstance();return s[0]}decodeMultiple(e,t=null){try{return ft.decode(e,t,!0)}catch(s){throw s instanceof T||s instanceof Q?H.getNotFoundInstance():s}}static decode(e,t,s){const r=new Array,a=Ne.detectMultiple(e,t,s);for(const i of a.getPoints()){const o=Ae.decode(a.getBits(),i[4],i[5],i[6],i[7],ft.getMinCodewordWidth(i),ft.getMaxCodewordWidth(i)),l=new dt(o.getText(),o.getRawBytes(),void 0,i,xe.PDF_417);l.putMetadata(ot.ERROR_CORRECTION_LEVEL,o.getECLevel());const u=o.getOther();u!=null&&l.putMetadata(ot.PDF417_EXTRA_METADATA,u),r.push(l)}return r.map(i=>i)}static getMaxWidth(e,t){return e==null||t==null?0:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMinWidth(e,t){return e==null||t==null?W.MAX_VALUE:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMaxCodewordWidth(e){return Math.floor(Math.max(Math.max(ft.getMaxWidth(e[0],e[4]),ft.getMaxWidth(e[6],e[2])*pe.MODULES_IN_CODEWORD/pe.MODULES_IN_STOP_PATTERN),Math.max(ft.getMaxWidth(e[1],e[5]),ft.getMaxWidth(e[7],e[3])*pe.MODULES_IN_CODEWORD/pe.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(e){return Math.floor(Math.min(Math.min(ft.getMinWidth(e[0],e[4]),ft.getMinWidth(e[6],e[2])*pe.MODULES_IN_CODEWORD/pe.MODULES_IN_STOP_PATTERN),Math.min(ft.getMinWidth(e[1],e[5]),ft.getMinWidth(e[7],e[3])*pe.MODULES_IN_CODEWORD/pe.MODULES_IN_STOP_PATTERN)))}reset(){}}class hn extends p{}hn.kind="ReaderException";class Ir{constructor(e,t){this.verbose=e===!0,t&&this.setHints(t)}decode(e,t){return t&&this.setHints(t),this.decodeInternal(e)}decodeWithState(e){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(e)}setHints(e){this.hints=e;const t=!x(e)&&e.get(v.TRY_HARDER)===!0,s=x(e)?null:e.get(v.POSSIBLE_FORMATS),r=new Array;if(!x(s)){const a=s.some(i=>i===xe.UPC_A||i===xe.UPC_E||i===xe.EAN_13||i===xe.EAN_8||i===xe.CODABAR||i===xe.CODE_39||i===xe.CODE_93||i===xe.CODE_128||i===xe.ITF||i===xe.RSS_14||i===xe.RSS_EXPANDED);a&&!t&&r.push(new _s(e,this.verbose)),s.includes(xe.QR_CODE)&&r.push(new ds),s.includes(xe.DATA_MATRIX)&&r.push(new cs),s.includes(xe.AZTEC)&&r.push(new rn),s.includes(xe.PDF_417)&&r.push(new ft),a&&t&&r.push(new _s(e,this.verbose))}r.length===0&&(t||r.push(new _s(e,this.verbose)),r.push(new ds),r.push(new cs),r.push(new rn),r.push(new ft),t&&r.push(new _s(e,this.verbose))),this.readers=r}reset(){if(this.readers!==null)for(const e of this.readers)e.reset()}decodeInternal(e){if(this.readers===null)throw new hn("No readers where selected, nothing can be read.");for(const t of this.readers)try{return t.decode(e,this.hints)}catch(s){if(s instanceof hn)continue}throw new H("No MultiFormat Readers were able to detect the code.")}}class ni extends mt{constructor(e=null,t=500){const s=new Ir;s.setHints(e),super(s,t)}decodeBitmap(e){return this.reader.decodeWithState(e)}}class ri extends mt{constructor(e=500){super(new ft,e)}}class ai extends mt{constructor(e=500){super(new ds,e)}}var Gn;(function(y){y[y.ERROR_CORRECTION=0]="ERROR_CORRECTION",y[y.CHARACTER_SET=1]="CHARACTER_SET",y[y.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",y[y.MIN_SIZE=3]="MIN_SIZE",y[y.MAX_SIZE=4]="MAX_SIZE",y[y.MARGIN=5]="MARGIN",y[y.PDF417_COMPACT=6]="PDF417_COMPACT",y[y.PDF417_COMPACTION=7]="PDF417_COMPACTION",y[y.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",y[y.AZTEC_LAYERS=9]="AZTEC_LAYERS",y[y.QR_VERSION=10]="QR_VERSION"})(Gn||(Gn={}));var at=Gn;class Wn{constructor(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new At(e,Int32Array.from([1])))}buildGenerator(e){const t=this.cachedGenerators;if(e>=t.length){let s=t[t.length-1];const r=this.field;for(let a=t.length;a<=e;a++){const i=s.multiply(new At(r,Int32Array.from([1,r.exp(a-1+r.getGeneratorBase())])));t.push(i),s=i}}return t[e]}encode(e,t){if(t===0)throw new S("No error correction bytes");const s=e.length-t;if(s<=0)throw new S("No data bytes provided");const r=this.buildGenerator(t),a=new Int32Array(s);U.arraycopy(e,0,a,0,s);let i=new At(this.field,a);i=i.multiplyByMonomial(t,1);const l=i.divide(r)[1].getCoefficients(),u=t-l.length;for(let m=0;m<u;m++)e[s+m]=0;U.arraycopy(l,0,e,s+u,l.length)}}class Ke{constructor(){}static applyMaskPenaltyRule1(e){return Ke.applyMaskPenaltyRule1Internal(e,!0)+Ke.applyMaskPenaltyRule1Internal(e,!1)}static applyMaskPenaltyRule2(e){let t=0;const s=e.getArray(),r=e.getWidth(),a=e.getHeight();for(let i=0;i<a-1;i++){const o=s[i];for(let l=0;l<r-1;l++){const u=o[l];u===o[l+1]&&u===s[i+1][l]&&u===s[i+1][l+1]&&t++}}return Ke.N2*t}static applyMaskPenaltyRule3(e){let t=0;const s=e.getArray(),r=e.getWidth(),a=e.getHeight();for(let i=0;i<a;i++)for(let o=0;o<r;o++){const l=s[i];o+6<r&&l[o]===1&&l[o+1]===0&&l[o+2]===1&&l[o+3]===1&&l[o+4]===1&&l[o+5]===0&&l[o+6]===1&&(Ke.isWhiteHorizontal(l,o-4,o)||Ke.isWhiteHorizontal(l,o+7,o+11))&&t++,i+6<a&&s[i][o]===1&&s[i+1][o]===0&&s[i+2][o]===1&&s[i+3][o]===1&&s[i+4][o]===1&&s[i+5][o]===0&&s[i+6][o]===1&&(Ke.isWhiteVertical(s,o,i-4,i)||Ke.isWhiteVertical(s,o,i+7,i+11))&&t++}return t*Ke.N3}static isWhiteHorizontal(e,t,s){t=Math.max(t,0),s=Math.min(s,e.length);for(let r=t;r<s;r++)if(e[r]===1)return!1;return!0}static isWhiteVertical(e,t,s,r){s=Math.max(s,0),r=Math.min(r,e.length);for(let a=s;a<r;a++)if(e[a][t]===1)return!1;return!0}static applyMaskPenaltyRule4(e){let t=0;const s=e.getArray(),r=e.getWidth(),a=e.getHeight();for(let l=0;l<a;l++){const u=s[l];for(let m=0;m<r;m++)u[m]===1&&t++}const i=e.getHeight()*e.getWidth();return Math.floor(Math.abs(t*2-i)*10/i)*Ke.N4}static getDataMaskBit(e,t,s){let r,a;switch(e){case 0:r=s+t&1;break;case 1:r=s&1;break;case 2:r=t%3;break;case 3:r=(s+t)%3;break;case 4:r=Math.floor(s/2)+Math.floor(t/3)&1;break;case 5:a=s*t,r=(a&1)+a%3;break;case 6:a=s*t,r=(a&1)+a%3&1;break;case 7:a=s*t,r=a%3+(s+t&1)&1;break;default:throw new S("Invalid mask pattern: "+e)}return r===0}static applyMaskPenaltyRule1Internal(e,t){let s=0;const r=t?e.getHeight():e.getWidth(),a=t?e.getWidth():e.getHeight(),i=e.getArray();for(let o=0;o<r;o++){let l=0,u=-1;for(let m=0;m<a;m++){const w=t?i[o][m]:i[m][o];w===u?l++:(l>=5&&(s+=Ke.N1+(l-5)),l=1,u=w)}l>=5&&(s+=Ke.N1+(l-5))}return s}}Ke.N1=3,Ke.N2=3,Ke.N3=40,Ke.N4=10;class un{constructor(e,t){this.width=e,this.height=t;const s=new Array(t);for(let r=0;r!==t;r++)s[r]=new Uint8Array(e);this.bytes=s}getHeight(){return this.height}getWidth(){return this.width}get(e,t){return this.bytes[t][e]}getArray(){return this.bytes}setNumber(e,t,s){this.bytes[t][e]=s}setBoolean(e,t,s){this.bytes[t][e]=s?1:0}clear(e){for(const t of this.bytes)X.fill(t,e)}equals(e){if(!(e instanceof un))return!1;const t=e;if(this.width!==t.width||this.height!==t.height)return!1;for(let s=0,r=this.height;s<r;++s){const a=this.bytes[s],i=t.bytes[s];for(let o=0,l=this.width;o<l;++o)if(a[o]!==i[o])return!1}return!0}toString(){const e=new ae;for(let t=0,s=this.height;t<s;++t){const r=this.bytes[t];for(let a=0,i=this.width;a<i;++a)switch(r[a]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ");break}e.append(`
`)}return e.toString()}}class Ns{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const e=new ae;return e.append(`<<
`),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append(`
 ecLevel: `),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append(`
 version: `),e.append(this.version?this.version.toString():"null"),e.append(`
 maskPattern: `),e.append(this.maskPattern.toString()),this.matrix?(e.append(`
 matrix:
`),e.append(this.matrix.toString())):e.append(`
 matrix: null
`),e.append(`>>
`),e.toString()}setMode(e){this.mode=e}setECLevel(e){this.ecLevel=e}setVersion(e){this.version=e}setMaskPattern(e){this.maskPattern=e}setMatrix(e){this.matrix=e}static isValidMaskPattern(e){return e>=0&&e<Ns.NUM_MASK_PATTERNS}}Ns.NUM_MASK_PATTERNS=8;class Fe extends p{}Fe.kind="WriterException";class me{constructor(){}static clearMatrix(e){e.clear(255)}static buildMatrix(e,t,s,r,a){me.clearMatrix(a),me.embedBasicPatterns(s,a),me.embedTypeInfo(t,r,a),me.maybeEmbedVersionInfo(s,a),me.embedDataBits(e,r,a)}static embedBasicPatterns(e,t){me.embedPositionDetectionPatternsAndSeparators(t),me.embedDarkDotAtLeftBottomCorner(t),me.maybeEmbedPositionAdjustmentPatterns(e,t),me.embedTimingPatterns(t)}static embedTypeInfo(e,t,s){const r=new Y;me.makeTypeInfoBits(e,t,r);for(let a=0,i=r.getSize();a<i;++a){const o=r.get(r.getSize()-1-a),l=me.TYPE_INFO_COORDINATES[a],u=l[0],m=l[1];if(s.setBoolean(u,m,o),a<8){const w=s.getWidth()-a-1;s.setBoolean(w,8,o)}else{const b=s.getHeight()-7+(a-8);s.setBoolean(8,b,o)}}}static maybeEmbedVersionInfo(e,t){if(e.getVersionNumber()<7)return;const s=new Y;me.makeVersionInfoBits(e,s);let r=6*3-1;for(let a=0;a<6;++a)for(let i=0;i<3;++i){const o=s.get(r);r--,t.setBoolean(a,t.getHeight()-11+i,o),t.setBoolean(t.getHeight()-11+i,a,o)}}static embedDataBits(e,t,s){let r=0,a=-1,i=s.getWidth()-1,o=s.getHeight()-1;for(;i>0;){for(i===6&&(i-=1);o>=0&&o<s.getHeight();){for(let l=0;l<2;++l){const u=i-l;if(!me.isEmpty(s.get(u,o)))continue;let m;r<e.getSize()?(m=e.get(r),++r):m=!1,t!==255&&Ke.getDataMaskBit(t,u,o)&&(m=!m),s.setBoolean(u,o,m)}o+=a}a=-a,o+=a,i-=2}if(r!==e.getSize())throw new Fe("Not all bits consumed: "+r+"/"+e.getSize())}static findMSBSet(e){return 32-W.numberOfLeadingZeros(e)}static calculateBCHCode(e,t){if(t===0)throw new S("0 polynomial");const s=me.findMSBSet(t);for(e<<=s-1;me.findMSBSet(e)>=s;)e^=t<<me.findMSBSet(e)-s;return e}static makeTypeInfoBits(e,t,s){if(!Ns.isValidMaskPattern(t))throw new Fe("Invalid mask pattern");const r=e.getBits()<<3|t;s.appendBits(r,5);const a=me.calculateBCHCode(r,me.TYPE_INFO_POLY);s.appendBits(a,10);const i=new Y;if(i.appendBits(me.TYPE_INFO_MASK_PATTERN,15),s.xor(i),s.getSize()!==15)throw new Fe("should not happen but we got: "+s.getSize())}static makeVersionInfoBits(e,t){t.appendBits(e.getVersionNumber(),6);const s=me.calculateBCHCode(e.getVersionNumber(),me.VERSION_INFO_POLY);if(t.appendBits(s,12),t.getSize()!==18)throw new Fe("should not happen but we got: "+t.getSize())}static isEmpty(e){return e===255}static embedTimingPatterns(e){for(let t=8;t<e.getWidth()-8;++t){const s=(t+1)%2;me.isEmpty(e.get(t,6))&&e.setNumber(t,6,s),me.isEmpty(e.get(6,t))&&e.setNumber(6,t,s)}}static embedDarkDotAtLeftBottomCorner(e){if(e.get(8,e.getHeight()-8)===0)throw new Fe;e.setNumber(8,e.getHeight()-8,1)}static embedHorizontalSeparationPattern(e,t,s){for(let r=0;r<8;++r){if(!me.isEmpty(s.get(e+r,t)))throw new Fe;s.setNumber(e+r,t,0)}}static embedVerticalSeparationPattern(e,t,s){for(let r=0;r<7;++r){if(!me.isEmpty(s.get(e,t+r)))throw new Fe;s.setNumber(e,t+r,0)}}static embedPositionAdjustmentPattern(e,t,s){for(let r=0;r<5;++r){const a=me.POSITION_ADJUSTMENT_PATTERN[r];for(let i=0;i<5;++i)s.setNumber(e+i,t+r,a[i])}}static embedPositionDetectionPattern(e,t,s){for(let r=0;r<7;++r){const a=me.POSITION_DETECTION_PATTERN[r];for(let i=0;i<7;++i)s.setNumber(e+i,t+r,a[i])}}static embedPositionDetectionPatternsAndSeparators(e){const t=me.POSITION_DETECTION_PATTERN[0].length;me.embedPositionDetectionPattern(0,0,e),me.embedPositionDetectionPattern(e.getWidth()-t,0,e),me.embedPositionDetectionPattern(0,e.getWidth()-t,e);const s=8;me.embedHorizontalSeparationPattern(0,s-1,e),me.embedHorizontalSeparationPattern(e.getWidth()-s,s-1,e),me.embedHorizontalSeparationPattern(0,e.getWidth()-s,e);const r=7;me.embedVerticalSeparationPattern(r,0,e),me.embedVerticalSeparationPattern(e.getHeight()-r-1,0,e),me.embedVerticalSeparationPattern(r,e.getHeight()-r,e)}static maybeEmbedPositionAdjustmentPatterns(e,t){if(e.getVersionNumber()<2)return;const s=e.getVersionNumber()-1,r=me.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[s];for(let a=0,i=r.length;a!==i;a++){const o=r[a];if(o>=0)for(let l=0;l!==i;l++){const u=r[l];u>=0&&me.isEmpty(t.get(u,o))&&me.embedPositionAdjustmentPattern(u-2,o-2,t)}}}}me.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),me.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),me.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),me.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),me.VERSION_INFO_POLY=7973,me.TYPE_INFO_POLY=1335,me.TYPE_INFO_MASK_PATTERN=21522;class ii{constructor(e,t){this.dataBytes=e,this.errorCorrectionBytes=t}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Ve{constructor(){}static calculateMaskPenalty(e){return Ke.applyMaskPenaltyRule1(e)+Ke.applyMaskPenaltyRule2(e)+Ke.applyMaskPenaltyRule3(e)+Ke.applyMaskPenaltyRule4(e)}static encode(e,t,s=null){let r=Ve.DEFAULT_BYTE_MODE_ENCODING;const a=s!==null&&s.get(at.CHARACTER_SET)!==void 0;a&&(r=s.get(at.CHARACTER_SET).toString());const i=this.chooseMode(e,r),o=new Y;if(i===fe.BYTE&&(a||Ve.DEFAULT_BYTE_MODE_ENCODING!==r)){const te=P.getCharacterSetECIByName(r);te!==void 0&&this.appendECI(te,o)}this.appendModeInfo(i,o);const l=new Y;this.appendBytes(e,i,l,r);let u;if(s!==null&&s.get(at.QR_VERSION)!==void 0){const te=Number.parseInt(s.get(at.QR_VERSION).toString(),10);u=he.getVersionForNumber(te);const $=this.calculateBitsNeeded(i,o,l,u);if(!this.willFit($,u,t))throw new Fe("Data too big for requested version")}else u=this.recommendVersion(t,i,o,l);const m=new Y;m.appendBitArray(o);const w=i===fe.BYTE?l.getSizeInBytes():e.length;this.appendLengthInfo(w,u,i,m),m.appendBitArray(l);const b=u.getECBlocksForLevel(t),E=u.getTotalCodewords()-b.getTotalECCodewords();this.terminateBits(E,m);const _=this.interleaveWithECBytes(m,u.getTotalCodewords(),E,b.getNumBlocks()),O=new Ns;O.setECLevel(t),O.setMode(i),O.setVersion(u);const k=u.getDimensionForVersion(),G=new un(k,k),ee=this.chooseMaskPattern(_,t,u,G);return O.setMaskPattern(ee),me.buildMatrix(_,t,u,ee,G),O.setMatrix(G),O}static recommendVersion(e,t,s,r){const a=this.calculateBitsNeeded(t,s,r,he.getVersionForNumber(1)),i=this.chooseVersion(a,e),o=this.calculateBitsNeeded(t,s,r,i);return this.chooseVersion(o,e)}static calculateBitsNeeded(e,t,s,r){return t.getSize()+e.getCharacterCountBits(r)+s.getSize()}static getAlphanumericCode(e){return e<Ve.ALPHANUMERIC_TABLE.length?Ve.ALPHANUMERIC_TABLE[e]:-1}static chooseMode(e,t=null){if(P.SJIS.getName()===t&&this.isOnlyDoubleByteKanji(e))return fe.KANJI;let s=!1,r=!1;for(let a=0,i=e.length;a<i;++a){const o=e.charAt(a);if(Ve.isDigit(o))s=!0;else if(this.getAlphanumericCode(o.charCodeAt(0))!==-1)r=!0;else return fe.BYTE}return r?fe.ALPHANUMERIC:s?fe.NUMERIC:fe.BYTE}static isOnlyDoubleByteKanji(e){let t;try{t=q.encode(e,P.SJIS)}catch{return!1}const s=t.length;if(s%2!==0)return!1;for(let r=0;r<s;r+=2){const a=t[r]&255;if((a<129||a>159)&&(a<224||a>235))return!1}return!0}static chooseMaskPattern(e,t,s,r){let a=Number.MAX_SAFE_INTEGER,i=-1;for(let o=0;o<Ns.NUM_MASK_PATTERNS;o++){me.buildMatrix(e,t,s,o,r);let l=this.calculateMaskPenalty(r);l<a&&(a=l,i=o)}return i}static chooseVersion(e,t){for(let s=1;s<=40;s++){const r=he.getVersionForNumber(s);if(Ve.willFit(e,r,t))return r}throw new Fe("Data too big")}static willFit(e,t,s){const r=t.getTotalCodewords(),i=t.getECBlocksForLevel(s).getTotalECCodewords(),o=r-i,l=(e+7)/8;return o>=l}static terminateBits(e,t){const s=e*8;if(t.getSize()>s)throw new Fe("data bits cannot fit in the QR Code"+t.getSize()+" > "+s);for(let i=0;i<4&&t.getSize()<s;++i)t.appendBit(!1);const r=t.getSize()&7;if(r>0)for(let i=r;i<8;i++)t.appendBit(!1);const a=e-t.getSizeInBytes();for(let i=0;i<a;++i)t.appendBits(i&1?17:236,8);if(t.getSize()!==s)throw new Fe("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(e,t,s,r,a,i){if(r>=s)throw new Fe("Block ID too large");const o=e%s,l=s-o,u=Math.floor(e/s),m=u+1,w=Math.floor(t/s),b=w+1,E=u-w,_=m-b;if(E!==_)throw new Fe("EC bytes mismatch");if(s!==l+o)throw new Fe("RS blocks mismatch");if(e!==(w+E)*l+(b+_)*o)throw new Fe("Total bytes mismatch");r<l?(a[0]=w,i[0]=E):(a[0]=b,i[0]=_)}static interleaveWithECBytes(e,t,s,r){if(e.getSizeInBytes()!==s)throw new Fe("Number of bits and data bytes does not match");let a=0,i=0,o=0;const l=new Array;for(let m=0;m<r;++m){const w=new Int32Array(1),b=new Int32Array(1);Ve.getNumDataBytesAndNumECBytesForBlockID(t,s,r,m,w,b);const E=w[0],_=new Uint8Array(E);e.toBytes(8*a,_,0,E);const O=Ve.generateECBytes(_,b[0]);l.push(new ii(_,O)),i=Math.max(i,E),o=Math.max(o,O.length),a+=w[0]}if(s!==a)throw new Fe("Data bytes does not match offset");const u=new Y;for(let m=0;m<i;++m)for(const w of l){const b=w.getDataBytes();m<b.length&&u.appendBits(b[m],8)}for(let m=0;m<o;++m)for(const w of l){const b=w.getErrorCorrectionBytes();m<b.length&&u.appendBits(b[m],8)}if(t!==u.getSizeInBytes())throw new Fe("Interleaving error: "+t+" and "+u.getSizeInBytes()+" differ.");return u}static generateECBytes(e,t){const s=e.length,r=new Int32Array(s+t);for(let i=0;i<s;i++)r[i]=e[i]&255;new Wn(_e.QR_CODE_FIELD_256).encode(r,t);const a=new Uint8Array(t);for(let i=0;i<t;i++)a[i]=r[s+i];return a}static appendModeInfo(e,t){t.appendBits(e.getBits(),4)}static appendLengthInfo(e,t,s,r){const a=s.getCharacterCountBits(t);if(e>=1<<a)throw new Fe(e+" is bigger than "+((1<<a)-1));r.appendBits(e,a)}static appendBytes(e,t,s,r){switch(t){case fe.NUMERIC:Ve.appendNumericBytes(e,s);break;case fe.ALPHANUMERIC:Ve.appendAlphanumericBytes(e,s);break;case fe.BYTE:Ve.append8BitBytes(e,s,r);break;case fe.KANJI:Ve.appendKanjiBytes(e,s);break;default:throw new Fe("Invalid mode: "+t)}}static getDigit(e){return e.charCodeAt(0)-48}static isDigit(e){const t=Ve.getDigit(e);return t>=0&&t<=9}static appendNumericBytes(e,t){const s=e.length;let r=0;for(;r<s;){const a=Ve.getDigit(e.charAt(r));if(r+2<s){const i=Ve.getDigit(e.charAt(r+1)),o=Ve.getDigit(e.charAt(r+2));t.appendBits(a*100+i*10+o,10),r+=3}else if(r+1<s){const i=Ve.getDigit(e.charAt(r+1));t.appendBits(a*10+i,7),r+=2}else t.appendBits(a,4),r++}}static appendAlphanumericBytes(e,t){const s=e.length;let r=0;for(;r<s;){const a=Ve.getAlphanumericCode(e.charCodeAt(r));if(a===-1)throw new Fe;if(r+1<s){const i=Ve.getAlphanumericCode(e.charCodeAt(r+1));if(i===-1)throw new Fe;t.appendBits(a*45+i,11),r+=2}else t.appendBits(a,6),r++}}static append8BitBytes(e,t,s){let r;try{r=q.encode(e,s)}catch(a){throw new Fe(a)}for(let a=0,i=r.length;a!==i;a++){const o=r[a];t.appendBits(o,8)}}static appendKanjiBytes(e,t){let s;try{s=q.encode(e,P.SJIS)}catch(a){throw new Fe(a)}const r=s.length;for(let a=0;a<r;a+=2){const i=s[a]&255,o=s[a+1]&255,l=i<<8&4294967295|o;let u=-1;if(l>=33088&&l<=40956?u=l-33088:l>=57408&&l<=60351&&(u=l-49472),u===-1)throw new Fe("Invalid byte sequence");const m=(u>>8)*192+(u&255);t.appendBits(m,13)}}static appendECI(e,t){t.appendBits(fe.ECI.getBits(),4),t.appendBits(e.getValue(),8)}}Ve.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Ve.DEFAULT_BYTE_MODE_ENCODING=P.UTF8.getName();class Cs{write(e,t,s,r=null){if(e.length===0)throw new S("Found empty contents");if(t<0||s<0)throw new S("Requested dimensions are too small: "+t+"x"+s);let a=ze.L,i=Cs.QUIET_ZONE_SIZE;r!==null&&(r.get(at.ERROR_CORRECTION)!==void 0&&(a=ze.fromString(r.get(at.ERROR_CORRECTION).toString())),r.get(at.MARGIN)!==void 0&&(i=Number.parseInt(r.get(at.MARGIN).toString(),10)));const o=Ve.encode(e,a,r);return this.renderResult(o,t,s,i)}writeToDom(e,t,s,r,a=null){typeof e=="string"&&(e=document.querySelector(e));const i=this.write(t,s,r,a);e&&e.appendChild(i)}renderResult(e,t,s,r){const a=e.getMatrix();if(a===null)throw new Wt;const i=a.getWidth(),o=a.getHeight(),l=i+r*2,u=o+r*2,m=Math.max(t,l),w=Math.max(s,u),b=Math.min(Math.floor(m/l),Math.floor(w/u)),E=Math.floor((m-i*b)/2),_=Math.floor((w-o*b)/2),O=this.createSVGElement(m,w);for(let k=0,G=_;k<o;k++,G+=b)for(let ee=0,te=E;ee<i;ee++,te+=b)if(a.get(ee,k)===1){const $=this.createSvgRectElement(te,G,b,b);O.appendChild($)}return O}createSVGElement(e,t){const s=document.createElementNS(Cs.SVG_NS,"svg");return s.setAttributeNS(null,"height",e.toString()),s.setAttributeNS(null,"width",t.toString()),s}createSvgRectElement(e,t,s,r){const a=document.createElementNS(Cs.SVG_NS,"rect");return a.setAttributeNS(null,"x",e.toString()),a.setAttributeNS(null,"y",t.toString()),a.setAttributeNS(null,"height",s.toString()),a.setAttributeNS(null,"width",r.toString()),a.setAttributeNS(null,"fill","#000000"),a}}Cs.QUIET_ZONE_SIZE=4,Cs.SVG_NS="http://www.w3.org/2000/svg";class Ds{encode(e,t,s,r,a){if(e.length===0)throw new S("Found empty contents");if(t!==xe.QR_CODE)throw new S("Can only encode QR_CODE, but got "+t);if(s<0||r<0)throw new S(`Requested dimensions are too small: ${s}x${r}`);let i=ze.L,o=Ds.QUIET_ZONE_SIZE;a!==null&&(a.get(at.ERROR_CORRECTION)!==void 0&&(i=ze.fromString(a.get(at.ERROR_CORRECTION).toString())),a.get(at.MARGIN)!==void 0&&(o=Number.parseInt(a.get(at.MARGIN).toString(),10)));const l=Ve.encode(e,i,a);return Ds.renderResult(l,s,r,o)}static renderResult(e,t,s,r){const a=e.getMatrix();if(a===null)throw new Wt;const i=a.getWidth(),o=a.getHeight(),l=i+r*2,u=o+r*2,m=Math.max(t,l),w=Math.max(s,u),b=Math.min(Math.floor(m/l),Math.floor(w/u)),E=Math.floor((m-i*b)/2),_=Math.floor((w-o*b)/2),O=new Ce(m,w);for(let k=0,G=_;k<o;k++,G+=b)for(let ee=0,te=E;ee<i;ee++,te+=b)a.get(ee,k)===1&&O.setRegion(te,G,b,b);return O}}Ds.QUIET_ZONE_SIZE=4;class oi{encode(e,t,s,r,a){let i;switch(t){case xe.QR_CODE:i=new Ds;break;default:throw new S("No encoder available for format "+t)}return i.encode(e,t,s,r,a)}}class Zt extends de{constructor(e,t,s,r,a,i,o,l){if(super(i,o),this.yuvData=e,this.dataWidth=t,this.dataHeight=s,this.left=r,this.top=a,r+i>t||a+o>s)throw new S("Crop rectangle does not fit within image data.");l&&this.reverseHorizontal(i,o)}getRow(e,t){if(e<0||e>=this.getHeight())throw new S("Requested row is outside the image: "+e);const s=this.getWidth();(t==null||t.length<s)&&(t=new Uint8ClampedArray(s));const r=(e+this.top)*this.dataWidth+this.left;return U.arraycopy(this.yuvData,r,t,0,s),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.yuvData;const s=e*t,r=new Uint8ClampedArray(s);let a=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return U.arraycopy(this.yuvData,a,r,0,s),r;for(let i=0;i<t;i++){const o=i*e;U.arraycopy(this.yuvData,a,r,o,e),a+=this.dataWidth}return r}isCropSupported(){return!0}crop(e,t,s,r){return new Zt(this.yuvData,this.dataWidth,this.dataHeight,this.left+e,this.top+t,s,r,!1)}renderThumbnail(){const e=this.getWidth()/Zt.THUMBNAIL_SCALE_FACTOR,t=this.getHeight()/Zt.THUMBNAIL_SCALE_FACTOR,s=new Int32Array(e*t),r=this.yuvData;let a=this.top*this.dataWidth+this.left;for(let i=0;i<t;i++){const o=i*e;for(let l=0;l<e;l++){const u=r[a+l*Zt.THUMBNAIL_SCALE_FACTOR]&255;s[o+l]=4278190080|u*65793}a+=this.dataWidth*Zt.THUMBNAIL_SCALE_FACTOR}return s}getThumbnailWidth(){return this.getWidth()/Zt.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Zt.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(e,t){const s=this.yuvData;for(let r=0,a=this.top*this.dataWidth+this.left;r<t;r++,a+=this.dataWidth){const i=a+e/2;for(let o=a,l=a+e-1;o<i;o++,l--){const u=s[o];s[o]=s[l],s[l]=u}}}invert(){return new je(this)}}Zt.THUMBNAIL_SCALE_FACTOR=2;class Yn extends de{constructor(e,t,s,r,a,i,o){if(super(t,s),this.dataWidth=r,this.dataHeight=a,this.left=i,this.top=o,e.BYTES_PER_ELEMENT===4){const l=t*s,u=new Uint8ClampedArray(l);for(let m=0;m<l;m++){const w=e[m],b=w>>16&255,E=w>>7&510,_=w&255;u[m]=(b+E+_)/4&255}this.luminances=u}else this.luminances=e;if(r===void 0&&(this.dataWidth=t),a===void 0&&(this.dataHeight=s),i===void 0&&(this.left=0),o===void 0&&(this.top=0),this.left+t>this.dataWidth||this.top+s>this.dataHeight)throw new S("Crop rectangle does not fit within image data.")}getRow(e,t){if(e<0||e>=this.getHeight())throw new S("Requested row is outside the image: "+e);const s=this.getWidth();(t==null||t.length<s)&&(t=new Uint8ClampedArray(s));const r=(e+this.top)*this.dataWidth+this.left;return U.arraycopy(this.luminances,r,t,0,s),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.luminances;const s=e*t,r=new Uint8ClampedArray(s);let a=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return U.arraycopy(this.luminances,a,r,0,s),r;for(let i=0;i<t;i++){const o=i*e;U.arraycopy(this.luminances,a,r,o,e),a+=this.dataWidth}return r}isCropSupported(){return!0}crop(e,t,s,r){return new Yn(this.luminances,s,r,this.dataWidth,this.dataHeight,this.left+e,this.top+t)}invert(){return new je(this)}}class Tr extends P{static forName(e){return this.getCharacterSetECIByName(e)}}class Xn{}Xn.ISO_8859_1=P.ISO8859_1;class _r{isCompact(){return this.compact}setCompact(e){this.compact=e}getSize(){return this.size}setSize(e){this.size=e}getLayers(){return this.layers}setLayers(e){this.layers=e}getCodeWords(){return this.codeWords}setCodeWords(e){this.codeWords=e}getMatrix(){return this.matrix}setMatrix(e){this.matrix=e}}class Mr{static singletonList(e){return[e]}static min(e,t){return e.sort(t)[0]}}class li{constructor(e){this.previous=e}getPrevious(){return this.previous}}class Os extends li{constructor(e,t,s){super(e),this.value=t,this.bitCount=s}appendTo(e,t){e.appendBits(this.value,this.bitCount)}add(e,t){return new Os(this,e,t)}addBinaryShift(e,t){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Os(this,e,t)}toString(){let e=this.value&(1<<this.bitCount)-1;return e|=1<<this.bitCount,"<"+W.toBinaryString(e|1<<this.bitCount).substring(1)+">"}}class qn extends Os{constructor(e,t,s){super(e,0,0),this.binaryShiftStart=t,this.binaryShiftByteCount=s}appendTo(e,t){for(let s=0;s<this.binaryShiftByteCount;s++)(s===0||s===31&&this.binaryShiftByteCount<=62)&&(e.appendBits(31,5),this.binaryShiftByteCount>62?e.appendBits(this.binaryShiftByteCount-31,16):s===0?e.appendBits(Math.min(this.binaryShiftByteCount,31),5):e.appendBits(this.binaryShiftByteCount-31,5)),e.appendBits(t[this.binaryShiftStart+s],8)}addBinaryShift(e,t){return new qn(this,e,t)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function ci(y,e,t){return new qn(y,e,t)}function Qs(y,e,t){return new Os(y,e,t)}const di=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],us=0,fn=1,Pt=2,Dr=3,Qt=4,hi=new Os(null,0,0),Zn=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function ui(y){for(let e of y)X.fill(e,-1);return y[us][Qt]=0,y[fn][Qt]=0,y[fn][us]=28,y[Dr][Qt]=0,y[Pt][Qt]=0,y[Pt][us]=15,y}const Or=ui(X.createInt32Array(6,6));class Kt{constructor(e,t,s,r){this.token=e,this.mode=t,this.binaryShiftByteCount=s,this.bitCount=r}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(e,t){let s=this.bitCount,r=this.token;if(e!==this.mode){let i=Zn[this.mode][e];r=Qs(r,i&65535,i>>16),s+=i>>16}let a=e===Pt?4:5;return r=Qs(r,t,a),new Kt(r,e,0,s+a)}shiftAndAppend(e,t){let s=this.token,r=this.mode===Pt?4:5;return s=Qs(s,Or[this.mode][e],r),s=Qs(s,t,5),new Kt(s,this.mode,0,this.bitCount+r+5)}addBinaryShiftChar(e){let t=this.token,s=this.mode,r=this.bitCount;if(this.mode===Qt||this.mode===Pt){let o=Zn[s][us];t=Qs(t,o&65535,o>>16),r+=o>>16,s=us}let a=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,i=new Kt(t,s,this.binaryShiftByteCount+1,r+a);return i.binaryShiftByteCount===2078&&(i=i.endBinaryShift(e+1)),i}endBinaryShift(e){if(this.binaryShiftByteCount===0)return this;let t=this.token;return t=ci(t,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new Kt(t,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(e){let t=this.bitCount+(Zn[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?t+=Kt.calculateBinaryShiftCost(e)-Kt.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(t+=10),t<=e.bitCount}toBitArray(e){let t=[];for(let r=this.endBinaryShift(e.length).token;r!==null;r=r.getPrevious())t.unshift(r);let s=new Y;for(const r of t)r.appendTo(s,e);return s}toString(){return J.format("%s bits=%d bytes=%d",di[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0}}Kt.INITIAL_STATE=new Kt(hi,us,0,0);function fi(y){const e=J.getCharCode(" "),t=J.getCharCode("."),s=J.getCharCode(",");y[us][e]=1;const r=J.getCharCode("Z"),a=J.getCharCode("A");for(let b=a;b<=r;b++)y[us][b]=b-a+2;y[fn][e]=1;const i=J.getCharCode("z"),o=J.getCharCode("a");for(let b=o;b<=i;b++)y[fn][b]=b-o+2;y[Pt][e]=1;const l=J.getCharCode("9"),u=J.getCharCode("0");for(let b=u;b<=l;b++)y[Pt][b]=b-u+2;y[Pt][s]=12,y[Pt][t]=13;const m=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let b=0;b<m.length;b++)y[Dr][J.getCharCode(m[b])]=b;const w=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let b=0;b<w.length;b++)J.getCharCode(w[b])>0&&(y[Qt][J.getCharCode(w[b])]=b);return y}const Qn=fi(X.createInt32Array(5,256));class Ks{constructor(e){this.text=e}encode(){const e=J.getCharCode(" "),t=J.getCharCode(`
`);let s=Mr.singletonList(Kt.INITIAL_STATE);for(let a=0;a<this.text.length;a++){let i,o=a+1<this.text.length?this.text[a+1]:0;switch(this.text[a]){case J.getCharCode("\r"):i=o===t?2:0;break;case J.getCharCode("."):i=o===e?3:0;break;case J.getCharCode(","):i=o===e?4:0;break;case J.getCharCode(":"):i=o===e?5:0;break;default:i=0}i>0?(s=Ks.updateStateListForPair(s,a,i),a++):s=this.updateStateListForChar(s,a)}return Mr.min(s,(a,i)=>a.getBitCount()-i.getBitCount()).toBitArray(this.text)}updateStateListForChar(e,t){const s=[];for(let r of e)this.updateStateForChar(r,t,s);return Ks.simplifyStates(s)}updateStateForChar(e,t,s){let r=this.text[t]&255,a=Qn[e.getMode()][r]>0,i=null;for(let o=0;o<=Qt;o++){let l=Qn[o][r];if(l>0){if(i==null&&(i=e.endBinaryShift(t)),!a||o===e.getMode()||o===Pt){const u=i.latchAndAppend(o,l);s.push(u)}if(!a&&Or[e.getMode()][o]>=0){const u=i.shiftAndAppend(o,l);s.push(u)}}}if(e.getBinaryShiftByteCount()>0||Qn[e.getMode()][r]===0){let o=e.addBinaryShiftChar(t);s.push(o)}}static updateStateListForPair(e,t,s){const r=[];for(let a of e)this.updateStateForPair(a,t,s,r);return this.simplifyStates(r)}static updateStateForPair(e,t,s,r){let a=e.endBinaryShift(t);if(r.push(a.latchAndAppend(Qt,s)),e.getMode()!==Qt&&r.push(a.shiftAndAppend(Qt,s)),s===3||s===4){let i=a.latchAndAppend(Pt,16-s).latchAndAppend(Pt,1);r.push(i)}if(e.getBinaryShiftByteCount()>0){let i=e.addBinaryShiftChar(t).addBinaryShiftChar(t+1);r.push(i)}}static simplifyStates(e){let t=[];for(const s of e){let r=!0;for(const a of t){if(a.isBetterThanOrEqualTo(s)){r=!1;break}s.isBetterThanOrEqualTo(a)&&(t=t.filter(i=>i!==a))}r&&t.push(s)}return t}}class Te{constructor(){}static encodeBytes(e){return Te.encode(e,Te.DEFAULT_EC_PERCENT,Te.DEFAULT_AZTEC_LAYERS)}static encode(e,t,s){let r=new Ks(e).encode(),a=W.truncDivision(r.getSize()*t,100)+11,i=r.getSize()+a,o,l,u,m,w;if(s!==Te.DEFAULT_AZTEC_LAYERS){if(o=s<0,l=Math.abs(s),l>(o?Te.MAX_NB_BITS_COMPACT:Te.MAX_NB_BITS))throw new S(J.format("Illegal value %s for layers",s));u=Te.totalBitsInLayer(l,o),m=Te.WORD_SIZE[l];let $=u-u%m;if(w=Te.stuffBits(r,m),w.getSize()+a>$)throw new S("Data to large for user specified layer");if(o&&w.getSize()>m*64)throw new S("Data to large for user specified layer")}else{m=0,w=null;for(let $=0;;$++){if($>Te.MAX_NB_BITS)throw new S("Data too large for an Aztec code");if(o=$<=3,l=o?$+1:$,u=Te.totalBitsInLayer(l,o),i>u)continue;(w==null||m!==Te.WORD_SIZE[l])&&(m=Te.WORD_SIZE[l],w=Te.stuffBits(r,m));let ve=u-u%m;if(!(o&&w.getSize()>m*64)&&w.getSize()+a<=ve)break}}let b=Te.generateCheckWords(w,u,m),E=w.getSize()/m,_=Te.generateModeMessage(o,l,E),O=(o?11:14)+l*4,k=new Int32Array(O),G;if(o){G=O;for(let $=0;$<k.length;$++)k[$]=$}else{G=O+1+2*W.truncDivision(W.truncDivision(O,2)-1,15);let $=W.truncDivision(O,2),ve=W.truncDivision(G,2);for(let be=0;be<$;be++){let jt=be+W.truncDivision(be,15);k[$-be-1]=ve-jt-1,k[$+be]=ve+jt+1}}let ee=new Ce(G);for(let $=0,ve=0;$<l;$++){let be=(l-$)*4+(o?9:12);for(let jt=0;jt<be;jt++){let zt=jt*2;for(let It=0;It<2;It++)b.get(ve+zt+It)&&ee.set(k[$*2+It],k[$*2+jt]),b.get(ve+be*2+zt+It)&&ee.set(k[$*2+jt],k[O-1-$*2-It]),b.get(ve+be*4+zt+It)&&ee.set(k[O-1-$*2-It],k[O-1-$*2-jt]),b.get(ve+be*6+zt+It)&&ee.set(k[O-1-$*2-jt],k[$*2+It])}ve+=be*8}if(Te.drawModeMessage(ee,o,G,_),o)Te.drawBullsEye(ee,W.truncDivision(G,2),5);else{Te.drawBullsEye(ee,W.truncDivision(G,2),7);for(let $=0,ve=0;$<W.truncDivision(O,2)-1;$+=15,ve+=16)for(let be=W.truncDivision(G,2)&1;be<G;be+=2)ee.set(W.truncDivision(G,2)-ve,be),ee.set(W.truncDivision(G,2)+ve,be),ee.set(be,W.truncDivision(G,2)-ve),ee.set(be,W.truncDivision(G,2)+ve)}let te=new _r;return te.setCompact(o),te.setSize(G),te.setLayers(l),te.setCodeWords(E),te.setMatrix(ee),te}static drawBullsEye(e,t,s){for(let r=0;r<s;r+=2)for(let a=t-r;a<=t+r;a++)e.set(a,t-r),e.set(a,t+r),e.set(t-r,a),e.set(t+r,a);e.set(t-s,t-s),e.set(t-s+1,t-s),e.set(t-s,t-s+1),e.set(t+s,t-s),e.set(t+s,t-s+1),e.set(t+s,t+s-1)}static generateModeMessage(e,t,s){let r=new Y;return e?(r.appendBits(t-1,2),r.appendBits(s-1,6),r=Te.generateCheckWords(r,28,4)):(r.appendBits(t-1,5),r.appendBits(s-1,11),r=Te.generateCheckWords(r,40,4)),r}static drawModeMessage(e,t,s,r){let a=W.truncDivision(s,2);if(t)for(let i=0;i<7;i++){let o=a-3+i;r.get(i)&&e.set(o,a-5),r.get(i+7)&&e.set(a+5,o),r.get(20-i)&&e.set(o,a+5),r.get(27-i)&&e.set(a-5,o)}else for(let i=0;i<10;i++){let o=a-5+i+W.truncDivision(i,5);r.get(i)&&e.set(o,a-7),r.get(i+10)&&e.set(a+7,o),r.get(29-i)&&e.set(o,a+7),r.get(39-i)&&e.set(a-7,o)}}static generateCheckWords(e,t,s){let r=e.getSize()/s,a=new Wn(Te.getGF(s)),i=W.truncDivision(t,s),o=Te.bitsToWords(e,s,i);a.encode(o,i-r);let l=t%s,u=new Y;u.appendBits(0,l);for(const m of Array.from(o))u.appendBits(m,s);return u}static bitsToWords(e,t,s){let r=new Int32Array(s),a,i;for(a=0,i=e.getSize()/t;a<i;a++){let o=0;for(let l=0;l<t;l++)o|=e.get(a*t+l)?1<<t-l-1:0;r[a]=o}return r}static getGF(e){switch(e){case 4:return _e.AZTEC_PARAM;case 6:return _e.AZTEC_DATA_6;case 8:return _e.AZTEC_DATA_8;case 10:return _e.AZTEC_DATA_10;case 12:return _e.AZTEC_DATA_12;default:throw new S("Unsupported word size "+e)}}static stuffBits(e,t){let s=new Y,r=e.getSize(),a=(1<<t)-2;for(let i=0;i<r;i+=t){let o=0;for(let l=0;l<t;l++)(i+l>=r||e.get(i+l))&&(o|=1<<t-1-l);(o&a)===a?(s.appendBits(o&a,t),i--):o&a?s.appendBits(o,t):(s.appendBits(o|1,t),i--)}return s}static totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}Te.DEFAULT_EC_PERCENT=33,Te.DEFAULT_AZTEC_LAYERS=0,Te.MAX_NB_BITS=32,Te.MAX_NB_BITS_COMPACT=4,Te.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class xn{encode(e,t,s,r){return this.encodeWithHints(e,t,s,r,null)}encodeWithHints(e,t,s,r,a){let i=Xn.ISO_8859_1,o=Te.DEFAULT_EC_PERCENT,l=Te.DEFAULT_AZTEC_LAYERS;return a!=null&&(a.has(at.CHARACTER_SET)&&(i=Tr.forName(a.get(at.CHARACTER_SET).toString())),a.has(at.ERROR_CORRECTION)&&(o=W.parseInt(a.get(at.ERROR_CORRECTION).toString())),a.has(at.AZTEC_LAYERS)&&(l=W.parseInt(a.get(at.AZTEC_LAYERS).toString()))),xn.encodeLayers(e,t,s,r,i,o,l)}static encodeLayers(e,t,s,r,a,i,o){if(t!==xe.AZTEC)throw new S("Can only encode AZTEC, but got "+t);let l=Te.encode(J.getBytes(e,a),i,o);return xn.renderResult(l,s,r)}static renderResult(e,t,s){let r=e.getMatrix();if(r==null)throw new Wt;let a=r.getWidth(),i=r.getHeight(),o=Math.max(t,a),l=Math.max(s,i),u=Math.min(o/a,l/i),m=(o-a*u)/2,w=(l-i*u)/2,b=new Ce(o,l);for(let E=0,_=w;E<i;E++,_+=u)for(let O=0,k=m;O<a;O++,k+=u)r.get(O,E)&&b.setRegion(k,_,u,u);return b}}d.AbstractExpandedDecoder=kn,d.ArgumentException=A,d.ArithmeticException=tn,d.AztecCode=_r,d.AztecCodeReader=rn,d.AztecCodeWriter=xn,d.AztecDecoder=He,d.AztecDetector=gr,d.AztecDetectorResult=xr,d.AztecEncoder=Te,d.AztecHighLevelEncoder=Ks,d.AztecPoint=wt,d.BarcodeFormat=xe,d.Binarizer=B,d.BinaryBitmap=F,d.BitArray=Y,d.BitMatrix=Ce,d.BitSource=Fn,d.BrowserAztecCodeReader=Fa,d.BrowserBarcodeReader=Ga,d.BrowserCodeReader=mt,d.BrowserDatamatrixCodeReader=Ya,d.BrowserMultiFormatReader=ni,d.BrowserPDF417Reader=ri,d.BrowserQRCodeReader=ai,d.BrowserQRCodeSvgWriter=Cs,d.CharacterSetECI=P,d.ChecksumException=Q,d.Code128Reader=ne,d.Code39Reader=nt,d.DataMatrixDecodedBitStreamParser=ls,d.DataMatrixReader=cs,d.DecodeHintType=v,d.DecoderResult=Us,d.DefaultGridSampler=mr,d.DetectorResult=nn,d.EAN13Reader=ps,d.EncodeHintType=at,d.Exception=p,d.FormatException=T,d.GenericGF=_e,d.GenericGFPoly=At,d.GlobalHistogramBinarizer=re,d.GridSampler=Mn,d.GridSamplerInstance=is,d.HTMLCanvasElementLuminanceSource=et,d.HybridBinarizer=ue,d.ITFReader=Pe,d.IllegalArgumentException=S,d.IllegalStateException=Wt,d.InvertedLuminanceSource=je,d.LuminanceSource=de,d.MathUtils=Ie,d.MultiFormatOneDReader=_s,d.MultiFormatReader=Ir,d.MultiFormatWriter=oi,d.NotFoundException=H,d.OneDReader=st,d.PDF417DecodedBitStreamParser=V,d.PDF417DecoderErrorCorrection=Cr,d.PDF417Reader=ft,d.PDF417ResultMetadata=Er,d.PerspectiveTransform=Ut,d.PlanarYUVLuminanceSource=Zt,d.QRCodeByteMatrix=un,d.QRCodeDataMask=Lt,d.QRCodeDecodedBitStreamParser=Xe,d.QRCodeDecoderErrorCorrectionLevel=ze,d.QRCodeDecoderFormatInformation=pt,d.QRCodeEncoder=Ve,d.QRCodeEncoderQRCode=Ns,d.QRCodeMaskUtil=Ke,d.QRCodeMatrixUtil=me,d.QRCodeMode=fe,d.QRCodeReader=ds,d.QRCodeVersion=he,d.QRCodeWriter=Ds,d.RGBLuminanceSource=Yn,d.RSS14Reader=Qe,d.RSSExpandedReader=K,d.ReaderException=hn,d.ReedSolomonDecoder=zs,d.ReedSolomonEncoder=Wn,d.ReedSolomonException=Ss,d.Result=dt,d.ResultMetadataType=ot,d.ResultPoint=ce,d.StringUtils=J,d.UnsupportedOperationException=Z,d.VideoInputDevice=yt,d.WhiteRectangleDetector=ts,d.WriterException=Fe,d.ZXingArrays=X,d.ZXingCharset=Tr,d.ZXingInteger=W,d.ZXingStandardCharsets=Xn,d.ZXingStringBuilder=ae,d.ZXingStringEncoding=q,d.ZXingSystem=U,d.createAbstractExpandedDecoder=br,Object.defineProperty(d,"__esModule",{value:!0})})})(sr,sr.exports);var Ge=sr.exports;const Oo=wi(Ge),Ro=Li({__proto__:null,default:Oo},[Ge]);var qr=function(){function c(h,d,x){if(this.formatMap=new Map([[oe.QR_CODE,Ge.BarcodeFormat.QR_CODE],[oe.AZTEC,Ge.BarcodeFormat.AZTEC],[oe.CODABAR,Ge.BarcodeFormat.CODABAR],[oe.CODE_39,Ge.BarcodeFormat.CODE_39],[oe.CODE_93,Ge.BarcodeFormat.CODE_93],[oe.CODE_128,Ge.BarcodeFormat.CODE_128],[oe.DATA_MATRIX,Ge.BarcodeFormat.DATA_MATRIX],[oe.MAXICODE,Ge.BarcodeFormat.MAXICODE],[oe.ITF,Ge.BarcodeFormat.ITF],[oe.EAN_13,Ge.BarcodeFormat.EAN_13],[oe.EAN_8,Ge.BarcodeFormat.EAN_8],[oe.PDF_417,Ge.BarcodeFormat.PDF_417],[oe.RSS_14,Ge.BarcodeFormat.RSS_14],[oe.RSS_EXPANDED,Ge.BarcodeFormat.RSS_EXPANDED],[oe.UPC_A,Ge.BarcodeFormat.UPC_A],[oe.UPC_E,Ge.BarcodeFormat.UPC_E],[oe.UPC_EAN_EXTENSION,Ge.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!Ro)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=d,this.logger=x;var g=this.createZXingFormats(h),f=new Map;f.set(Ge.DecodeHintType.POSSIBLE_FORMATS,g),f.set(Ge.DecodeHintType.TRY_HARDER,!1),this.hints=f}return c.prototype.decodeAsync=function(h){var d=this;return new Promise(function(x,g){try{x(d.decode(h))}catch(f){g(f)}})},c.prototype.decode=function(h){var d=new Ge.MultiFormatReader(this.verbose,this.hints),x=new Ge.HTMLCanvasElementLuminanceSource(h),g=new Ge.BinaryBitmap(new Ge.HybridBinarizer(x)),f=d.decode(g);return{text:f.text,format:Da.create(this.toHtml5QrcodeSupportedFormats(f.format)),debugData:this.createDebugData()}},c.prototype.createReverseFormatMap=function(){var h=new Map;return this.formatMap.forEach(function(d,x,g){h.set(d,x)}),h},c.prototype.toHtml5QrcodeSupportedFormats=function(h){if(!this.reverseFormatMap.has(h))throw"reverseFormatMap doesn't have ".concat(h);return this.reverseFormatMap.get(h)},c.prototype.createZXingFormats=function(h){for(var d=[],x=0,g=h;x<g.length;x++){var f=g[x];this.formatMap.has(f)?d.push(this.formatMap.get(f)):this.logger.logError("".concat(f," is not supported by")+"ZXingHtml5QrcodeShim")}return d},c.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},c}(),ko=function(c,h,d,x){function g(f){return f instanceof d?f:new d(function(N){N(f)})}return new(d||(d=Promise))(function(f,N){function M(A){try{p(x.next(A))}catch(S){N(S)}}function j(A){try{p(x.throw(A))}catch(S){N(S)}}function p(A){A.done?f(A.value):g(A.value).then(M,j)}p((x=x.apply(c,h||[])).next())})},Lo=function(c,h){var d={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},x,g,f,N;return N={next:M(0),throw:M(1),return:M(2)},typeof Symbol=="function"&&(N[Symbol.iterator]=function(){return this}),N;function M(p){return function(A){return j([p,A])}}function j(p){if(x)throw new TypeError("Generator is already executing.");for(;N&&(N=0,p[0]&&(d=0)),d;)try{if(x=1,g&&(f=p[0]&2?g.return:p[0]?g.throw||((f=g.return)&&f.call(g),0):g.next)&&!(f=f.call(g,p[1])).done)return f;switch(g=0,f&&(p=[p[0]&2,f.value]),p[0]){case 0:case 1:f=p;break;case 4:return d.label++,{value:p[1],done:!1};case 5:d.label++,g=p[1],p=[0];continue;case 7:p=d.ops.pop(),d.trys.pop();continue;default:if(f=d.trys,!(f=f.length>0&&f[f.length-1])&&(p[0]===6||p[0]===2)){d=0;continue}if(p[0]===3&&(!f||p[1]>f[0]&&p[1]<f[3])){d.label=p[1];break}if(p[0]===6&&d.label<f[1]){d.label=f[1],f=p;break}if(f&&d.label<f[2]){d.label=f[2],d.ops.push(p);break}f[2]&&d.ops.pop(),d.trys.pop();continue}p=h.call(c,d)}catch(A){p=[6,A],g=0}finally{x=f=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},Zr=function(){function c(h,d,x){if(this.formatMap=new Map([[oe.QR_CODE,"qr_code"],[oe.AZTEC,"aztec"],[oe.CODABAR,"codabar"],[oe.CODE_39,"code_39"],[oe.CODE_93,"code_93"],[oe.CODE_128,"code_128"],[oe.DATA_MATRIX,"data_matrix"],[oe.ITF,"itf"],[oe.EAN_13,"ean_13"],[oe.EAN_8,"ean_8"],[oe.PDF_417,"pdf417"],[oe.UPC_A,"upc_a"],[oe.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!c.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=d,this.logger=x;var g=this.createBarcodeDetectorFormats(h);if(this.detector=new BarcodeDetector(g),!this.detector)throw"BarcodeDetector detector not supported"}return c.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var h=new BarcodeDetector({formats:["qr_code"]});return typeof h<"u"},c.prototype.decodeAsync=function(h){return ko(this,void 0,void 0,function(){var d,x;return Lo(this,function(g){switch(g.label){case 0:return[4,this.detector.detect(h)];case 1:if(d=g.sent(),!d||d.length===0)throw"No barcode or QR code detected.";return x=this.selectLargestBarcode(d),[2,{text:x.rawValue,format:Da.create(this.toHtml5QrcodeSupportedFormats(x.format)),debugData:this.createDebugData()}]}})})},c.prototype.selectLargestBarcode=function(h){for(var d=null,x=0,g=0,f=h;g<f.length;g++){var N=f[g],M=N.boundingBox.width*N.boundingBox.height;M>x&&(x=M,d=N)}if(!d)throw"No largest barcode found";return d},c.prototype.createBarcodeDetectorFormats=function(h){for(var d=[],x=0,g=h;x<g.length;x++){var f=g[x];this.formatMap.has(f)?d.push(this.formatMap.get(f)):this.logger.warn("".concat(f," is not supported by")+"BarcodeDetectorDelegate")}return{formats:d}},c.prototype.toHtml5QrcodeSupportedFormats=function(h){if(!this.reverseFormatMap.has(h))throw"reverseFormatMap doesn't have ".concat(h);return this.reverseFormatMap.get(h)},c.prototype.createReverseFormatMap=function(){var h=new Map;return this.formatMap.forEach(function(d,x,g){h.set(d,x)}),h},c.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},c}(),Qr=function(c,h,d,x){function g(f){return f instanceof d?f:new d(function(N){N(f)})}return new(d||(d=Promise))(function(f,N){function M(A){try{p(x.next(A))}catch(S){N(S)}}function j(A){try{p(x.throw(A))}catch(S){N(S)}}function p(A){A.done?f(A.value):g(A.value).then(M,j)}p((x=x.apply(c,h||[])).next())})},Kr=function(c,h){var d={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},x,g,f,N;return N={next:M(0),throw:M(1),return:M(2)},typeof Symbol=="function"&&(N[Symbol.iterator]=function(){return this}),N;function M(p){return function(A){return j([p,A])}}function j(p){if(x)throw new TypeError("Generator is already executing.");for(;N&&(N=0,p[0]&&(d=0)),d;)try{if(x=1,g&&(f=p[0]&2?g.return:p[0]?g.throw||((f=g.return)&&f.call(g),0):g.next)&&!(f=f.call(g,p[1])).done)return f;switch(g=0,f&&(p=[p[0]&2,f.value]),p[0]){case 0:case 1:f=p;break;case 4:return d.label++,{value:p[1],done:!1};case 5:d.label++,g=p[1],p=[0];continue;case 7:p=d.ops.pop(),d.trys.pop();continue;default:if(f=d.trys,!(f=f.length>0&&f[f.length-1])&&(p[0]===6||p[0]===2)){d=0;continue}if(p[0]===3&&(!f||p[1]>f[0]&&p[1]<f[3])){d.label=p[1];break}if(p[0]===6&&d.label<f[1]){d.label=f[1],f=p;break}if(f&&d.label<f[2]){d.label=f[2],d.ops.push(p);break}f[2]&&d.ops.pop(),d.trys.pop();continue}p=h.call(c,d)}catch(A){p=[6,A],g=0}finally{x=f=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},Bo=function(){function c(h,d,x,g){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=x,d&&Zr.isSupported()?(this.primaryDecoder=new Zr(h,x,g),this.secondaryDecoder=new qr(h,x,g)):this.primaryDecoder=new qr(h,x,g)}return c.prototype.decodeAsync=function(h){return Qr(this,void 0,void 0,function(){var d;return Kr(this,function(x){switch(x.label){case 0:d=performance.now(),x.label=1;case 1:return x.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(h)];case 2:return[2,x.sent()];case 3:return this.possiblyLogPerformance(d),[7];case 4:return[2]}})})},c.prototype.decodeRobustlyAsync=function(h){return Qr(this,void 0,void 0,function(){var d,x;return Kr(this,function(g){switch(g.label){case 0:d=performance.now(),g.label=1;case 1:return g.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(h)];case 2:return[2,g.sent()];case 3:if(x=g.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(h)];throw x;case 4:return this.possiblyLogPerformance(d),[7];case 5:return[2]}})})},c.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},c.prototype.possiblyLogPerformance=function(h){if(this.verbose){var d=performance.now()-h;this.executionResults.push(d),this.executions++,this.possiblyFlushPerformanceReport()}},c.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var h=0,d=0,x=this.executionResults;d<x.length;d++){var g=x[d];h+=g}var f=h/this.executionResults.length;console.log("".concat(f," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},c}(),ur=function(){var c=function(h,d){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,g){x.__proto__=g}||function(x,g){for(var f in g)Object.prototype.hasOwnProperty.call(g,f)&&(x[f]=g[f])},c(h,d)};return function(h,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");c(h,d);function x(){this.constructor=h}h.prototype=d===null?Object.create(d):(x.prototype=d.prototype,new x)}}(),bn=function(c,h,d,x){function g(f){return f instanceof d?f:new d(function(N){N(f)})}return new(d||(d=Promise))(function(f,N){function M(A){try{p(x.next(A))}catch(S){N(S)}}function j(A){try{p(x.throw(A))}catch(S){N(S)}}function p(A){A.done?f(A.value):g(A.value).then(M,j)}p((x=x.apply(c,h||[])).next())})},Nn=function(c,h){var d={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},x,g,f,N;return N={next:M(0),throw:M(1),return:M(2)},typeof Symbol=="function"&&(N[Symbol.iterator]=function(){return this}),N;function M(p){return function(A){return j([p,A])}}function j(p){if(x)throw new TypeError("Generator is already executing.");for(;N&&(N=0,p[0]&&(d=0)),d;)try{if(x=1,g&&(f=p[0]&2?g.return:p[0]?g.throw||((f=g.return)&&f.call(g),0):g.next)&&!(f=f.call(g,p[1])).done)return f;switch(g=0,f&&(p=[p[0]&2,f.value]),p[0]){case 0:case 1:f=p;break;case 4:return d.label++,{value:p[1],done:!1};case 5:d.label++,g=p[1],p=[0];continue;case 7:p=d.ops.pop(),d.trys.pop();continue;default:if(f=d.trys,!(f=f.length>0&&f[f.length-1])&&(p[0]===6||p[0]===2)){d=0;continue}if(p[0]===3&&(!f||p[1]>f[0]&&p[1]<f[3])){d.label=p[1];break}if(p[0]===6&&d.label<f[1]){d.label=f[1],f=p;break}if(f&&d.label<f[2]){d.label=f[2],d.ops.push(p);break}f[2]&&d.ops.pop(),d.trys.pop();continue}p=h.call(c,d)}catch(A){p=[6,A],g=0}finally{x=f=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},La=function(){function c(h,d){this.name=h,this.track=d}return c.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},c.prototype.apply=function(h){var d={};d[this.name]=h;var x={advanced:[d]};return this.track.applyConstraints(x)},c.prototype.value=function(){var h=this.track.getSettings();if(this.name in h){var d=h[this.name];return d}return null},c}(),Po=function(c){ur(h,c);function h(d,x){return c.call(this,d,x)||this}return h.prototype.min=function(){return this.getCapabilities().min},h.prototype.max=function(){return this.getCapabilities().max},h.prototype.step=function(){return this.getCapabilities().step},h.prototype.apply=function(d){var x={};x[this.name]=d;var g={advanced:[x]};return this.track.applyConstraints(g)},h.prototype.getCapabilities=function(){this.failIfNotSupported();var d=this.track.getCapabilities(),x=d[this.name];return{min:x.min,max:x.max,step:x.step}},h.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},h}(La),Fo=function(c){ur(h,c);function h(d){return c.call(this,"zoom",d)||this}return h}(Po),Uo=function(c){ur(h,c);function h(d){return c.call(this,"torch",d)||this}return h}(La),Ho=function(){function c(h){this.track=h}return c.prototype.zoomFeature=function(){return new Fo(this.track)},c.prototype.torchFeature=function(){return new Uo(this.track)},c}(),zo=function(){function c(h,d,x){this.isClosed=!1,this.parentElement=h,this.mediaStream=d,this.callbacks=x,this.surface=this.createVideoElement(this.parentElement.clientWidth),h.append(this.surface)}return c.prototype.createVideoElement=function(h){var d=document.createElement("video");return d.style.width="".concat(h,"px"),d.style.display="block",d.muted=!0,d.setAttribute("muted","true"),d.playsInline=!0,d},c.prototype.setupSurface=function(){var h=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var d=function(){var x=h.surface.clientWidth,g=h.surface.clientHeight;h.callbacks.onRenderSurfaceReady(x,g),h.surface.removeEventListener("playing",d)};this.surface.addEventListener("playing",d),this.surface.srcObject=this.mediaStream,this.surface.play()},c.create=function(h,d,x,g){return bn(this,void 0,void 0,function(){var f,N;return Nn(this,function(M){switch(M.label){case 0:return f=new c(h,d,g),x.aspectRatio?(N={aspectRatio:x.aspectRatio},[4,f.getFirstTrackOrFail().applyConstraints(N)]):[3,2];case 1:M.sent(),M.label=2;case 2:return f.setupSurface(),[2,f]}})})},c.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},c.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},c.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},c.prototype.resume=function(h){this.failIfClosed();var d=this,x=function(){setTimeout(h,200),d.surface.removeEventListener("playing",x)};this.surface.addEventListener("playing",x),this.surface.play()},c.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},c.prototype.getSurface=function(){return this.failIfClosed(),this.surface},c.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},c.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},c.prototype.applyVideoConstraints=function(h){return bn(this,void 0,void 0,function(){return Nn(this,function(d){if("aspectRatio"in h)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(h)]})})},c.prototype.close=function(){if(this.isClosed)return Promise.resolve();var h=this;return new Promise(function(d,x){var g=h.mediaStream.getVideoTracks(),f=g.length,N=0;h.mediaStream.getVideoTracks().forEach(function(M){h.mediaStream.removeTrack(M),M.stop(),++N,N>=f&&(h.isClosed=!0,h.parentElement.removeChild(h.surface),d())})})},c.prototype.getCapabilities=function(){return new Ho(this.getFirstTrackOrFail())},c}(),Vo=function(){function c(h){this.mediaStream=h}return c.prototype.render=function(h,d,x){return bn(this,void 0,void 0,function(){return Nn(this,function(g){return[2,zo.create(h,this.mediaStream,d,x)]})})},c.create=function(h){return bn(this,void 0,void 0,function(){var d,x;return Nn(this,function(g){switch(g.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return d={audio:!1,video:h},[4,navigator.mediaDevices.getUserMedia(d)];case 1:return x=g.sent(),[2,new c(x)]}})})},c}(),Jr=function(c,h,d,x){function g(f){return f instanceof d?f:new d(function(N){N(f)})}return new(d||(d=Promise))(function(f,N){function M(A){try{p(x.next(A))}catch(S){N(S)}}function j(A){try{p(x.throw(A))}catch(S){N(S)}}function p(A){A.done?f(A.value):g(A.value).then(M,j)}p((x=x.apply(c,h||[])).next())})},$r=function(c,h){var d={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},x,g,f,N;return N={next:M(0),throw:M(1),return:M(2)},typeof Symbol=="function"&&(N[Symbol.iterator]=function(){return this}),N;function M(p){return function(A){return j([p,A])}}function j(p){if(x)throw new TypeError("Generator is already executing.");for(;N&&(N=0,p[0]&&(d=0)),d;)try{if(x=1,g&&(f=p[0]&2?g.return:p[0]?g.throw||((f=g.return)&&f.call(g),0):g.next)&&!(f=f.call(g,p[1])).done)return f;switch(g=0,f&&(p=[p[0]&2,f.value]),p[0]){case 0:case 1:f=p;break;case 4:return d.label++,{value:p[1],done:!1};case 5:d.label++,g=p[1],p=[0];continue;case 7:p=d.ops.pop(),d.trys.pop();continue;default:if(f=d.trys,!(f=f.length>0&&f[f.length-1])&&(p[0]===6||p[0]===2)){d=0;continue}if(p[0]===3&&(!f||p[1]>f[0]&&p[1]<f[3])){d.label=p[1];break}if(p[0]===6&&d.label<f[1]){d.label=f[1],f=p;break}if(f&&d.label<f[2]){d.label=f[2],d.ops.push(p);break}f[2]&&d.ops.pop(),d.trys.pop();continue}p=h.call(c,d)}catch(A){p=[6,A],g=0}finally{x=f=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},Go=function(){function c(){}return c.failIfNotSupported=function(){return Jr(this,void 0,void 0,function(){return $r(this,function(h){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new c]})})},c.prototype.create=function(h){return Jr(this,void 0,void 0,function(){return $r(this,function(d){return[2,Vo.create(h)]})})},c}(),Wo=function(c,h,d,x){function g(f){return f instanceof d?f:new d(function(N){N(f)})}return new(d||(d=Promise))(function(f,N){function M(A){try{p(x.next(A))}catch(S){N(S)}}function j(A){try{p(x.throw(A))}catch(S){N(S)}}function p(A){A.done?f(A.value):g(A.value).then(M,j)}p((x=x.apply(c,h||[])).next())})},Yo=function(c,h){var d={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},x,g,f,N;return N={next:M(0),throw:M(1),return:M(2)},typeof Symbol=="function"&&(N[Symbol.iterator]=function(){return this}),N;function M(p){return function(A){return j([p,A])}}function j(p){if(x)throw new TypeError("Generator is already executing.");for(;N&&(N=0,p[0]&&(d=0)),d;)try{if(x=1,g&&(f=p[0]&2?g.return:p[0]?g.throw||((f=g.return)&&f.call(g),0):g.next)&&!(f=f.call(g,p[1])).done)return f;switch(g=0,f&&(p=[p[0]&2,f.value]),p[0]){case 0:case 1:f=p;break;case 4:return d.label++,{value:p[1],done:!1};case 5:d.label++,g=p[1],p=[0];continue;case 7:p=d.ops.pop(),d.trys.pop();continue;default:if(f=d.trys,!(f=f.length>0&&f[f.length-1])&&(p[0]===6||p[0]===2)){d=0;continue}if(p[0]===3&&(!f||p[1]>f[0]&&p[1]<f[3])){d.label=p[1];break}if(p[0]===6&&d.label<f[1]){d.label=f[1],f=p;break}if(f&&d.label<f[2]){d.label=f[2],d.ops.push(p);break}f[2]&&d.ops.pop(),d.trys.pop();continue}p=h.call(c,d)}catch(A){p=[6,A],g=0}finally{x=f=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},Xo=function(){function c(){}return c.retrieve=function(){if(navigator.mediaDevices)return c.getCamerasFromMediaDevices();var h=MediaStreamTrack;return MediaStreamTrack&&h.getSources?c.getCamerasFromMediaStreamTrack():c.rejectWithError()},c.rejectWithError=function(){var h=Bs.unableToQuerySupportedDevices();return c.isHttpsOrLocalhost()||(h=Bs.insecureContextCameraQueryError()),Promise.reject(h)},c.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var h=location.host.split(":")[0];return h==="127.0.0.1"||h==="localhost"},c.getCamerasFromMediaDevices=function(){return Wo(this,void 0,void 0,function(){var h,d,x,g,f,N,M;return Yo(this,function(j){switch(j.label){case 0:return h=function(p){for(var A=p.getVideoTracks(),S=0,F=A;S<F.length;S++){var Q=F[S];Q.enabled=!1,Q.stop(),p.removeTrack(Q)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return d=j.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(x=j.sent(),g=[],f=0,N=x;f<N.length;f++)M=N[f],M.kind==="videoinput"&&g.push({id:M.deviceId,label:M.label});return h(d),[2,g]}})})},c.getCamerasFromMediaStreamTrack=function(){return new Promise(function(h,d){var x=function(f){for(var N=[],M=0,j=f;M<j.length;M++){var p=j[M];p.kind==="video"&&N.push({id:p.id,label:p.label})}h(N)},g=MediaStreamTrack;g.getSources(x)})},c}(),Je;(function(c){c[c.UNKNOWN=0]="UNKNOWN",c[c.NOT_STARTED=1]="NOT_STARTED",c[c.SCANNING=2]="SCANNING",c[c.PAUSED=3]="PAUSED"})(Je||(Je={}));var qo=function(){function c(){this.state=Je.NOT_STARTED,this.onGoingTransactionNewState=Je.UNKNOWN}return c.prototype.directTransition=function(h){this.failIfTransitionOngoing(),this.validateTransition(h),this.state=h},c.prototype.startTransition=function(h){return this.failIfTransitionOngoing(),this.validateTransition(h),this.onGoingTransactionNewState=h,this},c.prototype.execute=function(){if(this.onGoingTransactionNewState===Je.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var h=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Je.UNKNOWN,this.directTransition(h)},c.prototype.cancel=function(){if(this.onGoingTransactionNewState===Je.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Je.UNKNOWN},c.prototype.getState=function(){return this.state},c.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Je.UNKNOWN)throw"Cannot transition to a new state, already under transition"},c.prototype.validateTransition=function(h){switch(this.state){case Je.UNKNOWN:throw"Transition from unknown is not allowed";case Je.NOT_STARTED:this.failIfNewStateIs(h,[Je.PAUSED]);break;case Je.SCANNING:break;case Je.PAUSED:break}},c.prototype.failIfNewStateIs=function(h,d){for(var x=0,g=d;x<g.length;x++){var f=g[x];if(h===f)throw"Cannot transition from ".concat(this.state," to ").concat(h)}},c}(),Zo=function(){function c(h){this.stateManager=h}return c.prototype.startTransition=function(h){return this.stateManager.startTransition(h)},c.prototype.directTransition=function(h){this.stateManager.directTransition(h)},c.prototype.getState=function(){return this.stateManager.getState()},c.prototype.canScanFile=function(){return this.stateManager.getState()===Je.NOT_STARTED},c.prototype.isScanning=function(){return this.stateManager.getState()!==Je.NOT_STARTED},c.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Je.SCANNING},c.prototype.isPaused=function(){return this.stateManager.getState()===Je.PAUSED},c}(),Qo=function(){function c(){}return c.create=function(){return new Zo(new qo)},c}(),Ko=function(){var c=function(h,d){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,g){x.__proto__=g}||function(x,g){for(var f in g)Object.prototype.hasOwnProperty.call(g,f)&&(x[f]=g[f])},c(h,d)};return function(h,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");c(h,d);function x(){this.constructor=h}h.prototype=d===null?Object.create(d):(x.prototype=d.prototype,new x)}}(),_t=function(c){Ko(h,c);function h(){return c!==null&&c.apply(this,arguments)||this}return h.DEFAULT_WIDTH=300,h.DEFAULT_WIDTH_OFFSET=2,h.FILE_SCAN_MIN_HEIGHT=300,h.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,h.MIN_QR_BOX_SIZE=50,h.SHADED_LEFT=1,h.SHADED_RIGHT=2,h.SHADED_TOP=3,h.SHADED_BOTTOM=4,h.SHADED_REGION_ELEMENT_ID="qr-shaded-region",h.VERBOSE=!1,h.BORDER_SHADER_DEFAULT_COLOR="#ffffff",h.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",h}(Vt),Jo=function(){function c(h,d){this.logger=d,this.fps=_t.SCAN_DEFAULT_FPS,h?(h.fps&&(this.fps=h.fps),this.disableFlip=h.disableFlip===!0,this.qrbox=h.qrbox,this.aspectRatio=h.aspectRatio,this.videoConstraints=h.videoConstraints):this.disableFlip=_t.DEFAULT_DISABLE_FLIP}return c.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?ka.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},c.prototype.isShadedBoxEnabled=function(){return!Jt(this.qrbox)},c.create=function(h,d){return new c(h,d)},c}(),ea=function(){function c(h,d){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(h))throw"HTML Element with id=".concat(h," not found");this.elementId=h,this.verbose=!1;var x;typeof d=="boolean"?this.verbose=d===!0:d&&(x=d,this.verbose=x.verbose===!0,x.experimentalFeatures),this.logger=new Ra(this.verbose),this.qrcode=new Bo(this.getSupportedFormats(d),this.getUseBarCodeDetectorIfSupported(x),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=Qo.create()}return c.prototype.start=function(h,d,x,g){var f=this;if(!h)throw"cameraIdOrConfig is required";if(!x||typeof x!="function")throw"qrCodeSuccessCallback is required and should be a function.";var N;g?N=g:N=this.verbose?this.logger.log:function(){};var M=Jo.create(d,this.logger);this.clearElement();var j=!1;M.videoConstraints&&(M.isMediaStreamConstraintsValid()?j=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var p=j,A=document.getElementById(this.elementId);A.clientWidth?A.clientWidth:_t.DEFAULT_WIDTH,A.style.position="relative",this.shouldScan=!0,this.element=A;var S=this,F=this.stateManagerProxy.startTransition(Je.SCANNING);return new Promise(function(Q,B){var U=p?M.videoConstraints:S.createVideoConstraints(h);if(!U){F.cancel(),B("videoConstraints should be defined");return}var z={};(!p||M.aspectRatio)&&(z.aspectRatio=M.aspectRatio);var se={onRenderSurfaceReady:function(X,W){S.setupUi(X,W,M),S.isScanning=!0,S.foreverScan(M,x,N)}};Go.failIfNotSupported().then(function(X){X.create(U).then(function(W){return W.render(f.element,z,se).then(function(Y){S.renderedCamera=Y,F.execute(),Q(null)}).catch(function(Y){F.cancel(),B(Y)})}).catch(function(W){F.cancel(),B(Bs.errorGettingUserMedia(W))})}).catch(function(X){F.cancel(),B(Bs.cameraStreamingNotSupported())})})},c.prototype.pause=function(h){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Je.PAUSED),this.showPausedState(),(Jt(h)||h!==!0)&&(h=!1),h&&this.renderedCamera&&this.renderedCamera.pause()},c.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var h=this,d=function(){h.stateManagerProxy.directTransition(Je.SCANNING),h.hidePausedState()};if(!this.renderedCamera.isPaused()){d();return}this.renderedCamera.resume(function(){d()})},c.prototype.getState=function(){return this.stateManagerProxy.getState()},c.prototype.stop=function(){var h=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var d=this.stateManagerProxy.startTransition(Je.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var x=function(){if(h.element){var f=document.getElementById(_t.SHADED_REGION_ELEMENT_ID);f&&h.element.removeChild(f)}},g=this;return this.renderedCamera.close().then(function(){return g.renderedCamera=null,g.element&&(g.element.removeChild(g.canvasElement),g.canvasElement=null),x(),g.qrRegion&&(g.qrRegion=null),g.context&&(g.context=null),d.execute(),g.hidePausedState(),g.isScanning=!1,Promise.resolve()})},c.prototype.scanFile=function(h,d){return this.scanFileV2(h,d).then(function(x){return x.decodedText})},c.prototype.scanFileV2=function(h,d){var x=this;if(!h||!(h instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Jt(d)&&(d=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(g,f){x.possiblyCloseLastScanImageFile(),x.clearElement(),x.lastScanImageFile=URL.createObjectURL(h);var N=new Image;N.onload=function(){var M=N.width,j=N.height,p=document.getElementById(x.elementId),A=p.clientWidth?p.clientWidth:_t.DEFAULT_WIDTH,S=Math.max(p.clientHeight?p.clientHeight:j,_t.FILE_SCAN_MIN_HEIGHT),F=x.computeCanvasDrawConfig(M,j,A,S);if(d){var Q=x.createCanvasElement(A,S,"qr-canvas-visible");Q.style.display="inline-block",p.appendChild(Q);var B=Q.getContext("2d");if(!B)throw"Unable to get 2d context from canvas";B.canvas.width=A,B.canvas.height=S,B.drawImage(N,0,0,M,j,F.x,F.y,F.width,F.height)}var U=_t.FILE_SCAN_HIDDEN_CANVAS_PADDING,z=Math.max(N.width,F.width),se=Math.max(N.height,F.height),X=z+2*U,W=se+2*U,Y=x.createCanvasElement(X,W);p.appendChild(Y);var D=Y.getContext("2d");if(!D)throw"Unable to get 2d context from canvas";D.canvas.width=X,D.canvas.height=W,D.drawImage(N,0,0,M,j,U,U,z,se);try{x.qrcode.decodeRobustlyAsync(Y).then(function(v){g(Yr.createFromQrcodeResult(v))}).catch(f)}catch(v){f("QR code parse error, error = ".concat(v))}},N.onerror=f,N.onabort=f,N.onstalled=f,N.onsuspend=f,N.src=URL.createObjectURL(h)})},c.prototype.clear=function(){this.clearElement()},c.getCameras=function(){return Xo.retrieve()},c.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},c.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},c.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},c.prototype.applyVideoConstraints=function(h){if(h){if(!ka.isMediaStreamConstraintsValid(h,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(h)},c.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},c.prototype.getSupportedFormats=function(h){var d=[oe.QR_CODE,oe.AZTEC,oe.CODABAR,oe.CODE_39,oe.CODE_93,oe.CODE_128,oe.DATA_MATRIX,oe.MAXICODE,oe.ITF,oe.EAN_13,oe.EAN_8,oe.PDF_417,oe.RSS_14,oe.RSS_EXPANDED,oe.UPC_A,oe.UPC_E,oe.UPC_EAN_EXTENSION];if(!h||typeof h=="boolean"||!h.formatsToSupport)return d;if(!Array.isArray(h.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(h.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var x=[],g=0,f=h.formatsToSupport;g<f.length;g++){var N=f[g];Mo(N)?x.push(N):this.logger.warn("Invalid format: ".concat(N," passed in config, ignoring."))}if(x.length===0)throw"None of formatsToSupport match supported values.";return x},c.prototype.getUseBarCodeDetectorIfSupported=function(h){if(Jt(h))return!0;if(!Jt(h.useBarCodeDetectorIfSupported))return h.useBarCodeDetectorIfSupported!==!1;if(Jt(h.experimentalFeatures))return!0;var d=h.experimentalFeatures;return Jt(d.useBarCodeDetectorIfSupported)?!0:d.useBarCodeDetectorIfSupported!==!1},c.prototype.validateQrboxSize=function(h,d,x){var g=this,f=x.qrbox;this.validateQrboxConfig(f);var N=this.toQrdimensions(h,d,f),M=function(p){if(p<_t.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(_t.MIN_QR_BOX_SIZE,"px.")},j=function(p){return p>h&&(g.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),p=h),p};M(N.width),M(N.height),N.width=j(N.width)},c.prototype.validateQrboxConfig=function(h){if(typeof h!="number"&&typeof h!="function"&&(h.width===void 0||h.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},c.prototype.toQrdimensions=function(h,d,x){if(typeof x=="number")return{width:x,height:x};if(typeof x=="function")try{return x(h,d)}catch(g){throw new Error("qrbox config was passed as a function but it failed with unknown error"+g)}return x},c.prototype.setupUi=function(h,d,x){x.isShadedBoxEnabled()&&this.validateQrboxSize(h,d,x);var g=Jt(x.qrbox)?{width:h,height:d}:x.qrbox;this.validateQrboxConfig(g);var f=this.toQrdimensions(h,d,g);f.height>d&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var N=x.isShadedBoxEnabled()&&f.height<=d,M={x:0,y:0,width:h,height:d},j=N?this.getShadedRegionBounds(h,d,f):M,p=this.createCanvasElement(j.width,j.height),A={willReadFrequently:!0},S=p.getContext("2d",A);S.canvas.width=j.width,S.canvas.height=j.height,this.element.append(p),N&&this.possiblyInsertShadingElement(this.element,h,d,f),this.createScannerPausedUiElement(this.element),this.qrRegion=j,this.context=S,this.canvasElement=p},c.prototype.createScannerPausedUiElement=function(h){var d=document.createElement("div");d.innerText=Bs.scannerPaused(),d.style.display="none",d.style.position="absolute",d.style.top="0px",d.style.zIndex="1",d.style.background="rgba(9, 9, 9, 0.46)",d.style.color="#FFECEC",d.style.textAlign="center",d.style.width="100%",h.appendChild(d),this.scannerPausedUiElement=d},c.prototype.scanContext=function(h,d){var x=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(g){return h(g.text,Yr.createFromQrcodeResult(g)),x.possiblyUpdateShaders(!0),!0}).catch(function(g){x.possiblyUpdateShaders(!1);var f=Bs.codeParseError(g);return d(f,Oa.createFrom(f)),!1})},c.prototype.foreverScan=function(h,d,x){var g=this;if(this.shouldScan&&this.renderedCamera){var f=this.renderedCamera.getSurface(),N=f.videoWidth/f.clientWidth,M=f.videoHeight/f.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var j=this.qrRegion.width*N,p=this.qrRegion.height*M,A=this.qrRegion.x*N,S=this.qrRegion.y*M;this.context.drawImage(f,A,S,j,p,0,0,this.qrRegion.width,this.qrRegion.height);var F=function(){g.foreverScanTimeout=setTimeout(function(){g.foreverScan(h,d,x)},g.getTimeoutFps(h.fps))};this.scanContext(d,x).then(function(Q){!Q&&h.disableFlip!==!0?(g.context.translate(g.context.canvas.width,0),g.context.scale(-1,1),g.scanContext(d,x).finally(function(){F()})):F()}).catch(function(Q){g.logger.logError("Error happend while scanning context",Q),F()})}},c.prototype.createVideoConstraints=function(h){if(typeof h=="string")return{deviceId:{exact:h}};if(typeof h=="object"){var d="facingMode",x="deviceId",g={user:!0,environment:!0},f="exact",N=function(B){if(B in g)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(B,"'")},M=Object.keys(h);if(M.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(M.length," keys");var j=Object.keys(h)[0];if(j!==d&&j!==x)throw"Only '".concat(d,"' and '").concat(x,"' ")+" are supported for 'cameraIdOrConfig'";if(j===d){var p=h.facingMode;if(typeof p=="string"){if(N(p))return{facingMode:p}}else if(typeof p=="object")if(f in p){if(N(p["".concat(f)]))return{facingMode:{exact:p["".concat(f)]}}}else throw"'facingMode' should be string or object with"+" ".concat(f," as key.");else{var A=typeof p;throw"Invalid type of 'facingMode' = ".concat(A)}}else{var S=h.deviceId;if(typeof S=="string")return{deviceId:S};if(typeof S=="object"){if(f in S)return{deviceId:{exact:S["".concat(f)]}};throw"'deviceId' should be string or object with"+" ".concat(f," as key.")}else{var F=typeof S;throw"Invalid type of 'deviceId' = ".concat(F)}}}var Q=typeof h;throw"Invalid type of 'cameraIdOrConfig' = ".concat(Q)},c.prototype.computeCanvasDrawConfig=function(h,d,x,g){if(h<=x&&d<=g){var f=(x-h)/2,N=(g-d)/2;return{x:f,y:N,width:h,height:d}}else{var M=h,j=d;return h>x&&(d=x/h*d,h=x),d>g&&(h=g/d*h,d=g),this.logger.log("Image downsampled from "+"".concat(M,"X").concat(j)+" to ".concat(h,"X").concat(d,".")),this.computeCanvasDrawConfig(h,d,x,g)}},c.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var h=document.getElementById(this.elementId);h&&(h.innerHTML="")},c.prototype.possiblyUpdateShaders=function(h){this.qrMatch!==h&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(d){d.style.backgroundColor=h?_t.BORDER_SHADER_MATCH_COLOR:_t.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=h)},c.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},c.prototype.createCanvasElement=function(h,d,x){var g=h,f=d,N=document.createElement("canvas");return N.style.width="".concat(g,"px"),N.style.height="".concat(f,"px"),N.style.display="none",N.id=Jt(x)?"qr-canvas":x,N},c.prototype.getShadedRegionBounds=function(h,d,x){if(x.width>h||x.height>d)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(h-x.width)/2,y:(d-x.height)/2,width:x.width,height:x.height}},c.prototype.possiblyInsertShadingElement=function(h,d,x,g){if(!(d-g.width<1||x-g.height<1)){var f=document.createElement("div");f.style.position="absolute";var N=(d-g.width)/2,M=(x-g.height)/2;if(f.style.borderLeft="".concat(N,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderRight="".concat(N,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderTop="".concat(M,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderBottom="".concat(M,"px solid rgba(0, 0, 0, 0.48)"),f.style.boxSizing="border-box",f.style.top="0px",f.style.bottom="0px",f.style.left="0px",f.style.right="0px",f.id="".concat(_t.SHADED_REGION_ELEMENT_ID),d-g.width<11||x-g.height<11)this.hasBorderShaders=!1;else{var j=5,p=40;this.insertShaderBorders(f,p,j,-j,null,0,!0),this.insertShaderBorders(f,p,j,-j,null,0,!1),this.insertShaderBorders(f,p,j,null,-j,0,!0),this.insertShaderBorders(f,p,j,null,-j,0,!1),this.insertShaderBorders(f,j,p+j,-j,null,-j,!0),this.insertShaderBorders(f,j,p+j,null,-j,-j,!0),this.insertShaderBorders(f,j,p+j,-j,null,-j,!1),this.insertShaderBorders(f,j,p+j,null,-j,-j,!1),this.hasBorderShaders=!0}h.append(f)}},c.prototype.insertShaderBorders=function(h,d,x,g,f,N,M){var j=document.createElement("div");j.style.position="absolute",j.style.backgroundColor=_t.BORDER_SHADER_DEFAULT_COLOR,j.style.width="".concat(d,"px"),j.style.height="".concat(x,"px"),g!==null&&(j.style.top="".concat(g,"px")),f!==null&&(j.style.bottom="".concat(f,"px")),M?j.style.left="".concat(N,"px"):j.style.right="".concat(N,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(j),h.appendChild(j)},c.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},c.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},c.prototype.getTimeoutFps=function(h){return 1e3/h},c}(),fr="data:image/svg+xml;base64,",$o=fr+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==",el=fr+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=",ta=fr+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+",tl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=",sa=function(){function c(){}return c.createDefault=function(){return{hasPermission:!1,lastUsedCameraId:null}},c}(),sl=function(){function c(){this.data=sa.createDefault();var h=localStorage.getItem(c.LOCAL_STORAGE_KEY);h?this.data=JSON.parse(h):this.reset()}return c.prototype.hasCameraPermissions=function(){return this.data.hasPermission},c.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId},c.prototype.setHasPermission=function(h){this.data.hasPermission=h,this.flush()},c.prototype.setLastUsedCameraId=function(h){this.data.lastUsedCameraId=h,this.flush()},c.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null,this.flush()},c.prototype.reset=function(){this.data=sa.createDefault(),this.flush()},c.prototype.flush=function(){localStorage.setItem(c.LOCAL_STORAGE_KEY,JSON.stringify(this.data))},c.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA",c}(),nl=function(){function c(){this.infoDiv=document.createElement("div")}return c.prototype.renderInto=function(h){this.infoDiv.style.position="absolute",this.infoDiv.style.top="10px",this.infoDiv.style.right="10px",this.infoDiv.style.zIndex="2",this.infoDiv.style.display="none",this.infoDiv.style.padding="5pt",this.infoDiv.style.border="1px solid #171717",this.infoDiv.style.fontSize="10pt",this.infoDiv.style.background="rgb(0 0 0 / 69%)",this.infoDiv.style.borderRadius="5px",this.infoDiv.style.textAlign="center",this.infoDiv.style.fontWeight="400",this.infoDiv.style.color="white",this.infoDiv.innerText=Xr.poweredBy();var d=document.createElement("a");d.innerText="ScanApp",d.href="https://scanapp.org",d.target="new",d.style.color="white",this.infoDiv.appendChild(d);var x=document.createElement("br"),g=document.createElement("br");this.infoDiv.appendChild(x),this.infoDiv.appendChild(g);var f=document.createElement("a");f.innerText=Xr.reportIssues(),f.href="https://github.com/mebjas/html5-qrcode/issues",f.target="new",f.style.color="white",this.infoDiv.appendChild(f),h.appendChild(this.infoDiv)},c.prototype.show=function(){this.infoDiv.style.display="block"},c.prototype.hide=function(){this.infoDiv.style.display="none"},c}(),rl=function(){function c(h,d){this.isShowingInfoIcon=!0,this.onTapIn=h,this.onTapOut=d,this.infoIcon=document.createElement("img")}return c.prototype.renderInto=function(h){var d=this;this.infoIcon.alt="Info icon",this.infoIcon.src=ta,this.infoIcon.style.position="absolute",this.infoIcon.style.top="4px",this.infoIcon.style.right="4px",this.infoIcon.style.opacity="0.6",this.infoIcon.style.cursor="pointer",this.infoIcon.style.zIndex="2",this.infoIcon.style.width="16px",this.infoIcon.style.height="16px",this.infoIcon.onmouseover=function(x){return d.onHoverIn()},this.infoIcon.onmouseout=function(x){return d.onHoverOut()},this.infoIcon.onclick=function(x){return d.onClick()},h.appendChild(this.infoIcon)},c.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")},c.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")},c.prototype.onClick=function(){this.isShowingInfoIcon?(this.isShowingInfoIcon=!1,this.onTapIn(),this.infoIcon.src=tl,this.infoIcon.style.opacity="1"):(this.isShowingInfoIcon=!0,this.onTapOut(),this.infoIcon.src=ta,this.infoIcon.style.opacity="0.6")},c}(),al=function(){function c(){var h=this;this.infoDiv=new nl,this.infoIcon=new rl(function(){h.infoDiv.show()},function(){h.infoDiv.hide()})}return c.prototype.renderInto=function(h){this.infoDiv.renderInto(h),this.infoIcon.renderInto(h)},c}(),il=function(c,h,d,x){function g(f){return f instanceof d?f:new d(function(N){N(f)})}return new(d||(d=Promise))(function(f,N){function M(A){try{p(x.next(A))}catch(S){N(S)}}function j(A){try{p(x.throw(A))}catch(S){N(S)}}function p(A){A.done?f(A.value):g(A.value).then(M,j)}p((x=x.apply(c,h||[])).next())})},ol=function(c,h){var d={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},x,g,f,N;return N={next:M(0),throw:M(1),return:M(2)},typeof Symbol=="function"&&(N[Symbol.iterator]=function(){return this}),N;function M(p){return function(A){return j([p,A])}}function j(p){if(x)throw new TypeError("Generator is already executing.");for(;N&&(N=0,p[0]&&(d=0)),d;)try{if(x=1,g&&(f=p[0]&2?g.return:p[0]?g.throw||((f=g.return)&&f.call(g),0):g.next)&&!(f=f.call(g,p[1])).done)return f;switch(g=0,f&&(p=[p[0]&2,f.value]),p[0]){case 0:case 1:f=p;break;case 4:return d.label++,{value:p[1],done:!1};case 5:d.label++,g=p[1],p=[0];continue;case 7:p=d.ops.pop(),d.trys.pop();continue;default:if(f=d.trys,!(f=f.length>0&&f[f.length-1])&&(p[0]===6||p[0]===2)){d=0;continue}if(p[0]===3&&(!f||p[1]>f[0]&&p[1]<f[3])){d.label=p[1];break}if(p[0]===6&&d.label<f[1]){d.label=f[1],f=p;break}if(f&&d.label<f[2]){d.label=f[2],d.ops.push(p);break}f[2]&&d.ops.pop(),d.trys.pop();continue}p=h.call(c,d)}catch(A){p=[6,A],g=0}finally{x=f=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},na=function(){function c(){}return c.hasPermissions=function(){return il(this,void 0,void 0,function(){var h,d,x,g;return ol(this,function(f){switch(f.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:for(h=f.sent(),d=0,x=h;d<x.length;d++)if(g=x[d],g.kind==="videoinput"&&g.label)return[2,!0];return[2,!1]}})})},c}(),fs=function(){function c(h){this.supportedScanTypes=this.validateAndReturnScanTypes(h)}return c.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]},c.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1},c.prototype.isCameraScanRequired=function(){for(var h=0,d=this.supportedScanTypes;h<d.length;h++){var x=d[h];if(c.isCameraScanType(x))return!0}return!1},c.isCameraScanType=function(h){return h===rs.SCAN_TYPE_CAMERA},c.isFileScanType=function(h){return h===rs.SCAN_TYPE_FILE},c.prototype.validateAndReturnScanTypes=function(h){if(!h||h.length===0)return Vt.DEFAULT_SUPPORTED_SCAN_TYPE;var d=Vt.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(h.length>d)throw"Max ".concat(d," values expected for ")+"supportedScanTypes";for(var x=0,g=h;x<g.length;x++){var f=g[x];if(!Vt.DEFAULT_SUPPORTED_SCAN_TYPE.includes(f))throw"Unsupported scan type ".concat(f)}return h},c}(),Ot=function(){function c(){}return c.ALL_ELEMENT_CLASS="html5-qrcode-element",c.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission",c.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start",c.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop",c.TORCH_BUTTON_ID="html5-qrcode-button-torch",c.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera",c.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection",c.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom",c.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change",c.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on",c.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off",c}(),ss=function(){function c(){}return c.createElement=function(h,d){var x=document.createElement(h);return x.id=d,x.classList.add(Ot.ALL_ELEMENT_CLASS),h==="button"&&x.setAttribute("type","button"),x},c}(),Ba=function(c,h,d,x){function g(f){return f instanceof d?f:new d(function(N){N(f)})}return new(d||(d=Promise))(function(f,N){function M(A){try{p(x.next(A))}catch(S){N(S)}}function j(A){try{p(x.throw(A))}catch(S){N(S)}}function p(A){A.done?f(A.value):g(A.value).then(M,j)}p((x=x.apply(c,h||[])).next())})},Pa=function(c,h){var d={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},x,g,f,N;return N={next:M(0),throw:M(1),return:M(2)},typeof Symbol=="function"&&(N[Symbol.iterator]=function(){return this}),N;function M(p){return function(A){return j([p,A])}}function j(p){if(x)throw new TypeError("Generator is already executing.");for(;N&&(N=0,p[0]&&(d=0)),d;)try{if(x=1,g&&(f=p[0]&2?g.return:p[0]?g.throw||((f=g.return)&&f.call(g),0):g.next)&&!(f=f.call(g,p[1])).done)return f;switch(g=0,f&&(p=[p[0]&2,f.value]),p[0]){case 0:case 1:f=p;break;case 4:return d.label++,{value:p[1],done:!1};case 5:d.label++,g=p[1],p=[0];continue;case 7:p=d.ops.pop(),d.trys.pop();continue;default:if(f=d.trys,!(f=f.length>0&&f[f.length-1])&&(p[0]===6||p[0]===2)){d=0;continue}if(p[0]===3&&(!f||p[1]>f[0]&&p[1]<f[3])){d.label=p[1];break}if(p[0]===6&&d.label<f[1]){d.label=f[1],f=p;break}if(f&&d.label<f[2]){d.label=f[2],d.ops.push(p);break}f[2]&&d.ops.pop(),d.trys.pop();continue}p=h.call(c,d)}catch(A){p=[6,A],g=0}finally{x=f=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},ra=function(){function c(h,d,x){this.isTorchOn=!1,this.torchCapability=h,this.buttonController=d,this.onTorchActionFailureCallback=x}return c.prototype.isTorchEnabled=function(){return this.isTorchOn},c.prototype.flipState=function(){return Ba(this,void 0,void 0,function(){var h,d;return Pa(this,function(x){switch(x.label){case 0:this.buttonController.disable(),h=!this.isTorchOn,x.label=1;case 1:return x.trys.push([1,3,,4]),[4,this.torchCapability.apply(h)];case 2:return x.sent(),this.updateUiBasedOnLatestSettings(this.torchCapability.value(),h),[3,4];case 3:return d=x.sent(),this.propagateFailure(h,d),this.buttonController.enable(),[3,4];case 4:return[2]}})})},c.prototype.updateUiBasedOnLatestSettings=function(h,d){h===d?(this.buttonController.setText(d?ke.torchOffButton():ke.torchOnButton()),this.isTorchOn=d):this.propagateFailure(d),this.buttonController.enable()},c.prototype.propagateFailure=function(h,d){var x=h?ke.torchOnFailedMessage():ke.torchOffFailedMessage();d&&(x+="; Error = "+d),this.onTorchActionFailureCallback(x)},c.prototype.reset=function(){this.isTorchOn=!1},c}(),ll=function(){function c(h,d){this.onTorchActionFailureCallback=d,this.torchButton=ss.createElement("button",Ot.TORCH_BUTTON_ID),this.torchController=new ra(h,this,d)}return c.prototype.render=function(h,d){var x=this;this.torchButton.innerText=ke.torchOnButton(),this.torchButton.style.display=d.display,this.torchButton.style.marginLeft=d.marginLeft;var g=this;this.torchButton.addEventListener("click",function(f){return Ba(x,void 0,void 0,function(){return Pa(this,function(N){switch(N.label){case 0:return[4,g.torchController.flipState()];case 1:return N.sent(),g.torchController.isTorchEnabled()?(g.torchButton.classList.remove(Ot.TORCH_BUTTON_CLASS_TORCH_OFF),g.torchButton.classList.add(Ot.TORCH_BUTTON_CLASS_TORCH_ON)):(g.torchButton.classList.remove(Ot.TORCH_BUTTON_CLASS_TORCH_ON),g.torchButton.classList.add(Ot.TORCH_BUTTON_CLASS_TORCH_OFF)),[2]}})})}),h.appendChild(this.torchButton)},c.prototype.updateTorchCapability=function(h){this.torchController=new ra(h,this,this.onTorchActionFailureCallback)},c.prototype.getTorchButton=function(){return this.torchButton},c.prototype.hide=function(){this.torchButton.style.display="none"},c.prototype.show=function(){this.torchButton.style.display="inline-block"},c.prototype.disable=function(){this.torchButton.disabled=!0},c.prototype.enable=function(){this.torchButton.disabled=!1},c.prototype.setText=function(h){this.torchButton.innerText=h},c.prototype.reset=function(){this.torchButton.innerText=ke.torchOnButton(),this.torchController.reset()},c.create=function(h,d,x,g){var f=new c(d,g);return f.render(h,x),f},c}(),cl=function(){function c(h,d,x){this.fileBasedScanRegion=this.createFileBasedScanRegion(),this.fileBasedScanRegion.style.display=d?"block":"none",h.appendChild(this.fileBasedScanRegion);var g=document.createElement("label");g.setAttribute("for",this.getFileScanInputId()),g.style.display="inline-block",this.fileBasedScanRegion.appendChild(g),this.fileSelectionButton=ss.createElement("button",Ot.FILE_SELECTION_BUTTON_ID),this.setInitialValueToButton(),this.fileSelectionButton.addEventListener("click",function(M){g.click()}),g.append(this.fileSelectionButton),this.fileScanInput=ss.createElement("input",this.getFileScanInputId()),this.fileScanInput.type="file",this.fileScanInput.accept="image/*",this.fileScanInput.style.display="none",g.appendChild(this.fileScanInput);var f=this;this.fileScanInput.addEventListener("change",function(M){if(!(M==null||M.target==null)){var j=M.target;if(!(j.files&&j.files.length===0)){var p=j.files,A=p[0],S=A.name;f.setImageNameToButton(S),x(A)}}});var N=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(N),this.fileBasedScanRegion.addEventListener("dragenter",function(M){f.fileBasedScanRegion.style.border=f.fileBasedScanRegionActiveBorder(),M.stopPropagation(),M.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragleave",function(M){f.fileBasedScanRegion.style.border=f.fileBasedScanRegionDefaultBorder(),M.stopPropagation(),M.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragover",function(M){f.fileBasedScanRegion.style.border=f.fileBasedScanRegionActiveBorder(),M.stopPropagation(),M.preventDefault()}),this.fileBasedScanRegion.addEventListener("drop",function(M){M.stopPropagation(),M.preventDefault(),f.fileBasedScanRegion.style.border=f.fileBasedScanRegionDefaultBorder();var j=M.dataTransfer;if(j){var p=j.files;if(!p||p.length===0)return;for(var A=!1,S=0;S<p.length;++S){var F=p.item(S);if(F){var Q=/image.*/;if(F.type.match(Q)){A=!0;var B=F.name;f.setImageNameToButton(B),x(F),N.innerText=ke.dragAndDropMessage();break}}}A||(N.innerText=ke.dragAndDropMessageOnlyImages())}})}return c.prototype.hide=function(){this.fileBasedScanRegion.style.display="none",this.fileScanInput.disabled=!0},c.prototype.show=function(){this.fileBasedScanRegion.style.display="block",this.fileScanInput.disabled=!1},c.prototype.isShowing=function(){return this.fileBasedScanRegion.style.display==="block"},c.prototype.resetValue=function(){this.fileScanInput.value="",this.setInitialValueToButton()},c.prototype.createFileBasedScanRegion=function(){var h=document.createElement("div");return h.style.textAlign="center",h.style.margin="auto",h.style.width="80%",h.style.maxWidth="600px",h.style.border=this.fileBasedScanRegionDefaultBorder(),h.style.padding="10px",h.style.marginBottom="10px",h},c.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"},c.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"},c.prototype.createDragAndDropMessage=function(){var h=document.createElement("div");return h.innerText=ke.dragAndDropMessage(),h.style.fontWeight="400",h},c.prototype.setImageNameToButton=function(h){var d=20;if(h.length>d){var x=h.substring(0,8),g=h.length,f=h.substring(g-8,g);h="".concat(x,"....").concat(f)}var N=ke.fileSelectionChooseAnother()+" - "+h;this.fileSelectionButton.innerText=N},c.prototype.setInitialValueToButton=function(){var h=ke.fileSelectionChooseImage()+" - "+ke.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=h},c.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"},c.create=function(h,d,x){var g=new c(h,d,x);return g},c}(),dl=function(){function c(h){this.selectElement=ss.createElement("select",Ot.CAMERA_SELECTION_SELECT_ID),this.cameras=h,this.options=[]}return c.prototype.render=function(h){var d=document.createElement("span");d.style.marginRight="10px";var x=this.cameras.length;if(x===0)throw new Error("No cameras found");if(x===1)d.style.display="none";else{var g=ke.selectCamera();d.innerText="".concat(g," (").concat(this.cameras.length,")  ")}for(var f=1,N=0,M=this.cameras;N<M.length;N++){var j=M[N],p=j.id,A=j.label==null?p:j.label;(!A||A==="")&&(A=[ke.anonymousCameraPrefix(),f++].join(" "));var S=document.createElement("option");S.value=p,S.innerText=A,this.options.push(S),this.selectElement.appendChild(S)}d.appendChild(this.selectElement),h.appendChild(d)},c.prototype.disable=function(){this.selectElement.disabled=!0},c.prototype.isDisabled=function(){return this.selectElement.disabled===!0},c.prototype.enable=function(){this.selectElement.disabled=!1},c.prototype.getValue=function(){return this.selectElement.value},c.prototype.hasValue=function(h){for(var d=0,x=this.options;d<x.length;d++){var g=x[d];if(g.value===h)return!0}return!1},c.prototype.setValue=function(h){if(!this.hasValue(h))throw new Error("".concat(h," is not present in the camera list."));this.selectElement.value=h},c.prototype.hasSingleItem=function(){return this.cameras.length===1},c.prototype.numCameras=function(){return this.cameras.length},c.create=function(h,d){var x=new c(d);return x.render(h),x},c}(),hl=function(){function c(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.rangeInput=ss.createElement("input",Ot.ZOOM_SLIDER_ID),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return c.prototype.render=function(h,d){this.zoomElementContainer.style.display=d?"block":"none",this.zoomElementContainer.style.padding="5px 10px",this.zoomElementContainer.style.textAlign="center",h.appendChild(this.zoomElementContainer),this.rangeInput.style.display="inline-block",this.rangeInput.style.width="50%",this.rangeInput.style.height="5px",this.rangeInput.style.background="#d3d3d3",this.rangeInput.style.outline="none",this.rangeInput.style.opacity="0.7";var x=ke.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(x),this.rangeText.style.marginRight="10px";var g=this;this.rangeInput.addEventListener("input",function(){return g.onValueChange()}),this.rangeInput.addEventListener("change",function(){return g.onValueChange()}),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},c.prototype.onValueChange=function(){var h=ke.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(h),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},c.prototype.setValues=function(h,d,x,g){this.rangeInput.min=h.toString(),this.rangeInput.max=d.toString(),this.rangeInput.step=g.toString(),this.rangeInput.value=x.toString(),this.onValueChange()},c.prototype.show=function(){this.zoomElementContainer.style.display="block"},c.prototype.hide=function(){this.zoomElementContainer.style.display="none"},c.prototype.setOnCameraZoomValueChangeCallback=function(h){this.onChangeCallback=h},c.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},c.create=function(h,d){var x=new c;return x.render(h,d),x},c}(),Mt;(function(c){c[c.STATUS_DEFAULT=0]="STATUS_DEFAULT",c[c.STATUS_SUCCESS=1]="STATUS_SUCCESS",c[c.STATUS_WARNING=2]="STATUS_WARNING",c[c.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(Mt||(Mt={}));function ul(c){return{fps:c.fps,qrbox:c.qrbox,aspectRatio:c.aspectRatio,disableFlip:c.disableFlip,videoConstraints:c.videoConstraints}}function fl(c,h){return{formatsToSupport:c.formatsToSupport,useBarCodeDetectorIfSupported:c.useBarCodeDetectorIfSupported,experimentalFeatures:c.experimentalFeatures,verbose:h}}var xl=function(){function c(h,d,x){if(this.lastMatchFound=null,this.cameraScanImage=null,this.fileScanImage=null,this.fileSelectionUi=null,this.elementId=h,this.config=this.createConfig(d),this.verbose=x===!0,!document.getElementById(h))throw"HTML Element with id=".concat(h," not found");this.scanTypeSelector=new fs(this.config.supportedScanTypes),this.currentScanType=this.scanTypeSelector.getDefaultScanType(),this.sectionSwapAllowed=!0,this.logger=new Ra(this.verbose),this.persistedDataManager=new sl,d.rememberLastUsedCamera!==!0&&this.persistedDataManager.reset()}return c.prototype.render=function(h,d){var x=this;this.lastMatchFound=null,this.qrCodeSuccessCallback=function(f,N){if(h)h(f,N);else{if(x.lastMatchFound===f)return;x.lastMatchFound=f,x.setHeaderMessage(ke.lastMatch(f),Mt.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(f,N){d&&d(f,N)};var g=document.getElementById(this.elementId);if(!g)throw"HTML Element with id=".concat(this.elementId," not found");g.innerHTML="",this.createBasicLayout(g),this.html5Qrcode=new ea(this.getScanRegionId(),fl(this.config,this.verbose))},c.prototype.pause=function(h){(Jt(h)||h!==!0)&&(h=!1),this.getHtml5QrcodeOrFail().pause(h)},c.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()},c.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()},c.prototype.clear=function(){var h=this,d=function(){var x=document.getElementById(h.elementId);x&&(x.innerHTML="",h.resetBasicLayout(x))};return this.html5Qrcode?new Promise(function(x,g){if(!h.html5Qrcode){x();return}h.html5Qrcode.isScanning?h.html5Qrcode.stop().then(function(f){if(!h.html5Qrcode){x();return}h.html5Qrcode.clear(),d(),x()}).catch(function(f){h.verbose&&h.logger.logError("Unable to stop qrcode scanner",f),g(f)}):(h.html5Qrcode.clear(),d(),x())}):Promise.resolve()},c.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()},c.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()},c.prototype.applyVideoConstraints=function(h){return this.getHtml5QrcodeOrFail().applyVideoConstraints(h)},c.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode},c.prototype.createConfig=function(h){return h?(h.fps||(h.fps=Vt.SCAN_DEFAULT_FPS),h.rememberLastUsedCamera!==!Vt.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(h.rememberLastUsedCamera=Vt.DEFAULT_REMEMBER_LAST_CAMERA_USED),h.supportedScanTypes||(h.supportedScanTypes=Vt.DEFAULT_SUPPORTED_SCAN_TYPE),h):{fps:Vt.SCAN_DEFAULT_FPS,rememberLastUsedCamera:Vt.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:Vt.DEFAULT_SUPPORTED_SCAN_TYPE}},c.prototype.createBasicLayout=function(h){h.style.position="relative",h.style.padding="0px",h.style.border="1px solid silver",this.createHeader(h);var d=document.createElement("div"),x=this.getScanRegionId();d.id=x,d.style.width="100%",d.style.minHeight="100px",d.style.textAlign="center",h.appendChild(d),fs.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var g=document.createElement("div"),f=this.getDashboardId();g.id=f,g.style.width="100%",h.appendChild(g),this.setupInitialDashboard(g)},c.prototype.resetBasicLayout=function(h){h.style.border="none"},c.prototype.setupInitialDashboard=function(h){this.createSection(h),this.createSectionControlPanel(),this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()},c.prototype.createHeader=function(h){var d=document.createElement("div");d.style.textAlign="left",d.style.margin="0px",h.appendChild(d);var x=new al;x.renderInto(d);var g=document.createElement("div");g.id=this.getHeaderMessageContainerId(),g.style.display="none",g.style.textAlign="center",g.style.fontSize="14px",g.style.padding="2px 10px",g.style.margin="4px",g.style.borderTop="1px solid #f6f6f6",d.appendChild(g)},c.prototype.createSection=function(h){var d=document.createElement("div");d.id=this.getDashboardSectionId(),d.style.width="100%",d.style.padding="10px 0px 10px 0px",d.style.textAlign="left",h.appendChild(d)},c.prototype.createCameraListUi=function(h,d,x){var g=this;g.showHideScanTypeSwapLink(!1),g.setHeaderMessage(ke.cameraPermissionRequesting());var f=function(){x||g.createPermissionButton(h,d)};ea.getCameras().then(function(N){g.persistedDataManager.setHasPermission(!0),g.showHideScanTypeSwapLink(!0),g.resetHeaderMessage(),N&&N.length>0?(h.removeChild(d),g.renderCameraSelection(N)):(g.setHeaderMessage(ke.noCameraFound(),Mt.STATUS_WARNING),f())}).catch(function(N){g.persistedDataManager.setHasPermission(!1),x?x.disabled=!1:f(),g.setHeaderMessage(N,Mt.STATUS_WARNING),g.showHideScanTypeSwapLink(!0)})},c.prototype.createPermissionButton=function(h,d){var x=this,g=ss.createElement("button",this.getCameraPermissionButtonId());g.innerText=ke.cameraPermissionTitle(),g.addEventListener("click",function(){g.disabled=!0,x.createCameraListUi(h,d,g)}),d.appendChild(g)},c.prototype.createPermissionsUi=function(h,d){var x=this;if(fs.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()){na.hasPermissions().then(function(g){g?x.createCameraListUi(h,d):(x.persistedDataManager.setHasPermission(!1),x.createPermissionButton(h,d))}).catch(function(g){x.persistedDataManager.setHasPermission(!1),x.createPermissionButton(h,d)});return}this.createPermissionButton(h,d)},c.prototype.createSectionControlPanel=function(){var h=document.getElementById(this.getDashboardSectionId()),d=document.createElement("div");h.appendChild(d);var x=document.createElement("div");x.id=this.getDashboardSectionCameraScanRegionId(),x.style.display=fs.isCameraScanType(this.currentScanType)?"block":"none",d.appendChild(x);var g=document.createElement("div");g.style.textAlign="center",x.appendChild(g),this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(x,g),this.renderFileScanUi(d)},c.prototype.renderFileScanUi=function(h){var d=fs.isFileScanType(this.currentScanType),x=this,g=function(f){if(!x.html5Qrcode)throw"html5Qrcode not defined";fs.isFileScanType(x.currentScanType)&&(x.setHeaderMessage(ke.loadingImage()),x.html5Qrcode.scanFileV2(f,!0).then(function(N){x.resetHeaderMessage(),x.qrCodeSuccessCallback(N.decodedText,N)}).catch(function(N){x.setHeaderMessage(N,Mt.STATUS_WARNING),x.qrCodeErrorCallback(N,Oa.createFrom(N))}))};this.fileSelectionUi=cl.create(h,d,g)},c.prototype.renderCameraSelection=function(h){var d=this,x=this,g=document.getElementById(this.getDashboardSectionCameraScanRegionId());g.style.textAlign="center";var f=hl.create(g,!1),N=function(U){var z=U.zoomFeature();if(z.isSupported()){f.setOnCameraZoomValueChangeCallback(function(X){z.apply(X)});var se=1;d.config.defaultZoomValueIfSupported&&(se=d.config.defaultZoomValueIfSupported),se=Do(se,z.min(),z.max()),f.setValues(z.min(),z.max(),se,z.step()),f.show()}},M=dl.create(g,h),j=document.createElement("span"),p=ss.createElement("button",Ot.CAMERA_START_BUTTON_ID);p.innerText=ke.scanButtonStartScanningText(),j.appendChild(p);var A=ss.createElement("button",Ot.CAMERA_STOP_BUTTON_ID);A.innerText=ke.scanButtonStopScanningText(),A.style.display="none",A.disabled=!0,j.appendChild(A);var S,F=function(U){if(!U.torchFeature().isSupported()){S&&S.hide();return}S?S.updateTorchCapability(U.torchFeature()):S=ll.create(j,U.torchFeature(),{display:"none",marginLeft:"5px"},function(z){x.setHeaderMessage(z,Mt.STATUS_WARNING)}),S.show()};g.appendChild(j);var Q=function(U){U||(p.style.display="none"),p.innerText=ke.scanButtonStartScanningText(),p.style.opacity="1",p.disabled=!1,U&&(p.style.display="inline-block")};if(p.addEventListener("click",function(U){p.innerText=ke.scanButtonScanningStarting(),M.disable(),p.disabled=!0,p.style.opacity="0.5",d.scanTypeSelector.hasMoreThanOneScanType()&&x.showHideScanTypeSwapLink(!1),x.resetHeaderMessage();var z=M.getValue();x.persistedDataManager.setLastUsedCameraId(z),x.html5Qrcode.start(z,ul(x.config),x.qrCodeSuccessCallback,x.qrCodeErrorCallback).then(function(se){A.disabled=!1,A.style.display="inline-block",Q(!1);var X=x.html5Qrcode.getRunningTrackCameraCapabilities();d.config.showTorchButtonIfSupported===!0&&F(X),d.config.showZoomSliderIfSupported===!0&&N(X)}).catch(function(se){x.showHideScanTypeSwapLink(!0),M.enable(),Q(!0),x.setHeaderMessage(se,Mt.STATUS_WARNING)})}),M.hasSingleItem()&&p.click(),A.addEventListener("click",function(U){if(!x.html5Qrcode)throw"html5Qrcode not defined";A.disabled=!0,x.html5Qrcode.stop().then(function(z){d.scanTypeSelector.hasMoreThanOneScanType()&&x.showHideScanTypeSwapLink(!0),M.enable(),p.disabled=!1,A.style.display="none",p.style.display="inline-block",S&&(S.reset(),S.hide()),f.removeOnCameraZoomValueChangeCallback(),f.hide(),x.insertCameraScanImageToScanRegion()}).catch(function(z){A.disabled=!1,x.setHeaderMessage(z,Mt.STATUS_WARNING)})}),x.persistedDataManager.getLastUsedCameraId()){var B=x.persistedDataManager.getLastUsedCameraId();M.hasValue(B)?(M.setValue(B),p.click()):x.persistedDataManager.resetLastUsedCameraId()}},c.prototype.createSectionSwap=function(){var h=this,d=ke.textIfCameraScanSelected(),x=ke.textIfFileScanSelected(),g=document.getElementById(this.getDashboardSectionId()),f=document.createElement("div");f.style.textAlign="center";var N=ss.createElement("span",this.getDashboardSectionSwapLinkId());N.style.textDecoration="underline",N.style.cursor="pointer",N.innerText=fs.isCameraScanType(this.currentScanType)?d:x,N.addEventListener("click",function(){if(!h.sectionSwapAllowed){h.verbose&&h.logger.logError("Section swap called when not allowed");return}h.resetHeaderMessage(),h.fileSelectionUi.resetValue(),h.sectionSwapAllowed=!1,fs.isCameraScanType(h.currentScanType)?(h.clearScanRegion(),h.getCameraScanRegion().style.display="none",h.fileSelectionUi.show(),N.innerText=x,h.currentScanType=rs.SCAN_TYPE_FILE,h.insertFileScanImageToScanRegion()):(h.clearScanRegion(),h.getCameraScanRegion().style.display="block",h.fileSelectionUi.hide(),N.innerText=d,h.currentScanType=rs.SCAN_TYPE_CAMERA,h.insertCameraScanImageToScanRegion(),h.startCameraScanIfPermissionExistsOnSwap()),h.sectionSwapAllowed=!0}),f.appendChild(N),g.appendChild(f)},c.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var h=this,d=this;if(this.persistedDataManager.hasCameraPermissions()){na.hasPermissions().then(function(x){if(x){var g=document.getElementById(d.getCameraPermissionButtonId());if(!g)throw h.logger.logError("Permission button not found, fail;"),"Permission button not found";g.click()}else d.persistedDataManager.setHasPermission(!1)}).catch(function(x){d.persistedDataManager.setHasPermission(!1)});return}},c.prototype.resetHeaderMessage=function(){var h=document.getElementById(this.getHeaderMessageContainerId());h.style.display="none"},c.prototype.setHeaderMessage=function(h,d){d||(d=Mt.STATUS_DEFAULT);var x=this.getHeaderMessageDiv();switch(x.innerText=h,x.style.display="block",d){case Mt.STATUS_SUCCESS:x.style.background="rgba(106, 175, 80, 0.26)",x.style.color="#477735";break;case Mt.STATUS_WARNING:x.style.background="rgba(203, 36, 49, 0.14)",x.style.color="#cb2431";break;case Mt.STATUS_DEFAULT:default:x.style.background="rgba(0, 0, 0, 0)",x.style.color="rgb(17, 17, 17)";break}},c.prototype.showHideScanTypeSwapLink=function(h){this.scanTypeSelector.hasMoreThanOneScanType()&&(h!==!0&&(h=!1),this.sectionSwapAllowed=h,this.getDashboardSectionSwapLink().style.display=h?"inline-block":"none")},c.prototype.insertCameraScanImageToScanRegion=function(){var h=this,d=document.getElementById(this.getScanRegionId());if(this.cameraScanImage){d.innerHTML="<br>",d.appendChild(this.cameraScanImage);return}this.cameraScanImage=new Image,this.cameraScanImage.onload=function(x){d.innerHTML="<br>",d.appendChild(h.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity="0.8",this.cameraScanImage.src=$o,this.cameraScanImage.alt=ke.cameraScanAltText()},c.prototype.insertFileScanImageToScanRegion=function(){var h=this,d=document.getElementById(this.getScanRegionId());if(this.fileScanImage){d.innerHTML="<br>",d.appendChild(this.fileScanImage);return}this.fileScanImage=new Image,this.fileScanImage.onload=function(x){d.innerHTML="<br>",d.appendChild(h.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity="0.8",this.fileScanImage.src=el,this.fileScanImage.alt=ke.fileScanAltText()},c.prototype.clearScanRegion=function(){var h=document.getElementById(this.getScanRegionId());h.innerHTML=""},c.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")},c.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")},c.prototype.getDashboardSectionSwapLinkId=function(){return Ot.SCAN_TYPE_CHANGE_ANCHOR_ID},c.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")},c.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")},c.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")},c.prototype.getCameraPermissionButtonId=function(){return Ot.CAMERA_PERMISSION_BUTTON_ID},c.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())},c.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())},c.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())},c}();const ml={available:{label:"Available",class:"bg-green-500/20 text-green-400",icon:Ct,action:"checkout"},checked_out:{label:"Checked Out",class:"bg-yellow-500/20 text-yellow-400",icon:ns,action:"checkin"},maintenance:{label:"Maintenance",class:"bg-orange-500/20 text-orange-400",icon:Es,action:"view"},lost:{label:"Lost",class:"bg-red-500/20 text-red-400",icon:En,action:"view"}};function gl(){const c=es(),h=$e(),d=R.useRef(null),[x,g]=R.useState(!0),[f,N]=R.useState(null),[M,j]=R.useState(!1);R.useEffect(()=>(x&&!f&&p(),()=>{d.current&&d.current.clear().catch(()=>{})}),[x,f]);const p=()=>{const z=new xl("qr-reader",{fps:10,qrbox:{width:250,height:250},supportedScanTypes:[rs.SCAN_TYPE_CAMERA],rememberLastUsedCamera:!0,aspectRatio:1},!1);z.render(A,S),d.current=z},A=async z=>{let se=z;if(z.includes("asset="))se=new URL(z).searchParams.get("asset");else if(z.includes("/")){const X=z.split("/");se=X[X.length-1]}d.current&&await d.current.clear().catch(()=>{}),g(!1),j(!0);try{const X=await Oe.getById(se);N(X.asset)}catch{h.error("Equipment not found"),F()}finally{j(!1)}},S=z=>{},F=()=>{N(null),g(!0)},Q=z=>{if(f)switch(z){case"checkout":c(`/checkout?asset=${f.asset_id}`);break;case"checkin":c(`/checkin?asset=${f.asset_id}`);break;case"view":c(`/assets/${f.asset_id}`);break}},B=f?ml[f.status]:null,U=B==null?void 0:B.icon;return n.jsxs("div",{className:"max-w-2xl mx-auto",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx("button",{onClick:()=>c(-1),className:"p-2 hover:bg-neofox-gray rounded-lg transition-colors",children:n.jsx(vs,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"QR Scanner"}),n.jsx("p",{className:"text-gray-400",children:"Scan equipment QR codes"})]})]}),f?n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"card-header flex items-center justify-between",children:[n.jsx("h3",{className:"font-semibold",children:"Scanned Equipment"}),n.jsxs("button",{onClick:F,className:"btn-secondary text-sm py-1.5 px-3 flex items-center gap-2",children:[n.jsx(dr,{className:"w-4 h-4"}),"Scan Another"]})]}),n.jsxs("div",{className:"card-body",children:[n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:"w-24 h-24 bg-neofox-darker rounded-lg flex items-center justify-center flex-shrink-0 overflow-hidden",children:f.photo?n.jsx("img",{src:f.photo,alt:"",className:"w-full h-full object-cover"}):n.jsx(Ee,{className:"w-12 h-12 text-gray-500"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-sm text-neofox-yellow font-mono",children:f.asset_id}),n.jsx("h2",{className:"text-xl font-bold mt-1",children:f.asset_name}),n.jsx("p",{className:"text-gray-400",children:f.category}),n.jsxs("div",{className:`inline-flex items-center gap-2 mt-3 px-3 py-1.5 rounded-lg ${B==null?void 0:B.class}`,children:[U&&n.jsx(U,{className:"w-4 h-4"}),n.jsx("span",{className:"font-medium",children:B==null?void 0:B.label})]})]})]}),f.status==="checked_out"&&n.jsxs("div",{className:"mt-4 p-4 bg-neofox-darker rounded-lg space-y-2",children:[n.jsxs("p",{className:"text-sm",children:[n.jsx("span",{className:"text-gray-500",children:"Current Holder:"})," ",n.jsx("span",{className:"font-medium",children:f.current_borrower})]}),f.expected_return_date&&n.jsxs("p",{className:"text-sm",children:[n.jsx("span",{className:"text-gray-500",children:"Expected Return:"})," ",n.jsx("span",{className:"font-medium",children:ye(ge(f.expected_return_date),"MMM d, yyyy")})]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[f.status==="available"&&n.jsxs("button",{onClick:()=>Q("checkout"),className:"btn-primary flex items-center justify-center gap-2 py-4",children:[n.jsx(ms,{className:"w-5 h-5"}),"Check Out"]}),f.status==="checked_out"&&n.jsxs("button",{onClick:()=>Q("checkin"),className:"btn-primary flex items-center justify-center gap-2 py-4",children:[n.jsx(Fs,{className:"w-5 h-5"}),"Check In"]}),n.jsxs("button",{onClick:()=>Q("view"),className:"btn-secondary flex items-center justify-center gap-2 py-4",children:[n.jsx(Ps,{className:"w-5 h-5"}),"View Details"]})]})]}):n.jsxs("div",{className:"card overflow-hidden",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[n.jsx(Gt,{className:"w-5 h-5 text-neofox-yellow"}),"Point camera at QR code"]})}),n.jsx("div",{className:"card-body p-0",children:M?n.jsx("div",{className:"aspect-square flex items-center justify-center bg-neofox-darker",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-12 h-12 border-4 border-neofox-yellow border-t-transparent rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-gray-400",children:"Loading equipment..."})]})}):n.jsx("div",{id:"qr-reader",className:"w-full"})}),n.jsx("div",{className:"p-4 bg-neofox-darker border-t border-neofox-gray",children:n.jsx("p",{className:"text-sm text-gray-400 text-center",children:"Position the QR code within the frame. The scanner will automatically detect it."})})]}),n.jsxs("div",{className:"mt-6 p-4 bg-neofox-dark rounded-lg",children:[n.jsx("h4",{className:"font-medium mb-2",children:"Quick Tips"}),n.jsxs("ul",{className:"text-sm text-gray-400 space-y-1",children:[n.jsx("li",{children:" Ensure good lighting for best results"}),n.jsx("li",{children:" Hold the device steady"}),n.jsx("li",{children:" QR code should fill most of the frame"}),n.jsx("li",{children:" Works with all FOXY-generated QR codes"})]})]})]})}function pl(){const c=es(),h=$e(),[d,x]=R.useState([]),[g,f]=R.useState([]),[N,M]=R.useState(!0),[j,p]=R.useState(!1),[A,S]=R.useState(""),[F,Q]=R.useState([]),[B,U]=R.useState(!1),[z,se]=R.useState(""),[X,W]=R.useState({borrower_name:"",expected_return_date:ye(yn(new Date,7),"yyyy-MM-dd"),purpose:"",notes:""});R.useEffect(()=>{Y()},[]);const Y=async()=>{var Z;try{const[q,J]=await Promise.all([Oe.getAll({status:"available"}),Ls.getBorrowers()]);x(((Z=q.assets)==null?void 0:Z.filter(ae=>ae.status==="available"))||[]),f(J.borrowers||[])}catch{h.error("Failed to load data")}finally{M(!1)}},D=[...new Set(d.map(Z=>Z.category))].sort(),v=d.filter(Z=>{const q=!A||Z.asset_name.toLowerCase().includes(A.toLowerCase())||Z.asset_id.toLowerCase().includes(A.toLowerCase()),J=!z||Z.category===z,ae=!F.find(Ce=>Ce.asset_id===Z.asset_id);return q&&J&&ae}),T=Z=>{Q(q=>[...q,Z]),U(!1),S("")},I=Z=>{Q(q=>q.filter(J=>J.asset_id!==Z))},P=async Z=>{if(Z.preventDefault(),F.length===0){h.error("Please select at least one equipment");return}if(!X.borrower_name.trim()){h.error("Please enter borrower name");return}p(!0);try{await Oe.bulkCheckout({asset_ids:F.map(q=>q.asset_id),borrower_name:X.borrower_name,expected_return_date:X.expected_return_date,purpose:X.purpose,notes:X.notes}),h.success(`${F.length} items checked out successfully`),c("/assets")}catch(q){h.error(q.message||"Failed to checkout")}finally{p(!1)}};return N?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx(Ye,{className:"w-8 h-8 animate-spin text-neofox-yellow"})}):n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx("button",{onClick:()=>c(-1),className:"p-2 hover:bg-neofox-gray rounded-lg transition-colors",children:n.jsx(vs,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Crew Checkout"}),n.jsx("p",{className:"text-gray-400",children:"Assign multiple equipment to a team member"})]})]}),n.jsxs("form",{onSubmit:P,className:"space-y-6",children:[n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"card-header flex items-center justify-between",children:[n.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[n.jsx(Ee,{className:"w-5 h-5 text-neofox-yellow"}),"Select Equipment"]}),n.jsxs("span",{className:"text-sm text-gray-400",children:[F.length," item",F.length!==1?"s":""," selected"]})]}),n.jsxs("div",{className:"card-body",children:[F.length>0&&n.jsx("div",{className:"mb-4 space-y-2",children:F.map(Z=>n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-neofox-darker rounded-lg",children:[n.jsx("div",{className:"w-12 h-12 bg-neofox-gray rounded-lg flex items-center justify-center",children:n.jsx(Ee,{className:"w-6 h-6 text-gray-500"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium",children:Z.asset_name}),n.jsxs("p",{className:"text-sm text-gray-400",children:[Z.asset_id,"  ",Z.category]})]}),n.jsx("button",{type:"button",onClick:()=>I(Z.asset_id),className:"p-2 hover:bg-neofox-gray rounded-lg text-red-400 hover:text-red-300 transition-colors",children:n.jsx(it,{className:"w-4 h-4"})})]},Z.asset_id))}),n.jsxs("div",{className:"relative",children:[n.jsxs("div",{className:"flex gap-3",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(Ft,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),n.jsx("input",{type:"text",placeholder:"Search equipment to add...",value:A,onChange:Z=>S(Z.target.value),onFocus:()=>U(!0),className:"input-field pl-10"})]}),n.jsxs("select",{value:z,onChange:Z=>se(Z.target.value),className:"select-field w-40",children:[n.jsx("option",{value:"",children:"All Categories"}),D.map(Z=>n.jsx("option",{value:Z,children:Z},Z))]})]}),B&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>U(!1)}),n.jsx("div",{className:"absolute z-20 w-full mt-2 bg-neofox-dark border border-neofox-gray rounded-lg shadow-xl max-h-64 overflow-y-auto",children:v.length>0?v.slice(0,20).map(Z=>n.jsxs("button",{type:"button",onClick:()=>T(Z),className:"flex items-center gap-3 w-full p-3 hover:bg-neofox-gray transition-colors",children:[n.jsx("div",{className:"w-10 h-10 bg-neofox-darker rounded-lg flex items-center justify-center",children:n.jsx(Ee,{className:"w-5 h-5 text-gray-500"})}),n.jsxs("div",{className:"text-left flex-1",children:[n.jsx("p",{className:"font-medium",children:Z.asset_name}),n.jsxs("p",{className:"text-sm text-gray-400",children:[Z.asset_id,"  ",Z.category]})]}),n.jsx($t,{className:"w-5 h-5 text-neofox-yellow"})]},Z.asset_id)):n.jsx("div",{className:"p-4 text-center text-gray-500",children:"No available equipment found"})})]})]})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[n.jsx(hr,{className:"w-5 h-5 text-neofox-yellow"}),"Assignment Details"]})}),n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Crew Member / Borrower ",n.jsx("span",{className:"text-red-400",children:"*"})]}),n.jsx("input",{type:"text",value:X.borrower_name,onChange:Z=>W({...X,borrower_name:Z.target.value}),className:"input-field",placeholder:"Enter name",list:"borrowers",required:!0}),n.jsx("datalist",{id:"borrowers",children:g.map(Z=>n.jsx("option",{value:Z},Z))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Expected Return Date ",n.jsx("span",{className:"text-red-400",children:"*"})]}),n.jsx("input",{type:"date",value:X.expected_return_date,onChange:Z=>W({...X,expected_return_date:Z.target.value}),min:ye(new Date,"yyyy-MM-dd"),className:"input-field",required:!0})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Project / Purpose"}),n.jsx("input",{type:"text",value:X.purpose,onChange:Z=>W({...X,purpose:Z.target.value}),className:"input-field",placeholder:"e.g., Wedding shoot, Commercial project, etc."})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Notes"}),n.jsx("textarea",{value:X.notes,onChange:Z=>W({...X,notes:Z.target.value}),rows:2,className:"input-field",placeholder:"Any additional notes"})]})]})})]}),F.length>0&&n.jsx("div",{className:"card bg-neofox-yellow/10 border-neofox-yellow/30",children:n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Ready to checkout"}),n.jsxs("p",{className:"text-xl font-bold text-neofox-yellow",children:[F.length," item",F.length!==1?"s":""]})]}),X.borrower_name&&n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Assigned to"}),n.jsx("p",{className:"font-medium",children:X.borrower_name})]})]})})}),n.jsxs("div",{className:"flex items-center justify-end gap-3",children:[n.jsx("button",{type:"button",onClick:()=>c(-1),className:"btn-secondary",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:j||F.length===0,className:"btn-primary flex items-center gap-2",children:j?n.jsxs(n.Fragment,{children:[n.jsx(Ye,{className:"w-5 h-5 animate-spin"}),"Processing..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Ct,{className:"w-5 h-5"}),"Check Out ",F.length," Item",F.length!==1?"s":""]})})]})]})]})}const yl={pending:{label:"Pending",class:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",icon:ns},approved:{label:"Approved",class:"bg-green-500/20 text-green-400 border-green-500/30",icon:Ct},rejected:{label:"Rejected",class:"bg-red-500/20 text-red-400 border-red-500/30",icon:it}};function wl({request:c,onApprove:h,onReject:d,onView:x}){const[g,f]=R.useState(!1),N=yl[c.status],M=N.icon;return n.jsx("div",{className:"card",children:n.jsxs("div",{className:"card-body",children:[n.jsxs("div",{className:"flex items-start justify-between gap-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[n.jsx("h3",{className:"font-semibold",children:c.requester_name}),n.jsxs("span",{className:`badge ${N.class} flex items-center gap-1`,children:[n.jsx(M,{className:"w-3 h-3"}),N.label]})]}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-400",children:[c.requester_email&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(va,{className:"w-4 h-4"}),c.requester_email]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(Nt,{className:"w-4 h-4"}),c.request_dates]})]}),c.purpose&&n.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:["Purpose: ",c.purpose]})]}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("button",{onClick:()=>f(!g),className:"p-2 hover:bg-neofox-gray rounded-lg transition-colors",children:n.jsx(Sn,{className:`w-5 h-5 transition-transform ${g?"rotate-180":""}`})})})]}),g&&n.jsxs("div",{className:"mt-4 pt-4 border-t border-neofox-gray",children:[n.jsx("p",{className:"text-sm font-medium text-gray-300 mb-2",children:"Requested Items:"}),n.jsx("div",{className:"bg-neofox-darker rounded-lg p-3 text-sm",children:c.required_items}),c.admin_notes&&n.jsxs("div",{className:"mt-3",children:[n.jsx("p",{className:"text-sm font-medium text-gray-300 mb-1",children:"Admin Notes:"}),n.jsx("p",{className:"text-sm text-gray-400",children:c.admin_notes})]}),c.status==="pending"&&n.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[n.jsxs("button",{onClick:()=>h(c),className:"btn-primary flex items-center gap-2 text-sm py-2",children:[n.jsx(Ct,{className:"w-4 h-4"}),"Approve & Checkout"]}),n.jsxs("button",{onClick:()=>d(c),className:"btn-danger flex items-center gap-2 text-sm py-2",children:[n.jsx(it,{className:"w-4 h-4"}),"Reject"]})]})]}),n.jsxs("div",{className:"mt-3 text-xs text-gray-500",children:["Submitted ",ye(ge(c.created_at),"MMM d, yyyy h:mm a")]})]})})}function bl(){const[c,h]=R.useState([]),[d,x]=R.useState(!0),[g,f]=R.useState("all"),[N,M]=R.useState(null),[j,p]=R.useState(""),[A,S]=R.useState(!1),F=$e(),{isAdmin:Q}=as();R.useEffect(()=>{B()},[]);const B=async()=>{try{const W=await pn.getAll();h(W.requests||[])}catch{F.error("Failed to load requests")}finally{x(!1)}},U=c.filter(W=>g==="all"?!0:W.status===g),z=async()=>{if(N){S(!0);try{await pn.approve(N.id,{admin_notes:j}),F.success("Request approved and items checked out"),B(),M(null),p("")}catch(W){F.error(W.message||"Failed to approve request")}finally{S(!1)}}},se=async()=>{if(N){S(!0);try{await pn.reject(N.id,{admin_notes:j}),F.success("Request rejected"),B(),M(null),p("")}catch{F.error("Failed to reject request")}finally{S(!1)}}},X=c.filter(W=>W.status==="pending").length;return d?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx(Ye,{className:"w-8 h-8 animate-spin text-neofox-yellow"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Gear Requests"}),n.jsx("p",{className:"text-gray-400",children:X>0?`${X} pending request${X!==1?"s":""}`:"No pending requests"})]}),n.jsxs("a",{href:"/request",target:"_blank",className:"btn-secondary flex items-center gap-2",children:[n.jsx(so,{className:"w-4 h-4"}),"Request Form Link"]})]}),n.jsx("div",{className:"flex items-center gap-2 bg-neofox-dark rounded-lg p-1",children:[{value:"all",label:"All"},{value:"pending",label:"Pending"},{value:"approved",label:"Approved"},{value:"rejected",label:"Rejected"}].map(W=>n.jsxs("button",{onClick:()=>f(W.value),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${g===W.value?"bg-neofox-yellow text-black":"text-gray-400 hover:text-white hover:bg-neofox-gray"}`,children:[W.label,W.value==="pending"&&X>0&&n.jsx("span",{className:"ml-2 px-1.5 py-0.5 bg-red-500 text-white text-xs rounded-full",children:X})]},W.value))}),U.length>0?n.jsx("div",{className:"space-y-4",children:U.map(W=>n.jsx(wl,{request:W,onApprove:Y=>M({...Y,action:"approve"}),onReject:Y=>M({...Y,action:"reject"}),onView:Y=>{}},W.id))}):n.jsxs("div",{className:"card p-12 text-center",children:[n.jsx(Ca,{className:"w-16 h-16 mx-auto text-gray-600 mb-4"}),n.jsx("h3",{className:"text-lg font-medium mb-2",children:"No requests found"}),n.jsx("p",{className:"text-gray-500",children:g!=="all"?`No ${g} requests`:"No gear requests have been submitted yet"})]}),N&&n.jsx("div",{className:"modal-overlay",onClick:()=>M(null),children:n.jsx("div",{className:"modal-content max-w-md",onClick:W=>W.stopPropagation(),children:n.jsxs("div",{className:"p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4",children:N.action==="approve"?"Approve Request":"Reject Request"}),n.jsx("p",{className:"text-gray-400 mb-4",children:N.action==="approve"?`This will checkout all requested items to ${N.requester_name}`:`Are you sure you want to reject ${N.requester_name}'s request?`}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Admin Notes (optional)"}),n.jsx("textarea",{value:j,onChange:W=>p(W.target.value),rows:3,className:"input-field",placeholder:"Add any notes..."})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>M(null),className:"btn-secondary flex-1",children:"Cancel"}),n.jsx("button",{onClick:N.action==="approve"?z:se,disabled:A,className:`flex-1 flex items-center justify-center gap-2 ${N.action==="approve"?"btn-primary":"btn-danger"}`,children:A?n.jsx(Ye,{className:"w-5 h-5 animate-spin"}):N.action==="approve"?n.jsxs(n.Fragment,{children:[n.jsx(Ct,{className:"w-5 h-5"}),"Approve"]}):n.jsxs(n.Fragment,{children:[n.jsx(it,{className:"w-5 h-5"}),"Reject"]})})]})]})})})]})}function Nl(){const[c,h]=R.useState([]),[d,x]=R.useState(!0),[g,f]=R.useState(!1),[N,M]=R.useState(!1),[j,p]=R.useState(""),[A,S]=R.useState([]),[F,Q]=R.useState(!1),[B,U]=R.useState({requester_name:"",requester_email:"",request_dates:"",purpose:""}),[z,se]=R.useState({});R.useEffect(()=>{X()},[]);const X=async()=>{var I;try{const P=await Oe.getAll({status:"available"});h(((I=P.assets)==null?void 0:I.filter(Z=>Z.status==="available"))||[])}catch{console.error("Failed to load assets")}finally{x(!1)}},W=c.filter(I=>{const P=!j||I.asset_name.toLowerCase().includes(j.toLowerCase())||I.asset_id.toLowerCase().includes(j.toLowerCase()),Z=!A.find(q=>q.asset_id===I.asset_id);return P&&Z}),Y=I=>{S(P=>[...P,I]),Q(!1),p("")},D=I=>{S(P=>P.filter(Z=>Z.asset_id!==I))},v=()=>{const I={};return B.requester_name.trim()||(I.requester_name="Name is required"),B.requester_email.trim()||(I.requester_email="Email is required"),B.requester_email&&!/\S+@\S+\.\S+/.test(B.requester_email)&&(I.requester_email="Valid email is required"),B.request_dates.trim()||(I.request_dates="Dates are required"),A.length===0&&(I.items="Please select at least one item"),se(I),Object.keys(I).length===0},T=async I=>{if(I.preventDefault(),!!v()){f(!0);try{await pn.create({requester_name:B.requester_name,requester_email:B.requester_email,request_dates:B.request_dates,purpose:B.purpose,required_items:A.map(P=>`${P.asset_name} (${P.asset_id})`).join(", ")}),M(!0)}catch{se({submit:"Failed to submit request. Please try again."})}finally{f(!1)}}};return N?n.jsx("div",{className:"min-h-screen bg-neofox-darker flex items-center justify-center p-4",children:n.jsxs("div",{className:"max-w-md w-full text-center",children:[n.jsx("div",{className:"w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-6",children:n.jsx(Ct,{className:"w-10 h-10 text-green-400"})}),n.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Request Submitted!"}),n.jsx("p",{className:"text-gray-400 mb-6",children:"Your gear request has been submitted successfully. You'll receive an email confirmation once it's been reviewed."}),n.jsx("button",{onClick:()=>{M(!1),U({requester_name:"",requester_email:"",request_dates:"",purpose:""}),S([])},className:"btn-primary",children:"Submit Another Request"})]})}):n.jsxs("div",{className:"min-h-screen bg-neofox-darker",children:[n.jsx("div",{className:"bg-neofox-dark border-b border-neofox-gray",children:n.jsx("div",{className:"max-w-3xl mx-auto px-4 py-6",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-neofox-yellow rounded-lg flex items-center justify-center",children:n.jsx(Ee,{className:"w-6 h-6 text-black"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-xl font-bold text-neofox-yellow",children:"NeoFox Media"}),n.jsx("p",{className:"text-sm text-gray-400",children:"Gear Request Form"})]})]})})}),n.jsx("div",{className:"max-w-3xl mx-auto px-4 py-8",children:n.jsxs("form",{onSubmit:T,className:"space-y-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h2",{className:"font-semibold flex items-center gap-2",children:[n.jsx(Rt,{className:"w-5 h-5 text-neofox-yellow"}),"Your Information"]})}),n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Your Name ",n.jsx("span",{className:"text-red-400",children:"*"})]}),n.jsx("input",{type:"text",value:B.requester_name,onChange:I=>U({...B,requester_name:I.target.value}),className:`input-field ${z.requester_name?"border-red-500":""}`,placeholder:"Enter your name"}),z.requester_name&&n.jsx("p",{className:"text-sm text-red-400 mt-1",children:z.requester_name})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Email ",n.jsx("span",{className:"text-red-400",children:"*"})]}),n.jsx("input",{type:"email",value:B.requester_email,onChange:I=>U({...B,requester_email:I.target.value}),className:`input-field ${z.requester_email?"border-red-500":""}`,placeholder:"your@email.com"}),z.requester_email&&n.jsx("p",{className:"text-sm text-red-400 mt-1",children:z.requester_email})]})]})})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h2",{className:"font-semibold flex items-center gap-2",children:[n.jsx(Nt,{className:"w-5 h-5 text-neofox-yellow"}),"Request Details"]})}),n.jsxs("div",{className:"card-body space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Request Dates ",n.jsx("span",{className:"text-red-400",children:"*"})]}),n.jsx("input",{type:"text",value:B.request_dates,onChange:I=>U({...B,request_dates:I.target.value}),className:`input-field ${z.request_dates?"border-red-500":""}`,placeholder:"e.g., Dec 20-25, 2025"}),z.request_dates&&n.jsx("p",{className:"text-sm text-red-400 mt-1",children:z.request_dates})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Purpose / Project"}),n.jsx("textarea",{value:B.purpose,onChange:I=>U({...B,purpose:I.target.value}),rows:2,className:"input-field",placeholder:"Describe what you'll be using the equipment for"})]})]})]}),n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"card-header flex items-center justify-between",children:[n.jsxs("h2",{className:"font-semibold flex items-center gap-2",children:[n.jsx(Ee,{className:"w-5 h-5 text-neofox-yellow"}),"Equipment Needed"]}),A.length>0&&n.jsxs("span",{className:"text-sm text-gray-400",children:[A.length," selected"]})]}),n.jsxs("div",{className:"card-body",children:[z.items&&n.jsx("p",{className:"text-sm text-red-400 mb-3",children:z.items}),A.length>0&&n.jsx("div",{className:"mb-4 space-y-2",children:A.map(I=>n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-neofox-darker rounded-lg",children:[n.jsx(Ee,{className:"w-5 h-5 text-neofox-yellow"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium",children:I.asset_name}),n.jsx("p",{className:"text-sm text-gray-400",children:I.category})]}),n.jsx("button",{type:"button",onClick:()=>D(I.asset_id),className:"p-1 hover:bg-neofox-gray rounded text-red-400",children:n.jsx(it,{className:"w-4 h-4"})})]},I.asset_id))}),n.jsxs("div",{className:"relative",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Ft,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),n.jsx("input",{type:"text",placeholder:"Search available equipment...",value:j,onChange:I=>p(I.target.value),onFocus:()=>Q(!0),className:"input-field pl-10"})]}),F&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>Q(!1)}),n.jsx("div",{className:"absolute z-20 w-full mt-2 bg-neofox-dark border border-neofox-gray rounded-lg shadow-xl max-h-64 overflow-y-auto",children:d?n.jsx("div",{className:"p-4 text-center text-gray-500",children:n.jsx(Ye,{className:"w-5 h-5 animate-spin mx-auto"})}):W.length>0?W.slice(0,15).map(I=>n.jsxs("button",{type:"button",onClick:()=>Y(I),className:"flex items-center gap-3 w-full p-3 hover:bg-neofox-gray transition-colors text-left",children:[n.jsx(Ee,{className:"w-5 h-5 text-gray-500"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium",children:I.asset_name}),n.jsx("p",{className:"text-sm text-gray-400",children:I.category})]}),n.jsx($t,{className:"w-5 h-5 text-neofox-yellow"})]},I.asset_id)):n.jsx("div",{className:"p-4 text-center text-gray-500",children:"No available equipment found"})})]})]})]})]}),z.submit&&n.jsx("div",{className:"p-4 bg-red-500/20 border border-red-500/30 rounded-lg text-red-400",children:z.submit}),n.jsx("button",{type:"submit",disabled:g,className:"btn-primary w-full flex items-center justify-center gap-2 py-3",children:g?n.jsxs(n.Fragment,{children:[n.jsx(Ye,{className:"w-5 h-5 animate-spin"}),"Submitting..."]}):n.jsxs(n.Fragment,{children:[n.jsx(fo,{className:"w-5 h-5"}),"Submit Request"]})})]})})]})}const aa={low:{label:"Low",class:"bg-blue-500/20 text-blue-400"},medium:{label:"Medium",class:"bg-yellow-500/20 text-yellow-400"},high:{label:"High",class:"bg-orange-500/20 text-orange-400"},critical:{label:"Critical",class:"bg-red-500/20 text-red-400"}},ia={open:{label:"Open",class:"bg-red-500/20 text-red-400"},in_progress:{label:"In Progress",class:"bg-yellow-500/20 text-yellow-400"},resolved:{label:"Resolved",class:"bg-green-500/20 text-green-400"},closed:{label:"Closed",class:"bg-gray-500/20 text-gray-400"}};function Cl(){const[c,h]=R.useState([]),[d,x]=R.useState([]),[g,f]=R.useState([]),[N,M]=R.useState(!0),[j,p]=R.useState("issues"),[A,S]=R.useState(!1),[F,Q]=R.useState(null),[B,U]=R.useState(""),[z,se]=R.useState(!1),[X,W]=R.useState(!1),Y=$e(),[D,v]=R.useState({issue_type:"mechanical",severity:"medium",description:"",reported_by:""});R.useEffect(()=>{T()},[]);const T=async()=>{try{const[q,J,ae]=await Promise.all([Kn.getIssues(),Kn.getSchedule(),Oe.getAll()]);h(q.issues||[]),x(J.schedule||[]),f(ae.assets||[])}catch{Y.error("Failed to load maintenance data")}finally{M(!1)}},I=g.filter(q=>!B||q.asset_name.toLowerCase().includes(B.toLowerCase())||q.asset_id.toLowerCase().includes(B.toLowerCase())),P=async()=>{if(!F){Y.error("Please select equipment");return}if(!D.description.trim()){Y.error("Please describe the issue");return}W(!0);try{await Kn.createIssue({asset_id:F.id,...D,reported_date:new Date().toISOString()}),Y.success("Issue reported successfully"),S(!1),Q(null),v({issue_type:"mechanical",severity:"medium",description:"",reported_by:""}),T()}catch{Y.error("Failed to report issue")}finally{W(!1)}},Z=c.filter(q=>q.status==="open"||q.status==="in_progress").length;return N?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx(Ye,{className:"w-8 h-8 animate-spin text-neofox-yellow"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Maintenance"}),n.jsx("p",{className:"text-gray-400",children:Z>0?`${Z} open issue${Z!==1?"s":""}`:"No open issues"})]}),n.jsxs("button",{onClick:()=>S(!0),className:"btn-primary flex items-center gap-2",children:[n.jsx($t,{className:"w-5 h-5"}),"Report Issue"]})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"stat-card",children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Open Issues"}),n.jsx("p",{className:"text-2xl font-bold text-red-400",children:c.filter(q=>q.status==="open").length})]}),n.jsxs("div",{className:"stat-card",children:[n.jsx("p",{className:"text-sm text-gray-400",children:"In Progress"}),n.jsx("p",{className:"text-2xl font-bold text-yellow-400",children:c.filter(q=>q.status==="in_progress").length})]}),n.jsxs("div",{className:"stat-card",children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Resolved"}),n.jsx("p",{className:"text-2xl font-bold text-green-400",children:c.filter(q=>q.status==="resolved").length})]}),n.jsxs("div",{className:"stat-card",children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Scheduled Tasks"}),n.jsx("p",{className:"text-2xl font-bold",children:d.length})]})]}),n.jsxs("div",{className:"flex items-center gap-2 bg-neofox-dark rounded-lg p-1",children:[n.jsx("button",{onClick:()=>p("issues"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${j==="issues"?"bg-neofox-yellow text-black":"text-gray-400 hover:text-white hover:bg-neofox-gray"}`,children:"Issues"}),n.jsx("button",{onClick:()=>p("schedule"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${j==="schedule"?"bg-neofox-yellow text-black":"text-gray-400 hover:text-white hover:bg-neofox-gray"}`,children:"Schedule"})]}),j==="issues"?n.jsx("div",{className:"card",children:n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"data-table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{children:"Equipment"}),n.jsx("th",{children:"Issue Type"}),n.jsx("th",{children:"Severity"}),n.jsx("th",{children:"Status"}),n.jsx("th",{children:"Reported"}),n.jsx("th",{children:"Description"})]})}),n.jsx("tbody",{children:c.length>0?c.map(q=>{var J,ae,Ce,H;return n.jsxs("tr",{children:[n.jsx("td",{children:n.jsx("p",{className:"font-medium",children:q.asset_name||`Asset #${q.asset_id}`})}),n.jsx("td",{className:"capitalize",children:q.issue_type}),n.jsx("td",{children:n.jsx("span",{className:`badge ${((J=aa[q.severity])==null?void 0:J.class)||""}`,children:((ae=aa[q.severity])==null?void 0:ae.label)||q.severity})}),n.jsx("td",{children:n.jsx("span",{className:`badge ${((Ce=ia[q.status])==null?void 0:Ce.class)||""}`,children:((H=ia[q.status])==null?void 0:H.label)||q.status})}),n.jsx("td",{className:"text-sm text-gray-400",children:q.reported_date?ye(ge(q.reported_date),"MMM d, yyyy"):""}),n.jsx("td",{className:"max-w-xs truncate text-gray-400",children:q.description})]},q.id)}):n.jsx("tr",{children:n.jsxs("td",{colSpan:6,className:"text-center py-8 text-gray-500",children:[n.jsx(Es,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),"No maintenance issues reported"]})})})]})})}):n.jsx("div",{className:"card",children:n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"data-table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{children:"Equipment"}),n.jsx("th",{children:"Type"}),n.jsx("th",{children:"Scheduled Date"}),n.jsx("th",{children:"Status"}),n.jsx("th",{children:"Assigned To"})]})}),n.jsx("tbody",{children:d.length>0?d.map(q=>n.jsxs("tr",{children:[n.jsx("td",{className:"font-medium",children:q.asset_name||`Asset #${q.asset_id}`}),n.jsx("td",{className:"capitalize",children:q.maintenance_type}),n.jsx("td",{children:q.scheduled_date&&ye(ge(q.scheduled_date),"MMM d, yyyy")}),n.jsx("td",{children:n.jsx("span",{className:`badge ${q.status==="completed"?"bg-green-500/20 text-green-400":q.status==="in_progress"?"bg-yellow-500/20 text-yellow-400":"bg-blue-500/20 text-blue-400"}`,children:q.status})}),n.jsx("td",{className:"text-gray-400",children:q.assigned_to||""})]},q.id)):n.jsx("tr",{children:n.jsxs("td",{colSpan:5,className:"text-center py-8 text-gray-500",children:[n.jsx(Nt,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),"No scheduled maintenance"]})})})]})})}),A&&n.jsx("div",{className:"modal-overlay",onClick:()=>S(!1),children:n.jsx("div",{className:"modal-content",onClick:q=>q.stopPropagation(),children:n.jsxs("div",{className:"p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Report Maintenance Issue"}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Equipment"}),F?n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-neofox-darker rounded-lg",children:[n.jsx(Ee,{className:"w-5 h-5 text-neofox-yellow"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium",children:F.asset_name}),n.jsx("p",{className:"text-sm text-gray-400",children:F.asset_id})]}),n.jsx("button",{onClick:()=>Q(null),className:"text-gray-400 hover:text-white",children:n.jsx(it,{className:"w-4 h-4"})})]}):n.jsxs("div",{className:"relative",children:[n.jsx(Ft,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),n.jsx("input",{type:"text",placeholder:"Search equipment...",value:B,onChange:q=>U(q.target.value),onFocus:()=>se(!0),className:"input-field pl-10"}),z&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>se(!1)}),n.jsx("div",{className:"absolute z-20 w-full mt-2 bg-neofox-dark border border-neofox-gray rounded-lg shadow-xl max-h-48 overflow-y-auto",children:I.slice(0,10).map(q=>n.jsxs("button",{onClick:()=>{Q(q),se(!1),U("")},className:"flex items-center gap-3 w-full p-3 hover:bg-neofox-gray",children:[n.jsx(Ee,{className:"w-5 h-5 text-gray-500"}),n.jsxs("div",{className:"text-left",children:[n.jsx("p",{className:"font-medium",children:q.asset_name}),n.jsx("p",{className:"text-sm text-gray-400",children:q.asset_id})]})]},q.asset_id))})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Issue Type"}),n.jsxs("select",{value:D.issue_type,onChange:q=>v({...D,issue_type:q.target.value}),className:"select-field",children:[n.jsx("option",{value:"mechanical",children:"Mechanical"}),n.jsx("option",{value:"electrical",children:"Electrical"}),n.jsx("option",{value:"software",children:"Software"}),n.jsx("option",{value:"cosmetic",children:"Cosmetic"}),n.jsx("option",{value:"performance",children:"Performance"}),n.jsx("option",{value:"safety",children:"Safety"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Severity"}),n.jsxs("select",{value:D.severity,onChange:q=>v({...D,severity:q.target.value}),className:"select-field",children:[n.jsx("option",{value:"low",children:"Low"}),n.jsx("option",{value:"medium",children:"Medium"}),n.jsx("option",{value:"high",children:"High"}),n.jsx("option",{value:"critical",children:"Critical"})]})]})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Description"}),n.jsx("textarea",{value:D.description,onChange:q=>v({...D,description:q.target.value}),rows:3,className:"input-field",placeholder:"Describe the issue..."})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Reported By"}),n.jsx("input",{type:"text",value:D.reported_by,onChange:q=>v({...D,reported_by:q.target.value}),className:"input-field",placeholder:"Your name"})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>S(!1),className:"btn-secondary flex-1",children:"Cancel"}),n.jsx("button",{onClick:P,disabled:X,className:"btn-primary flex-1",children:X?n.jsx(Ye,{className:"w-5 h-5 animate-spin mx-auto"}):"Submit Issue"})]})]})})})]})}function Al(){var X,W;const[c,h]=R.useState([]),[d,x]=R.useState(null),[g,f]=R.useState(!0),[N,M]=R.useState("30"),[j,p]=R.useState(""),[A,S]=R.useState(""),F=$e();R.useEffect(()=>{Q()},[N]);const Q=async()=>{f(!0);try{const[Y,D]=await Promise.all([rr.getAll({days:N}),pa.getReports({days:N})]);h(Y.transactions||[]),x(D)}catch{F.error("Failed to load reports")}finally{f(!1)}},B=c.filter(Y=>{var T,I,P;const D=!j||Y.transaction_type===j,v=!A||((T=Y.asset_name)==null?void 0:T.toLowerCase().includes(A.toLowerCase()))||((I=Y.asset_id)==null?void 0:I.toLowerCase().includes(A.toLowerCase()))||((P=Y.borrower_name)==null?void 0:P.toLowerCase().includes(A.toLowerCase()));return D&&v}),U=()=>{const Y=["Date","Asset ID","Asset Name","Type","Borrower","Purpose"],D=B.map(Z=>[ye(ge(Z.transaction_date),"yyyy-MM-dd HH:mm"),Z.asset_id,Z.asset_name||"",Z.transaction_type,Z.borrower_name,Z.purpose||""]),v=[Y,...D].map(Z=>Z.join(",")).join(`
`),T=new Blob([v],{type:"text/csv"}),I=window.URL.createObjectURL(T),P=document.createElement("a");P.href=I,P.download=`foxy-transactions-${ye(new Date,"yyyy-MM-dd")}.csv`,P.click()},z=c.filter(Y=>Y.transaction_type==="checkout").length,se=c.filter(Y=>Y.transaction_type==="checkin").length;return g?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx(Ye,{className:"w-8 h-8 animate-spin text-neofox-yellow"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Reports & Analytics"}),n.jsx("p",{className:"text-gray-400",children:"Track equipment usage and activity"})]}),n.jsxs("button",{onClick:U,className:"btn-secondary flex items-center gap-2",children:[n.jsx($s,{className:"w-5 h-5"}),"Export CSV"]})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"stat-card",children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Total Transactions"}),n.jsx("p",{className:"text-2xl font-bold",children:c.length})]}),n.jsxs("div",{className:"stat-card",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx(ms,{className:"w-4 h-4 text-yellow-400"}),n.jsx("p",{className:"text-sm text-gray-400",children:"Checkouts"})]}),n.jsx("p",{className:"text-2xl font-bold text-yellow-400",children:z})]}),n.jsxs("div",{className:"stat-card",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx(Fs,{className:"w-4 h-4 text-green-400"}),n.jsx("p",{className:"text-sm text-gray-400",children:"Check-ins"})]}),n.jsx("p",{className:"text-2xl font-bold text-green-400",children:se})]}),n.jsxs("div",{className:"stat-card",children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Active Borrowers"}),n.jsx("p",{className:"text-2xl font-bold",children:(d==null?void 0:d.activeBorrowers)||0})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"font-semibold",children:"Activity Over Time"})}),n.jsx("div",{className:"card-body",children:((X=d==null?void 0:d.activityByDate)==null?void 0:X.length)>0?n.jsx(ua,{width:"100%",height:250,children:n.jsxs(Si,{data:d.activityByDate,children:[n.jsx(ji,{dataKey:"date",tick:{fill:"#9CA3AF",fontSize:12}}),n.jsx(Ii,{tick:{fill:"#9CA3AF",fontSize:12}}),n.jsx(fa,{contentStyle:{backgroundColor:"#1a1a1a",border:"1px solid #333",borderRadius:"8px"}}),n.jsx(kr,{dataKey:"checkouts",fill:"#FFD700",name:"Checkouts"}),n.jsx(kr,{dataKey:"checkins",fill:"#4CAF50",name:"Check-ins"})]})}):n.jsx("div",{className:"h-[250px] flex items-center justify-center text-gray-500",children:"No activity data available"})})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"font-semibold",children:"Most Used Equipment"})}),n.jsx("div",{className:"card-body",children:((W=d==null?void 0:d.topAssets)==null?void 0:W.length)>0?n.jsx("div",{className:"space-y-3",children:d.topAssets.slice(0,5).map((Y,D)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"w-6 h-6 bg-neofox-yellow/20 text-neofox-yellow rounded-full flex items-center justify-center text-sm font-medium",children:D+1}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium",children:Y.asset_name}),n.jsx("p",{className:"text-sm text-gray-400",children:Y.asset_id})]}),n.jsxs("span",{className:"text-sm font-medium",children:[Y.count," uses"]})]},Y.asset_id))}):n.jsx("div",{className:"h-[200px] flex items-center justify-center text-gray-500",children:"No usage data available"})})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[n.jsx("h3",{className:"font-semibold",children:"Transaction History"}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("select",{value:N,onChange:Y=>M(Y.target.value),className:"select-field w-32 py-2",children:[n.jsx("option",{value:"7",children:"Last 7 days"}),n.jsx("option",{value:"30",children:"Last 30 days"}),n.jsx("option",{value:"90",children:"Last 90 days"}),n.jsx("option",{value:"365",children:"Last year"})]}),n.jsxs("select",{value:j,onChange:Y=>p(Y.target.value),className:"select-field w-32 py-2",children:[n.jsx("option",{value:"",children:"All Types"}),n.jsx("option",{value:"checkout",children:"Checkouts"}),n.jsx("option",{value:"checkin",children:"Check-ins"})]}),n.jsxs("div",{className:"relative",children:[n.jsx(Ft,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),n.jsx("input",{type:"text",placeholder:"Search...",value:A,onChange:Y=>S(Y.target.value),className:"input-field pl-9 py-2 w-48"})]})]})]})}),n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"data-table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{children:"Date & Time"}),n.jsx("th",{children:"Equipment"}),n.jsx("th",{children:"Type"}),n.jsx("th",{children:"Borrower"}),n.jsx("th",{children:"Purpose"})]})}),n.jsx("tbody",{children:B.length>0?B.map((Y,D)=>n.jsxs("tr",{children:[n.jsxs("td",{className:"text-sm",children:[ye(ge(Y.transaction_date),"MMM d, yyyy"),n.jsx("br",{}),n.jsx("span",{className:"text-gray-500",children:ye(ge(Y.transaction_date),"h:mm a")})]}),n.jsxs("td",{children:[n.jsx("p",{className:"font-medium",children:Y.asset_name||Y.asset_id}),n.jsx("p",{className:"text-sm text-neofox-yellow font-mono",children:Y.asset_id})]}),n.jsx("td",{children:n.jsx("span",{className:`badge ${Y.transaction_type==="checkout"?"bg-yellow-500/20 text-yellow-400":"bg-green-500/20 text-green-400"}`,children:Y.transaction_type==="checkout"?"Check Out":"Check In"})}),n.jsx("td",{children:Y.borrower_name}),n.jsx("td",{className:"text-gray-400 max-w-xs truncate",children:Y.purpose||""})]},D)):n.jsx("tr",{children:n.jsx("td",{colSpan:5,className:"text-center py-8 text-gray-500",children:"No transactions found"})})})]})})]})]})}const oa={admin:{label:"Admin",class:"bg-neofox-yellow/20 text-neofox-yellow"},team_member:{label:"Team Member",class:"bg-blue-500/20 text-blue-400"},guest:{label:"Guest",class:"bg-gray-500/20 text-gray-400"}};function El(){const[c,h]=R.useState([]),[d,x]=R.useState(!0),[g,f]=R.useState(!1),[N,M]=R.useState(null),[j,p]=R.useState(!1),[A,S]=R.useState(!1),[F,Q]=R.useState(null),B=$e(),{user:U,isAdmin:z}=as(),[se,X]=R.useState({username:"",email:"",password:"",role:"team_member"});R.useEffect(()=>{W()},[]);const W=async()=>{try{const I=await Ls.getAll();h(I.users||[])}catch{B.error("Failed to load users")}finally{x(!1)}},Y=()=>{M(null),X({username:"",email:"",password:"",role:"team_member"}),f(!0)},D=I=>{M(I),X({username:I.username,email:I.email||"",password:"",role:I.role}),f(!0)},v=async()=>{if(!se.username.trim()){B.error("Username is required");return}if(!N&&!se.password){B.error("Password is required for new users");return}S(!0);try{N?(await Ls.update(N.id,se),B.success("User updated successfully")):(await Ls.create(se),B.success("User created successfully")),f(!1),W()}catch(I){B.error(I.message||"Failed to save user")}finally{S(!1)}},T=async I=>{if(I.id===(U==null?void 0:U.id)){B.error("Cannot delete your own account");return}try{await Ls.delete(I.id),B.success("User deleted"),Q(null),W()}catch{B.error("Failed to delete user")}};return z()?d?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx(Ye,{className:"w-8 h-8 animate-spin text-neofox-yellow"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Users"}),n.jsxs("p",{className:"text-gray-400",children:[c.length," team member",c.length!==1?"s":""]})]}),n.jsxs("button",{onClick:Y,className:"btn-primary flex items-center gap-2",children:[n.jsx($t,{className:"w-5 h-5"}),"Add User"]})]}),n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(I=>{var P,Z;return n.jsxs("div",{className:"card p-5 hover:border-neofox-yellow/30 transition-colors",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-neofox-yellow/20 rounded-full flex items-center justify-center",children:n.jsx(Rt,{className:"w-6 h-6 text-neofox-yellow"})}),n.jsx("span",{className:`badge ${((P=oa[I.role])==null?void 0:P.class)||""}`,children:((Z=oa[I.role])==null?void 0:Z.label)||I.role})]}),n.jsx("h3",{className:"font-semibold text-lg",children:I.username}),I.email&&n.jsxs("p",{className:"text-sm text-gray-400 flex items-center gap-1 mt-1",children:[n.jsx(va,{className:"w-4 h-4"}),I.email]}),n.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Created ",I.created_at?ye(ge(I.created_at),"MMM d, yyyy"):""]}),n.jsxs("div",{className:"flex items-center gap-2 mt-4 pt-4 border-t border-neofox-gray",children:[n.jsxs("button",{onClick:()=>D(I),className:"flex-1 btn-secondary py-2 text-sm flex items-center justify-center gap-1",children:[n.jsx(en,{className:"w-4 h-4"}),"Edit"]}),I.id!==(U==null?void 0:U.id)&&n.jsx("button",{onClick:()=>Q(I),className:"p-2 text-red-400 hover:bg-red-500/20 rounded-lg transition-colors",children:n.jsx(gs,{className:"w-4 h-4"})})]})]},I.id)})}),g&&n.jsx("div",{className:"modal-overlay",onClick:()=>f(!1),children:n.jsx("div",{className:"modal-content max-w-md",onClick:I=>I.stopPropagation(),children:n.jsxs("div",{className:"p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4",children:N?"Edit User":"Create User"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Username"}),n.jsx("input",{type:"text",value:se.username,onChange:I=>X({...se,username:I.target.value}),className:"input-field",placeholder:"Enter username",disabled:N})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email"}),n.jsx("input",{type:"email",value:se.email,onChange:I=>X({...se,email:I.target.value}),className:"input-field",placeholder:"user@example.com"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Password ",N&&"(leave blank to keep current)"]}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:j?"text":"password",value:se.password,onChange:I=>X({...se,password:I.target.value}),className:"input-field pr-10",placeholder:N?"Leave blank to keep current":"Enter password"}),n.jsx("button",{type:"button",onClick:()=>p(!j),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",children:j?n.jsx(ar,{className:"w-5 h-5"}):n.jsx(Ps,{className:"w-5 h-5"})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Role"}),n.jsxs("select",{value:se.role,onChange:I=>X({...se,role:I.target.value}),className:"select-field",children:[n.jsx("option",{value:"team_member",children:"Team Member"}),n.jsx("option",{value:"admin",children:"Admin"}),n.jsx("option",{value:"guest",children:"Guest"})]})]})]}),n.jsxs("div",{className:"flex gap-3 mt-6",children:[n.jsx("button",{onClick:()=>f(!1),className:"btn-secondary flex-1",children:"Cancel"}),n.jsx("button",{onClick:v,disabled:A,className:"btn-primary flex-1",children:A?n.jsx(Ye,{className:"w-5 h-5 animate-spin mx-auto"}):N?"Update":"Create"})]})]})})}),F&&n.jsx("div",{className:"modal-overlay",onClick:()=>Q(null),children:n.jsx("div",{className:"modal-content max-w-md",onClick:I=>I.stopPropagation(),children:n.jsxs("div",{className:"p-6 text-center",children:[n.jsx("div",{className:"w-12 h-12 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(gs,{className:"w-6 h-6 text-red-400"})}),n.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Delete User?"}),n.jsxs("p",{className:"text-gray-400 mb-6",children:["Are you sure you want to delete ",n.jsx("strong",{children:F.username}),"?"]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>Q(null),className:"btn-secondary flex-1",children:"Cancel"}),n.jsx("button",{onClick:()=>T(F),className:"btn-danger flex-1",children:"Delete"})]})]})})})]}):n.jsxs("div",{className:"card p-12 text-center",children:[n.jsx(xo,{className:"w-16 h-16 mx-auto text-gray-600 mb-4"}),n.jsx("h3",{className:"text-lg font-medium mb-2",children:"Access Denied"}),n.jsx("p",{className:"text-gray-500",children:"You need admin privileges to access this page."})]})}function vl(){const{user:c}=as(),h=$e(),[d,x]=R.useState(!1),[g,f]=R.useState(!1),[N,M]=R.useState({email:(c==null?void 0:c.email)||"",currentPassword:"",newPassword:"",confirmPassword:""}),j=async p=>{if(p.preventDefault(),N.newPassword&&N.newPassword!==N.confirmPassword){h.error("Passwords do not match");return}f(!0);try{await new Promise(A=>setTimeout(A,500)),h.success("Profile updated successfully"),M(A=>({...A,currentPassword:"",newPassword:"",confirmPassword:""}))}catch{h.error("Failed to update profile")}finally{f(!1)}};return n.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Settings"}),n.jsx("p",{className:"text-gray-400",children:"Manage your account and preferences"})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h2",{className:"font-semibold flex items-center gap-2",children:[n.jsx(Rt,{className:"w-5 h-5 text-neofox-yellow"}),"Profile"]})}),n.jsx("div",{className:"card-body",children:n.jsxs("form",{onSubmit:j,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Username"}),n.jsx("input",{type:"text",value:(c==null?void 0:c.username)||"",disabled:!0,className:"input-field bg-neofox-darker/50 cursor-not-allowed"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Username cannot be changed"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email"}),n.jsx("input",{type:"email",value:N.email,onChange:p=>M({...N,email:p.target.value}),className:"input-field",placeholder:"your@email.com"})]})]}),n.jsxs("div",{className:"border-t border-neofox-gray pt-4 mt-4",children:[n.jsxs("h3",{className:"font-medium mb-4 flex items-center gap-2",children:[n.jsx(oo,{className:"w-4 h-4"}),"Change Password"]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Current Password"}),n.jsx("input",{type:d?"text":"password",value:N.currentPassword,onChange:p=>M({...N,currentPassword:p.target.value}),className:"input-field"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"New Password"}),n.jsx("input",{type:d?"text":"password",value:N.newPassword,onChange:p=>M({...N,newPassword:p.target.value}),className:"input-field"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Confirm Password"}),n.jsx("input",{type:d?"text":"password",value:N.confirmPassword,onChange:p=>M({...N,confirmPassword:p.target.value}),className:"input-field"})]})]}),n.jsxs("button",{type:"button",onClick:()=>x(!d),className:"text-sm text-gray-400 hover:text-white mt-2 flex items-center gap-1",children:[d?n.jsx(ar,{className:"w-4 h-4"}):n.jsx(Ps,{className:"w-4 h-4"}),d?"Hide passwords":"Show passwords"]})]}),n.jsx("div",{className:"flex justify-end pt-4",children:n.jsxs("button",{type:"submit",disabled:g,className:"btn-primary flex items-center gap-2",children:[n.jsx(ja,{className:"w-5 h-5"}),g?"Saving...":"Save Changes"]})})]})})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h2",{className:"font-semibold flex items-center gap-2",children:[n.jsx(ba,{className:"w-5 h-5 text-neofox-yellow"}),"Notifications"]})}),n.jsx("div",{className:"card-body space-y-4",children:[{label:"Checkout Notifications",desc:"Get notified when equipment is checked out"},{label:"Check-in Notifications",desc:"Get notified when equipment is returned"},{label:"Overdue Alerts",desc:"Receive alerts for overdue equipment"},{label:"Maintenance Reminders",desc:"Get reminders for scheduled maintenance"}].map((p,A)=>n.jsxs("div",{className:"flex items-center justify-between p-4 bg-neofox-darker rounded-lg",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:p.label}),n.jsx("p",{className:"text-sm text-gray-400",children:p.desc})]}),n.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",defaultChecked:!0,className:"sr-only peer"}),n.jsx("div",{className:"w-11 h-6 bg-neofox-gray peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-neofox-yellow"})]})]},A))})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h2",{className:"font-semibold flex items-center gap-2",children:[n.jsx(eo,{className:"w-5 h-5 text-neofox-yellow"}),"Data Management"]})}),n.jsxs("div",{className:"card-body",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("button",{className:"btn-secondary flex items-center justify-center gap-2 py-4",children:[n.jsx($s,{className:"w-5 h-5"}),"Export All Data"]}),n.jsxs("button",{className:"btn-secondary flex items-center justify-center gap-2 py-4",children:[n.jsx(In,{className:"w-5 h-5"}),"Import Data"]})]}),n.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"Export your inventory data for backup or import data from a previous backup."})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h2",{className:"font-semibold",children:"About FOXY"})}),n.jsxs("div",{className:"card-body",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-16 h-16 bg-neofox-yellow rounded-xl flex items-center justify-center",children:n.jsx("span",{className:"text-2xl font-bold text-black",children:"F"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-bold text-neofox-yellow",children:"FOXY"}),n.jsx("p",{className:"text-gray-400",children:"NeoFox Media Inventory System"}),n.jsx("p",{className:"text-sm text-gray-500",children:"Version 2.0.0"})]})]}),n.jsx("p",{className:"text-sm text-gray-400",children:"A modern equipment inventory management system built for media production teams. Manage your cameras, lenses, audio gear, and more with ease."}),n.jsx("div",{className:"mt-4 pt-4 border-t border-neofox-gray",children:n.jsx("p",{className:"text-sm text-gray-500",children:"Built with React + TailwindCSS + PHP"})})]})]})]})}function Sl(){const c=es(),h=$e(),[d,x]=R.useState([]),[g,f]=R.useState([]),[N,M]=R.useState(!0),[j,p]=R.useState(""),[A,S]=R.useState(!1),[F,Q]=R.useState(null),[B,U]=R.useState(null);R.useEffect(()=>{z()},[]);const z=async()=>{try{const[D,v]=await Promise.all([Oe.getKits(),Oe.getAll()]);x(D.kits||[]),f(v.assets||[])}catch{h.error("Failed to load data")}finally{M(!1)}},se=d.filter(D=>{var v;return!j||D.name.toLowerCase().includes(j.toLowerCase())||((v=D.description)==null?void 0:v.toLowerCase().includes(j.toLowerCase()))}),X=async D=>{if(confirm("Are you sure you want to delete this kit?"))try{await Oe.deleteKit(D),h.success("Kit deleted successfully"),z()}catch{h.error("Failed to delete kit")}},W=D=>{var v;return((v=D.asset_ids)==null?void 0:v.map(T=>g.find(I=>I.asset_id===T)).filter(Boolean))||[]},Y=D=>{const v=W(D);return{available:v.filter(I=>I.status==="available").length,total:v.length}};return N?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx(Ye,{className:"w-8 h-8 animate-spin text-neofox-yellow"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Equipment Kits"}),n.jsx("p",{className:"text-gray-400",children:"Group equipment into bundles for quick checkout"})]}),n.jsxs("button",{onClick:()=>S(!0),className:"btn-primary flex items-center gap-2",children:[n.jsx($t,{className:"w-5 h-5"}),"Create Kit"]})]}),n.jsxs("div",{className:"relative max-w-md",children:[n.jsx(Ft,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),n.jsx("input",{type:"text",placeholder:"Search kits...",value:j,onChange:D=>p(D.target.value),className:"input-field pl-10"})]}),se.length>0?n.jsx("div",{className:"grid gap-4",children:se.map(D=>{const v=W(D),{available:T,total:I}=Y(D),P=B===D.id,Z=T===I;return n.jsx("div",{className:"card",children:n.jsxs("div",{className:"card-body",children:[n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${Z?"bg-green-500/20":"bg-orange-500/20"}`,children:n.jsx(er,{className:`w-6 h-6 ${Z?"text-green-400":"text-orange-400"}`})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-lg",children:D.name}),n.jsx("p",{className:"text-sm text-gray-400",children:D.description}),n.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[n.jsxs("span",{className:"text-sm text-gray-500",children:[I," items"]}),n.jsxs("span",{className:`text-sm ${Z?"text-green-400":"text-orange-400"}`,children:[T,"/",I," available"]})]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>c(`/checkout?kit=${D.id}`),disabled:!Z,className:`btn-primary text-sm ${Z?"":"opacity-50 cursor-not-allowed"}`,children:"Checkout Kit"}),n.jsx("button",{onClick:()=>Q(D),className:"p-2 hover:bg-neofox-gray rounded-lg transition-colors",children:n.jsx(ho,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>X(D.id),className:"p-2 hover:bg-red-500/20 rounded-lg transition-colors text-red-400",children:n.jsx(gs,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>U(P?null:D.id),className:"p-2 hover:bg-neofox-gray rounded-lg transition-colors",children:P?n.jsx(Ji,{className:"w-4 h-4"}):n.jsx(Sn,{className:"w-4 h-4"})})]})]}),P&&n.jsxs("div",{className:"mt-4 pt-4 border-t border-neofox-gray",children:[n.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-3",children:"Kit Contents"}),n.jsx("div",{className:"grid gap-2",children:v.map(q=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-neofox-darker rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Ee,{className:"w-4 h-4 text-gray-500"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-sm",children:q.asset_name}),n.jsx("p",{className:"text-xs text-gray-500",children:q.asset_id})]})]}),n.jsx("span",{className:`badge ${q.status==="available"?"badge-available":q.status==="checked_out"?"badge-checked-out":"badge-maintenance"}`,children:q.status.replace("_"," ")})]},q.asset_id))})]})]})},D.id)})}):n.jsx("div",{className:"card",children:n.jsxs("div",{className:"card-body text-center py-12",children:[n.jsx(er,{className:"w-12 h-12 text-gray-600 mx-auto mb-4"}),n.jsx("h3",{className:"font-medium text-lg mb-2",children:"No kits created"}),n.jsx("p",{className:"text-gray-400 mb-4",children:"Create kits to group equipment for quick checkout"}),n.jsx("button",{onClick:()=>S(!0),className:"btn-primary",children:"Create Your First Kit"})]})}),(A||F)&&n.jsx(jl,{kit:F,assets:g,onClose:()=>{S(!1),Q(null)},onSave:()=>{S(!1),Q(null),z()}})]})}function jl({kit:c,assets:h,onClose:d,onSave:x}){const g=$e(),[f,N]=R.useState(!1),[M,j]=R.useState(""),[p,A]=R.useState({name:(c==null?void 0:c.name)||"",description:(c==null?void 0:c.description)||"",asset_ids:(c==null?void 0:c.asset_ids)||[]}),S=h.filter(B=>!M||B.asset_name.toLowerCase().includes(M.toLowerCase())||B.asset_id.toLowerCase().includes(M.toLowerCase())),F=B=>{A(U=>({...U,asset_ids:U.asset_ids.includes(B)?U.asset_ids.filter(z=>z!==B):[...U.asset_ids,B]}))},Q=async B=>{if(B.preventDefault(),!p.name.trim()){g.error("Please enter a kit name");return}if(p.asset_ids.length===0){g.error("Please select at least one item");return}N(!0);try{c?(await Oe.updateKit(c.id,p),g.success("Kit updated successfully")):(await Oe.createKit(p),g.success("Kit created successfully")),x()}catch(U){g.error(U.message||"Failed to save kit")}finally{N(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-neofox-dark border border-neofox-gray rounded-xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[n.jsx("div",{className:"p-6 border-b border-neofox-gray",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h2",{className:"text-xl font-bold",children:c?"Edit Kit":"Create Kit"}),n.jsx("button",{onClick:d,className:"p-2 hover:bg-neofox-gray rounded-lg",children:n.jsx(it,{className:"w-5 h-5"})})]})}),n.jsxs("form",{onSubmit:Q,className:"p-6 space-y-6 overflow-y-auto max-h-[calc(90vh-180px)]",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Kit Name *"}),n.jsx("input",{type:"text",value:p.name,onChange:B=>A({...p,name:B.target.value}),className:"input-field",placeholder:"e.g., Interview Kit, Studio A Setup"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Description"}),n.jsx("textarea",{value:p.description,onChange:B=>A({...p,description:B.target.value}),className:"input-field",rows:2,placeholder:"What is this kit used for?"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Select Equipment (",p.asset_ids.length," selected)"]}),n.jsxs("div",{className:"relative mb-3",children:[n.jsx(Ft,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),n.jsx("input",{type:"text",placeholder:"Search equipment...",value:M,onChange:B=>j(B.target.value),className:"input-field pl-10 text-sm"})]}),n.jsx("div",{className:"border border-neofox-gray rounded-lg max-h-64 overflow-y-auto",children:S.map(B=>n.jsxs("label",{className:"flex items-center gap-3 p-3 hover:bg-neofox-gray cursor-pointer border-b border-neofox-gray last:border-0",children:[n.jsx("input",{type:"checkbox",checked:p.asset_ids.includes(B.asset_id),onChange:()=>F(B.asset_id),className:"w-4 h-4 rounded border-neofox-gray text-neofox-yellow focus:ring-neofox-yellow"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-sm",children:B.asset_name}),n.jsxs("p",{className:"text-xs text-gray-500",children:[B.asset_id,"  ",B.category]})]}),n.jsx("span",{className:`badge text-xs ${B.status==="available"?"badge-available":"badge-checked-out"}`,children:B.status.replace("_"," ")})]},B.asset_id))})]})]}),n.jsxs("div",{className:"p-6 border-t border-neofox-gray flex justify-end gap-3",children:[n.jsx("button",{type:"button",onClick:d,className:"btn-secondary",children:"Cancel"}),n.jsx("button",{onClick:Q,disabled:f,className:"btn-primary flex items-center gap-2",children:f?n.jsxs(n.Fragment,{children:[n.jsx(Ye,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):n.jsxs(n.Fragment,{children:[n.jsx(vn,{className:"w-4 h-4"}),c?"Update Kit":"Create Kit"]})})]})]})})}function Il(){const c=es(),h=$e(),[d,x]=R.useState(new Date),[g,f]=R.useState([]),[N,M]=R.useState([]),[j,p]=R.useState(!0),[A,S]=R.useState(null),[F,Q]=R.useState(!1);R.useEffect(()=>{B()},[]);const B=async()=>{try{const[v,T]=await Promise.all([Oe.getReservations(),Oe.getAll()]);f(v.reservations||[]),M(T.assets||[])}catch{h.error("Failed to load data")}finally{p(!1)}},U=Ti(d),z=_i(d),se=Mi({start:U,end:z}),X=U.getDay(),W=[...Array(X).fill(null),...se],Y=v=>v?g.filter(T=>{const I=ge(T.start_date),P=ge(T.end_date);return Ri(v,{start:Br(I),end:Br(P)})}):[],D=async v=>{if(confirm("Cancel this reservation?"))try{await Oe.cancelReservation(v),h.success("Reservation cancelled"),B()}catch{h.error("Failed to cancel reservation")}};return j?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx(Ye,{className:"w-8 h-8 animate-spin text-neofox-yellow"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Equipment Calendar"}),n.jsx("p",{className:"text-gray-400",children:"Reserve equipment in advance"})]}),n.jsxs("button",{onClick:()=>Q(!0),className:"btn-primary flex items-center gap-2",children:[n.jsx($t,{className:"w-5 h-5"}),"New Reservation"]})]}),n.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"lg:col-span-2 card",children:[n.jsxs("div",{className:"card-header flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("button",{onClick:()=>x(Di(d)),className:"p-2 hover:bg-neofox-gray rounded-lg",children:n.jsx(Qi,{className:"w-5 h-5"})}),n.jsx("h2",{className:"text-lg font-semibold",children:ye(d,"MMMM yyyy")}),n.jsx("button",{onClick:()=>x(Oi(d,1)),className:"p-2 hover:bg-neofox-gray rounded-lg",children:n.jsx(Ki,{className:"w-5 h-5"})})]}),n.jsx("button",{onClick:()=>x(new Date),className:"text-sm text-neofox-yellow hover:underline",children:"Today"})]}),n.jsxs("div",{className:"card-body",children:[n.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(v=>n.jsx("div",{className:"text-center text-sm text-gray-500 py-2",children:v},v))}),n.jsx("div",{className:"grid grid-cols-7 gap-1",children:W.map((v,T)=>{if(!v)return n.jsx("div",{className:"h-24 bg-neofox-darker/50 rounded-lg"},`empty-${T}`);const I=Y(v),P=Lr(v,new Date),Z=A&&Lr(v,A);return n.jsxs("button",{onClick:()=>S(v),className:`h-24 p-2 rounded-lg text-left transition-colors ${Z?"ring-2 ring-neofox-yellow":P?"bg-neofox-yellow/10":"bg-neofox-darker hover:bg-neofox-gray"}`,children:[n.jsx("span",{className:`text-sm font-medium ${P?"text-neofox-yellow":"text-gray-300"}`,children:ye(v,"d")}),n.jsxs("div",{className:"mt-1 space-y-1",children:[I.slice(0,2).map(q=>n.jsx("div",{className:`text-xs px-1 py-0.5 rounded truncate ${q.status==="confirmed"?"bg-green-500/20 text-green-400":q.status==="pending"?"bg-yellow-500/20 text-yellow-400":"bg-gray-500/20 text-gray-400"}`,children:q.asset_name||"Reserved"},q.id)),I.length>2&&n.jsxs("div",{className:"text-xs text-gray-500",children:["+",I.length-2," more"]})]})]},v.toISOString())})})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[n.jsx(Nt,{className:"w-5 h-5 text-neofox-yellow"}),A?ye(A,"EEEE, MMMM d"):"Select a Date"]})}),n.jsx("div",{className:"card-body",children:A?n.jsx(n.Fragment,{children:Y(A).length>0?n.jsx("div",{className:"space-y-3",children:Y(A).map(v=>{const T=N.find(I=>I.asset_id===v.asset_id);return n.jsxs("div",{className:"p-3 bg-neofox-darker rounded-lg",children:[n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:(T==null?void 0:T.asset_name)||v.asset_id}),n.jsxs("div",{className:"flex items-center gap-2 mt-1 text-sm text-gray-400",children:[n.jsx(Rt,{className:"w-3 h-3"}),v.reserved_by]}),n.jsxs("div",{className:"flex items-center gap-2 mt-1 text-sm text-gray-400",children:[n.jsx(ns,{className:"w-3 h-3"}),ye(ge(v.start_date),"MMM d")," - ",ye(ge(v.end_date),"MMM d")]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:`badge text-xs ${v.status==="confirmed"?"badge-available":v.status==="pending"?"bg-yellow-500/20 text-yellow-400":"badge-maintenance"}`,children:v.status}),v.status!=="cancelled"&&n.jsx("button",{onClick:()=>D(v.id),className:"p-1 hover:bg-red-500/20 rounded text-red-400",children:n.jsx(it,{className:"w-4 h-4"})})]})]}),v.purpose&&n.jsx("p",{className:"mt-2 text-sm text-gray-400 border-t border-neofox-gray pt-2",children:v.purpose})]},v.id)})}):n.jsxs("div",{className:"text-center py-8 text-gray-500",children:[n.jsx(Nt,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{children:"No reservations for this date"}),n.jsx("button",{onClick:()=>Q(!0),className:"mt-3 text-sm text-neofox-yellow hover:underline",children:"Create reservation"})]})}):n.jsxs("div",{className:"text-center py-8 text-gray-500",children:[n.jsx(Nt,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{children:"Click on a date to see reservations"})]})})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsx("h3",{className:"font-semibold",children:"Upcoming Reservations"})}),n.jsxs("div",{className:"overflow-x-auto",children:[n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-neofox-gray",children:[n.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Equipment"}),n.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Reserved By"}),n.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Dates"}),n.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Purpose"}),n.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Status"}),n.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Actions"})]})}),n.jsx("tbody",{children:g.filter(v=>v.status!=="cancelled"&&ge(v.end_date)>=new Date).sort((v,T)=>ge(v.start_date)-ge(T.start_date)).slice(0,10).map(v=>{const T=N.find(I=>I.asset_id===v.asset_id);return n.jsxs("tr",{className:"border-b border-neofox-gray hover:bg-neofox-darker",children:[n.jsx("td",{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Ee,{className:"w-4 h-4 text-gray-500"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:(T==null?void 0:T.asset_name)||v.asset_id}),n.jsx("p",{className:"text-xs text-gray-500",children:v.asset_id})]})]})}),n.jsx("td",{className:"p-4 text-gray-300",children:v.reserved_by}),n.jsxs("td",{className:"p-4 text-gray-300",children:[ye(ge(v.start_date),"MMM d")," - ",ye(ge(v.end_date),"MMM d, yyyy")]}),n.jsx("td",{className:"p-4 text-gray-400 max-w-xs truncate",children:v.purpose||"-"}),n.jsx("td",{className:"p-4",children:n.jsx("span",{className:`badge ${v.status==="confirmed"?"badge-available":v.status==="pending"?"bg-yellow-500/20 text-yellow-400":"badge-maintenance"}`,children:v.status})}),n.jsx("td",{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-2",children:[v.status==="confirmed"&&n.jsx("button",{onClick:()=>c(`/checkout?asset=${v.asset_id}`),className:"text-xs text-neofox-yellow hover:underline",children:"Checkout"}),n.jsx("button",{onClick:()=>D(v.id),className:"text-xs text-red-400 hover:underline",children:"Cancel"})]})})]},v.id)})})]}),g.filter(v=>v.status!=="cancelled").length===0&&n.jsx("div",{className:"text-center py-8 text-gray-500",children:"No upcoming reservations"})]})]}),F&&n.jsx(Tl,{assets:N,reservations:g,selectedDate:A,onClose:()=>Q(!1),onSave:()=>{Q(!1),B()}})]})}function Tl({assets:c,reservations:h,selectedDate:d,onClose:x,onSave:g}){const f=$e(),[N,M]=R.useState(!1),[j,p]=R.useState(""),[A,S]=R.useState({asset_id:"",reserved_by:"",start_date:d?ye(d,"yyyy-MM-dd"):ye(new Date,"yyyy-MM-dd"),end_date:d?ye(yn(d,1),"yyyy-MM-dd"):ye(yn(new Date,1),"yyyy-MM-dd"),purpose:""}),F=c.filter(z=>z.status==="available"&&(!j||z.asset_name.toLowerCase().includes(j.toLowerCase())||z.asset_id.toLowerCase().includes(j.toLowerCase()))),B=(()=>{if(!A.asset_id||!A.start_date||!A.end_date)return!1;const z=ge(A.start_date),se=ge(A.end_date);return h.some(X=>{if(X.asset_id!==A.asset_id||X.status==="cancelled")return!1;const W=ge(X.start_date),Y=ge(X.end_date);return z<=Y&&se>=W})})(),U=async z=>{if(z.preventDefault(),!A.asset_id){f.error("Please select equipment");return}if(!A.reserved_by.trim()){f.error("Please enter who is reserving");return}if(B){f.error("This equipment is already reserved for these dates");return}M(!0);try{await Oe.createReservation(A),f.success("Reservation created successfully"),g()}catch(se){f.error(se.message||"Failed to create reservation")}finally{M(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-neofox-dark border border-neofox-gray rounded-xl w-full max-w-lg",children:[n.jsx("div",{className:"p-6 border-b border-neofox-gray",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h2",{className:"text-xl font-bold",children:"New Reservation"}),n.jsx("button",{onClick:x,className:"p-2 hover:bg-neofox-gray rounded-lg",children:n.jsx(it,{className:"w-5 h-5"})})]})}),n.jsxs("form",{onSubmit:U,className:"p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Equipment *"}),n.jsxs("select",{value:A.asset_id,onChange:z=>S({...A,asset_id:z.target.value}),className:"input-field",children:[n.jsx("option",{value:"",children:"Select equipment..."}),F.map(z=>n.jsxs("option",{value:z.asset_id,children:[z.asset_name," (",z.asset_id,")"]},z.asset_id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Reserved By *"}),n.jsx("input",{type:"text",value:A.reserved_by,onChange:z=>S({...A,reserved_by:z.target.value}),className:"input-field",placeholder:"Team member name"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Date *"}),n.jsx("input",{type:"date",value:A.start_date,onChange:z=>S({...A,start_date:z.target.value}),className:"input-field"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"End Date *"}),n.jsx("input",{type:"date",value:A.end_date,onChange:z=>S({...A,end_date:z.target.value}),className:"input-field",min:A.start_date})]})]}),B&&n.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:[n.jsx(En,{className:"w-4 h-4"}),"This equipment is already reserved for these dates"]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Purpose"}),n.jsx("textarea",{value:A.purpose,onChange:z=>S({...A,purpose:z.target.value}),className:"input-field",rows:2,placeholder:"What will this be used for?"})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:x,className:"btn-secondary",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:N||B,className:"btn-primary flex items-center gap-2",children:N?n.jsxs(n.Fragment,{children:[n.jsx(Ye,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):n.jsxs(n.Fragment,{children:[n.jsx(vn,{className:"w-4 h-4"}),"Create Reservation"]})})]})]})]})})}const la={checkout:ms,checkin:Fs,create:$t,update:en,delete:gs,photo_upload:Gt,reservation:Nt,default:or},ca={checkout:"text-orange-400 bg-orange-500/20",checkin:"text-green-400 bg-green-500/20",create:"text-blue-400 bg-blue-500/20",update:"text-yellow-400 bg-yellow-500/20",delete:"text-red-400 bg-red-500/20",photo_upload:"text-purple-400 bg-purple-500/20",reservation:"text-cyan-400 bg-cyan-500/20",default:"text-gray-400 bg-gray-500/20"};function _l(){const c=$e(),[h,d]=R.useState([]),[x,g]=R.useState(!0),[f,N]=R.useState(""),[M,j]=R.useState({action:"",user:"",dateFrom:"",dateTo:""}),[p,A]=R.useState(!1),[S,F]=R.useState(1),[Q,B]=R.useState(!0);R.useEffect(()=>{U()},[M]);const U=async(D=!1)=>{try{D||g(!0);const T=(await Oe.getAuditLog({...M,page:D?S:1,limit:50})).logs||[];D?d(I=>[...I,...T]):(d(T),F(1)),B(T.length===50)}catch{c.error("Failed to load audit log")}finally{g(!1)}},z=()=>{F(D=>D+1),U(!0)},se=h.filter(D=>{var v,T,I,P;return!f||((v=D.description)==null?void 0:v.toLowerCase().includes(f.toLowerCase()))||((T=D.user_name)==null?void 0:T.toLowerCase().includes(f.toLowerCase()))||((I=D.asset_id)==null?void 0:I.toLowerCase().includes(f.toLowerCase()))||((P=D.asset_name)==null?void 0:P.toLowerCase().includes(f.toLowerCase()))}),X=[...new Set(h.map(D=>D.user_name).filter(Boolean))],W=[...new Set(h.map(D=>D.action).filter(Boolean))],Y=()=>{const D=[["Timestamp","Action","User","Asset ID","Asset Name","Description","IP Address"].join(","),...se.map(P=>[P.timestamp,P.action,P.user_name||"",P.asset_id||"",P.asset_name||"",`"${(P.description||"").replace(/"/g,'""')}"`,P.ip_address||""].join(","))].join(`
`),v=new Blob([D],{type:"text/csv"}),T=URL.createObjectURL(v),I=document.createElement("a");I.href=T,I.download=`audit-log-${ye(new Date,"yyyy-MM-dd")}.csv`,I.click()};return x&&h.length===0?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx(Ye,{className:"w-8 h-8 animate-spin text-neofox-yellow"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Audit Log"}),n.jsx("p",{className:"text-gray-400",children:"Complete history of all system actions"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:()=>U(),className:"btn-secondary flex items-center gap-2",children:[n.jsx(dr,{className:"w-4 h-4"}),"Refresh"]}),n.jsxs("button",{onClick:Y,className:"btn-primary flex items-center gap-2",children:[n.jsx($s,{className:"w-4 h-4"}),"Export CSV"]})]})]}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"card-body space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(Ft,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),n.jsx("input",{type:"text",placeholder:"Search by user, asset, or description...",value:f,onChange:D=>N(D.target.value),className:"input-field pl-10"})]}),n.jsxs("button",{onClick:()=>A(!p),className:`btn-secondary flex items-center gap-2 ${p?"bg-neofox-gray":""}`,children:[n.jsx(Ea,{className:"w-4 h-4"}),"Filters",n.jsx(Sn,{className:`w-4 h-4 transition-transform ${p?"rotate-180":""}`})]})]}),p&&n.jsxs("div",{className:"grid md:grid-cols-4 gap-4 pt-4 border-t border-neofox-gray",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Action Type"}),n.jsxs("select",{value:M.action,onChange:D=>j({...M,action:D.target.value}),className:"input-field",children:[n.jsx("option",{value:"",children:"All Actions"}),W.map(D=>n.jsx("option",{value:D,children:D},D))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"User"}),n.jsxs("select",{value:M.user,onChange:D=>j({...M,user:D.target.value}),className:"input-field",children:[n.jsx("option",{value:"",children:"All Users"}),X.map(D=>n.jsx("option",{value:D,children:D},D))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"From Date"}),n.jsx("input",{type:"date",value:M.dateFrom,onChange:D=>j({...M,dateFrom:D.target.value}),className:"input-field"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"To Date"}),n.jsx("input",{type:"date",value:M.dateTo,onChange:D=>j({...M,dateTo:D.target.value}),className:"input-field"})]})]})]})}),n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"card-header flex items-center justify-between",children:[n.jsx("h3",{className:"font-semibold",children:"Activity Log"}),n.jsxs("span",{className:"text-sm text-gray-400",children:[se.length," entries"]})]}),n.jsx("div",{className:"divide-y divide-neofox-gray",children:se.map((D,v)=>{const T=la[D.action]||la.default,I=ca[D.action]||ca.default;return n.jsx("div",{className:"p-4 hover:bg-neofox-darker transition-colors",children:n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${I}`,children:n.jsx(T,{className:"w-5 h-5"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-start justify-between gap-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:D.description}),n.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-400",children:[D.user_name&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(Rt,{className:"w-3 h-3"}),D.user_name]}),D.asset_id&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(Ee,{className:"w-3 h-3"}),D.asset_name||D.asset_id]})]})]}),n.jsxs("div",{className:"text-right text-sm text-gray-500 whitespace-nowrap",children:[n.jsx("p",{children:ye(ge(D.timestamp),"MMM d, yyyy")}),n.jsx("p",{children:ye(ge(D.timestamp),"h:mm a")})]})]}),D.details&&n.jsx("div",{className:"mt-2 p-2 bg-neofox-darker rounded text-sm text-gray-400",children:n.jsx("pre",{className:"whitespace-pre-wrap font-mono text-xs",children:typeof D.details=="string"?D.details:JSON.stringify(D.details,null,2)})})]})]})},D.id||v)})}),se.length===0&&n.jsxs("div",{className:"p-8 text-center text-gray-500",children:[n.jsx(or,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:"No log entries found"})]}),Q&&n.jsx("div",{className:"p-4 text-center border-t border-neofox-gray",children:n.jsx("button",{onClick:z,className:"text-neofox-yellow hover:underline",children:"Load more entries"})})]})]})}function Ml(){const c=es(),h=$e(),[d,x]=R.useState([]),[g,f]=R.useState([]),[N,M]=R.useState(!0),[j,p]=R.useState(""),[A,S]=R.useState("all"),[F,Q]=R.useState("status"),[B,U]=R.useState(new Date);R.useEffect(()=>{z();const v=setInterval(z,6e4);return()=>clearInterval(v)},[]);const z=async()=>{try{const[v,T]=await Promise.all([Oe.getAll(),Oe.getUsers()]);x(v.assets||[]),f(T.users||[]),U(new Date)}catch{h.error("Failed to load data")}finally{M(!1)}},se=v=>{const T=g.find(I=>{var P,Z;return((P=I.username)==null?void 0:P.toLowerCase())===(v==null?void 0:v.toLowerCase())||((Z=I.name)==null?void 0:Z.toLowerCase())===(v==null?void 0:v.toLowerCase())});return(T==null?void 0:T.phone)||null},X=(v,T)=>{const I=se(v);if(!I)return null;const P=I.replace(/[^0-9]/g,""),Z=T.map(J=>`- ${J.asset_name} (${J.asset_id})`).join(`
`),q=encodeURIComponent(`Hi ${v},

This is a reminder about the following equipment currently checked out to you:

${Z}

Please ensure timely return. Thank you!`);return`https://wa.me/${P}?text=${q}`};let W=d.filter(v=>{var T,I;if(j){const P=j.toLowerCase();if(!v.asset_name.toLowerCase().includes(P)&&!v.asset_id.toLowerCase().includes(P)&&!((T=v.current_borrower)!=null&&T.toLowerCase().includes(P))&&!((I=v.category)!=null&&I.toLowerCase().includes(P)))return!1}switch(A){case"out":return v.status==="checked_out";case"available":return v.status==="available";case"overdue":return v.status==="checked_out"&&v.expected_return_date&&As(ge(v.expected_return_date));default:return!0}});W.sort((v,T)=>{switch(F){case"name":return v.asset_name.localeCompare(T.asset_name);case"borrower":return(v.current_borrower||"").localeCompare(T.current_borrower||"");case"date":return v.checkout_date?T.checkout_date?ge(T.checkout_date)-ge(v.checkout_date):-1:1;default:const I={checked_out:0,maintenance:1,available:2};return(I[v.status]||3)-(I[T.status]||3)}});const Y=W.filter(v=>v.status==="checked_out").reduce((v,T)=>{const I=T.current_borrower||"Unknown";return v[I]||(v[I]=[]),v[I].push(T),v},{}),D={total:d.length,available:d.filter(v=>v.status==="available").length,checkedOut:d.filter(v=>v.status==="checked_out").length,overdue:d.filter(v=>v.status==="checked_out"&&v.expected_return_date&&As(ge(v.expected_return_date))).length,maintenance:d.filter(v=>v.status==="maintenance").length};return N?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx(Ye,{className:"w-8 h-8 animate-spin text-neofox-yellow"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Equipment Status"}),n.jsxs("p",{className:"text-gray-400",children:["Real-time view of all equipment  Last updated ",ye(B,"h:mm:ss a")]})]}),n.jsxs("button",{onClick:z,className:"btn-secondary flex items-center gap-2",children:[n.jsx(dr,{className:"w-4 h-4"}),"Refresh"]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[n.jsxs("button",{onClick:()=>S("all"),className:`card p-4 text-left transition-all ${A==="all"?"ring-2 ring-neofox-yellow":""}`,children:[n.jsx("p",{className:"text-3xl font-bold",children:D.total}),n.jsx("p",{className:"text-sm text-gray-400",children:"Total Equipment"})]}),n.jsxs("button",{onClick:()=>S("available"),className:`card p-4 text-left transition-all ${A==="available"?"ring-2 ring-green-500":""}`,children:[n.jsx("p",{className:"text-3xl font-bold text-green-400",children:D.available}),n.jsx("p",{className:"text-sm text-gray-400",children:"Available"})]}),n.jsxs("button",{onClick:()=>S("out"),className:`card p-4 text-left transition-all ${A==="out"?"ring-2 ring-orange-500":""}`,children:[n.jsx("p",{className:"text-3xl font-bold text-orange-400",children:D.checkedOut}),n.jsx("p",{className:"text-sm text-gray-400",children:"Checked Out"})]}),n.jsxs("button",{onClick:()=>S("overdue"),className:`card p-4 text-left transition-all ${A==="overdue"?"ring-2 ring-red-500":""}`,children:[n.jsx("p",{className:"text-3xl font-bold text-red-400",children:D.overdue}),n.jsx("p",{className:"text-sm text-gray-400",children:"Overdue"})]}),n.jsxs("div",{className:"card p-4",children:[n.jsx("p",{className:"text-3xl font-bold text-yellow-400",children:D.maintenance}),n.jsx("p",{className:"text-sm text-gray-400",children:"Maintenance"})]})]}),n.jsx("div",{className:"card",children:n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-4",children:[n.jsxs("div",{className:"flex-1 relative w-full",children:[n.jsx(Ft,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),n.jsx("input",{type:"text",placeholder:"Search by name, ID, borrower, or category...",value:j,onChange:v=>p(v.target.value),className:"input-field pl-10"})]}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsxs("select",{value:F,onChange:v=>Q(v.target.value),className:"input-field",children:[n.jsx("option",{value:"status",children:"Sort by Status"}),n.jsx("option",{value:"name",children:"Sort by Name"}),n.jsx("option",{value:"borrower",children:"Sort by Borrower"}),n.jsx("option",{value:"date",children:"Sort by Checkout Date"})]})})]})})}),(A==="out"||A==="overdue")&&Object.keys(Y).length>0&&n.jsxs("div",{className:"space-y-4",children:[n.jsx("h2",{className:"text-lg font-semibold",children:"By Team Member"}),Object.entries(Y).sort((v,T)=>T[1].length-v[1].length).map(([v,T])=>{const I=T.some(Z=>Z.expected_return_date&&As(ge(Z.expected_return_date))),P=X(v,T);return n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"card-header flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${I?"bg-red-500/20":"bg-neofox-yellow/20"}`,children:n.jsx(Rt,{className:`w-5 h-5 ${I?"text-red-400":"text-neofox-yellow"}`})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold",children:v}),n.jsxs("p",{className:"text-sm text-gray-400",children:[T.length," items checked out"]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[P&&n.jsxs("a",{href:P,target:"_blank",rel:"noopener noreferrer",className:"btn-secondary flex items-center gap-2 text-green-400 border-green-500/30 hover:bg-green-500/10",children:[n.jsx(Sa,{className:"w-4 h-4"}),"WhatsApp"]}),I&&n.jsxs("span",{className:"badge bg-red-500/20 text-red-400",children:[n.jsx(xs,{className:"w-3 h-3 mr-1"}),"Has Overdue"]})]})]}),n.jsx("div",{className:"divide-y divide-neofox-gray",children:T.map(Z=>{const q=Z.expected_return_date&&As(ge(Z.expected_return_date)),J=Z.checkout_date?ki(new Date,ge(Z.checkout_date)):0;return n.jsx("div",{className:"p-4 hover:bg-neofox-darker cursor-pointer transition-colors",onClick:()=>c(`/assets/${Z.asset_id}`),children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Ee,{className:"w-5 h-5 text-gray-500"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:Z.asset_name}),n.jsxs("p",{className:"text-sm text-gray-500",children:[Z.asset_id,"  ",Z.category]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("div",{className:"flex items-center gap-2",children:q?n.jsx("span",{className:"badge bg-red-500/20 text-red-400",children:"Overdue"}):n.jsxs("span",{className:"text-sm text-gray-400",children:[J," days out"]})}),Z.expected_return_date&&n.jsxs("p",{className:`text-xs mt-1 ${q?"text-red-400":"text-gray-500"}`,children:["Due: ",ye(ge(Z.expected_return_date),"MMM d, yyyy")]})]})]})},Z.asset_id)})})]},v)})]}),A!=="out"&&A!=="overdue"&&n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-neofox-gray",children:[n.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Equipment"}),n.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Category"}),n.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Status"}),n.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Current Holder"}),n.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Checkout Date"}),n.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Due Date"}),n.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Actions"})]})}),n.jsx("tbody",{children:W.map(v=>{const T=v.status==="checked_out"&&v.expected_return_date&&As(ge(v.expected_return_date));return n.jsxs("tr",{className:"border-b border-neofox-gray hover:bg-neofox-darker cursor-pointer",onClick:()=>c(`/assets/${v.asset_id}`),children:[n.jsx("td",{className:"p-4",children:n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:v.asset_name}),n.jsx("p",{className:"text-xs text-gray-500 font-mono",children:v.asset_id})]})}),n.jsx("td",{className:"p-4 text-gray-400",children:v.category}),n.jsx("td",{className:"p-4",children:n.jsx("span",{className:`badge ${v.status==="available"?"badge-available":v.status==="checked_out"?T?"bg-red-500/20 text-red-400":"badge-checked-out":"badge-maintenance"}`,children:T?"Overdue":v.status.replace("_"," ")})}),n.jsx("td",{className:"p-4",children:v.current_borrower?n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Rt,{className:"w-4 h-4 text-gray-500"}),n.jsx("span",{children:v.current_borrower})]}):n.jsx("span",{className:"text-gray-500",children:"-"})}),n.jsx("td",{className:"p-4 text-gray-400",children:v.checkout_date?ye(ge(v.checkout_date),"MMM d, yyyy"):"-"}),n.jsx("td",{className:"p-4",children:v.expected_return_date?n.jsx("span",{className:T?"text-red-400 font-medium":"text-gray-400",children:ye(ge(v.expected_return_date),"MMM d, yyyy")}):"-"}),n.jsx("td",{className:"p-4",children:n.jsx("div",{className:"flex items-center gap-2",onClick:I=>I.stopPropagation(),children:v.status==="available"?n.jsxs("button",{onClick:()=>c(`/checkout?asset=${v.asset_id}`),className:"text-xs text-neofox-yellow hover:underline flex items-center gap-1",children:[n.jsx(ms,{className:"w-3 h-3"}),"Checkout"]}):v.status==="checked_out"?n.jsxs("button",{onClick:()=>c(`/checkin?asset=${v.asset_id}`),className:"text-xs text-green-400 hover:underline flex items-center gap-1",children:[n.jsx(Fs,{className:"w-3 h-3"}),"Check In"]}):null})})]},v.asset_id)})})]})}),W.length===0&&n.jsxs("div",{className:"p-8 text-center text-gray-500",children:[n.jsx(Ee,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:"No equipment found"})]})]})]})}function Dl(){var X;const c=ha(),h=es(),d=$e(),x=(X=c.state)==null?void 0:X.checkoutData,[g,f]=R.useState({manager:null,borrower:null}),[N,M]=R.useState(null);R.useEffect(()=>{x||h("/checkout")},[x,h]);const j=()=>{window.print()},p=()=>{window.print(),d.success('Use "Save as PDF" in the print dialog')},A=()=>{d.success("Checkout completed successfully!"),h("/assets")};if(!x)return null;const{asset:S,borrower:F,returnDate:Q,purpose:B,project:U,notes:z,transactionId:se}=x;return n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6 print:hidden",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("button",{onClick:()=>h(-1),className:"p-2 hover:bg-neofox-gray rounded-lg transition-colors",children:n.jsx(vs,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Checkout Receipt"}),n.jsx("p",{className:"text-gray-400",children:"Review and sign to complete checkout"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:j,className:"btn-secondary flex items-center gap-2",children:[n.jsx(uo,{className:"w-4 h-4"}),"Print"]}),n.jsxs("button",{onClick:p,className:"btn-primary flex items-center gap-2",children:[n.jsx($s,{className:"w-4 h-4"}),"Save PDF"]})]})]}),n.jsxs("div",{className:"bg-white text-black rounded-xl overflow-hidden print:rounded-none print:shadow-none",id:"receipt",children:[n.jsx("div",{className:"bg-gradient-to-r from-gray-900 to-gray-800 text-white p-8 print:bg-black",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-yellow-400",children:"FOXY"}),n.jsx("p",{className:"text-gray-300 text-sm",children:"NeoFox Media Equipment Management"})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-2xl font-bold",children:"EQUIPMENT CHECKOUT"}),n.jsxs("p",{className:"text-gray-300",children:["Receipt #",se||"TXN-"+Date.now()]})]})]})}),n.jsxs("div",{className:"p-8 space-y-8",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase mb-3",children:"Transaction Details"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Nt,{className:"w-4 h-4 text-gray-400"}),n.jsx("span",{className:"text-gray-600",children:"Date:"}),n.jsx("span",{className:"font-medium",children:ye(new Date,"MMMM d, yyyy h:mm a")})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Nt,{className:"w-4 h-4 text-gray-400"}),n.jsx("span",{className:"text-gray-600",children:"Expected Return:"}),n.jsx("span",{className:"font-medium",children:ye(new Date(Q),"MMMM d, yyyy")})]}),U&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Na,{className:"w-4 h-4 text-gray-400"}),n.jsx("span",{className:"text-gray-600",children:"Project:"}),n.jsx("span",{className:"font-medium",children:U})]})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase mb-3",children:"Borrower Information"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Rt,{className:"w-4 h-4 text-gray-400"}),n.jsx("span",{className:"text-gray-600",children:"Name:"}),n.jsx("span",{className:"font-medium",children:F})]}),B&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Aa,{className:"w-4 h-4 text-gray-400"}),n.jsx("span",{className:"text-gray-600",children:"Purpose:"}),n.jsx("span",{className:"font-medium",children:B})]})]})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase mb-3",children:"Equipment Details"}),n.jsxs("table",{className:"w-full border border-gray-200 rounded-lg overflow-hidden",children:[n.jsx("thead",{className:"bg-gray-100",children:n.jsxs("tr",{children:[n.jsx("th",{className:"text-left p-3 text-sm font-semibold text-gray-600",children:"Asset ID"}),n.jsx("th",{className:"text-left p-3 text-sm font-semibold text-gray-600",children:"Equipment Name"}),n.jsx("th",{className:"text-left p-3 text-sm font-semibold text-gray-600",children:"Category"}),n.jsx("th",{className:"text-left p-3 text-sm font-semibold text-gray-600",children:"Serial Number"}),n.jsx("th",{className:"text-left p-3 text-sm font-semibold text-gray-600",children:"Location"})]})}),n.jsx("tbody",{children:(Array.isArray(S)?S:[S]).map((W,Y)=>n.jsxs("tr",{className:"border-t border-gray-200",children:[n.jsx("td",{className:"p-3 font-mono text-sm",children:W.asset_id}),n.jsx("td",{className:"p-3 font-medium",children:W.asset_name}),n.jsx("td",{className:"p-3 text-gray-600",children:W.category}),n.jsx("td",{className:"p-3 font-mono text-sm text-gray-600",children:W.serial_number||"-"}),n.jsx("td",{className:"p-3 text-gray-600",children:W.location||"-"})]},Y))})]})]}),z&&n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase mb-2",children:"Notes"}),n.jsx("p",{className:"text-gray-600 bg-gray-50 p-3 rounded-lg",children:z})]}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg text-sm text-gray-600",children:[n.jsx("h4",{className:"font-semibold text-gray-700 mb-2",children:"Terms & Conditions"}),n.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[n.jsx("li",{children:"Equipment must be returned by the expected return date"}),n.jsx("li",{children:"Any damage must be reported immediately"}),n.jsx("li",{children:"Equipment is for authorized use only"}),n.jsx("li",{children:"Borrower is responsible for the equipment until returned"})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-8 pt-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase mb-3",children:"Equipment Manager Signature"}),n.jsx(da,{signature:g.manager,onSave:W=>f({...g,manager:W}),onClear:()=>f({...g,manager:null}),label:"Equipment Manager"})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase mb-3",children:"Borrower Signature"}),n.jsx(da,{signature:g.borrower,onSave:W=>f({...g,borrower:W}),onClear:()=>f({...g,borrower:null}),label:"Borrower"})]})]}),n.jsxs("div",{className:"text-center text-sm text-gray-500 pt-4 border-t border-gray-200",children:[n.jsx("p",{children:"NeoFox Media  Equipment Management System"}),n.jsxs("p",{children:["Generated on ",ye(new Date,"MMMM d, yyyy h:mm:ss a")]})]})]})]}),n.jsxs("div",{className:"mt-6 flex justify-end gap-3 print:hidden",children:[n.jsx("button",{onClick:()=>h("/checkout"),className:"btn-secondary",children:"New Checkout"}),n.jsxs("button",{onClick:A,disabled:!g.manager||!g.borrower,className:"btn-primary flex items-center gap-2 disabled:opacity-50",children:[n.jsx(vn,{className:"w-4 h-4"}),"Complete & Save"]})]}),n.jsx("style",{children:`
        @media print {
          body * {
            visibility: hidden;
          }
          #receipt, #receipt * {
            visibility: visible;
          }
          #receipt {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
          }
          .print\\:hidden {
            display: none !important;
          }
        }
      `})]})}function da({signature:c,onSave:h,onClear:d,label:x}){const g=R.useRef(null),[f,N]=R.useState(!1),[M,j]=R.useState(!1);R.useEffect(()=>{const B=g.current;if(B&&c){const U=B.getContext("2d"),z=new Image;z.onload=()=>{U.drawImage(z,0,0)},z.src=c}},[c]);const p=B=>{var Y,D,v,T;const U=g.current,z=U.getContext("2d"),se=U.getBoundingClientRect(),X=(B.clientX||((D=(Y=B.touches)==null?void 0:Y[0])==null?void 0:D.clientX))-se.left,W=(B.clientY||((T=(v=B.touches)==null?void 0:v[0])==null?void 0:T.clientY))-se.top;z.beginPath(),z.moveTo(X,W),N(!0),j(!0)},A=B=>{var Y,D,v,T;if(!f)return;const U=g.current,z=U.getContext("2d"),se=U.getBoundingClientRect(),X=(B.clientX||((D=(Y=B.touches)==null?void 0:Y[0])==null?void 0:D.clientX))-se.left,W=(B.clientY||((T=(v=B.touches)==null?void 0:v[0])==null?void 0:T.clientY))-se.top;z.lineWidth=2,z.lineCap="round",z.strokeStyle="#000",z.lineTo(X,W),z.stroke()},S=()=>{N(!1)},F=()=>{const B=g.current;B.getContext("2d").clearRect(0,0,B.width,B.height),j(!1),d()},Q=()=>{const U=g.current.toDataURL("image/png");h(U)};return n.jsxs("div",{className:"print:border-0",children:[c?n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:c,alt:x,className:"w-full h-32 border border-gray-300 rounded-lg bg-white"}),n.jsx("button",{onClick:d,className:"absolute top-2 right-2 p-1 bg-red-100 text-red-600 rounded hover:bg-red-200 print:hidden",children:n.jsx(it,{className:"w-4 h-4"})}),n.jsx("p",{className:"text-center text-sm text-gray-500 mt-2",children:x})]}):n.jsxs("div",{className:"space-y-2 print:hidden",children:[n.jsx("canvas",{ref:g,width:300,height:120,className:"w-full h-32 border-2 border-dashed border-gray-300 rounded-lg bg-white cursor-crosshair touch-none",onMouseDown:p,onMouseMove:A,onMouseUp:S,onMouseLeave:S,onTouchStart:p,onTouchMove:A,onTouchEnd:S}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Sign above"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:F,className:"text-sm text-gray-500 hover:text-gray-700 flex items-center gap-1",children:[n.jsx(to,{className:"w-3 h-3"}),"Clear"]}),n.jsxs("button",{onClick:Q,disabled:!M,className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1 disabled:opacity-50",children:[n.jsx(vn,{className:"w-3 h-3"}),"Confirm"]})]})]})]}),!c&&n.jsx("div",{className:"hidden print:block border-b-2 border-black h-16 mt-4",children:n.jsx("p",{className:"text-sm text-gray-500 mt-2",children:x})})]})}function Ol(){const[c,h]=R.useState(!0),[d,x]=R.useState([]),[g,f]=R.useState([]),[N,M]=R.useState("30"),j=$e();R.useEffect(()=>{p()},[]);const p=async()=>{try{const[D,v]=await Promise.all([Oe.getAll(),rr.getAll()]);x(D.assets||[]),f(v.transactions||[])}catch{j.error("Failed to load analytics data")}finally{h(!1)}},A=g.filter(D=>{const v=ge(D.transaction_date),T=Pr(new Date,parseInt(N));return v>=T}),S={totalCheckouts:A.filter(D=>D.transaction_type==="checkout").length,totalCheckins:A.filter(D=>D.transaction_type==="checkin").length,activeCheckouts:d.filter(D=>D.status==="checked_out").length,availableEquipment:d.filter(D=>D.status==="available").length},F={};A.filter(D=>D.transaction_type==="checkout").forEach(D=>{F[D.asset_id]||(F[D.asset_id]={count:0,name:D.asset_name||D.asset_id}),F[D.asset_id].count++});const Q=Object.entries(F).map(([D,v])=>({id:D,...v})).sort((D,v)=>v.count-D.count).slice(0,10),B={};A.filter(D=>D.transaction_type==="checkout").forEach(D=>{const v=D.borrower_name||"Unknown";B[v]||(B[v]=0),B[v]++});const U=Object.entries(B).map(([D,v])=>({name:D,count:v})).sort((D,v)=>v.count-D.count).slice(0,10),z={};A.filter(D=>D.transaction_type==="checkout").forEach(D=>{const v=d.find(I=>I.asset_id===D.asset_id),T=(v==null?void 0:v.category)||"Other";z[T]||(z[T]=0),z[T]++});const se=Object.entries(z).map(([D,v])=>({category:D,count:v})).sort((D,v)=>v.count-D.count),X={};for(let D=parseInt(N)-1;D>=0;D--){const v=ye(Pr(new Date,D),"yyyy-MM-dd");X[v]={checkouts:0,checkins:0}}A.forEach(D=>{const v=ye(ge(D.transaction_date),"yyyy-MM-dd");X[v]&&(D.transaction_type==="checkout"?X[v].checkouts++:X[v].checkins++)});const W=Math.max(...Object.values(X).map(D=>Math.max(D.checkouts,D.checkins)),1),Y=d.length>0?Math.round(S.activeCheckouts/d.length*100):0;return c?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx(Ye,{className:"w-8 h-8 animate-spin text-neofox-yellow"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Usage Analytics"}),n.jsx("p",{className:"text-gray-400",children:"Equipment usage statistics and trends"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ea,{className:"w-4 h-4 text-gray-400"}),n.jsxs("select",{value:N,onChange:D=>M(D.target.value),className:"select-field w-auto",children:[n.jsx("option",{value:"7",children:"Last 7 days"}),n.jsx("option",{value:"30",children:"Last 30 days"}),n.jsx("option",{value:"90",children:"Last 90 days"}),n.jsx("option",{value:"365",children:"Last 12 months"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[n.jsx("div",{className:"card",children:n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Total Checkouts"}),n.jsx("p",{className:"text-3xl font-bold text-neofox-yellow mt-1",children:S.totalCheckouts})]}),n.jsx("div",{className:"p-3 bg-yellow-500/20 rounded-lg",children:n.jsx(Ta,{className:"w-6 h-6 text-yellow-400"})})]})})}),n.jsx("div",{className:"card",children:n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Total Check-ins"}),n.jsx("p",{className:"text-3xl font-bold text-green-400 mt-1",children:S.totalCheckins})]}),n.jsx("div",{className:"p-3 bg-green-500/20 rounded-lg",children:n.jsx(Zi,{className:"w-6 h-6 text-green-400"})})]})})}),n.jsx("div",{className:"card",children:n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Currently Out"}),n.jsx("p",{className:"text-3xl font-bold text-orange-400 mt-1",children:S.activeCheckouts})]}),n.jsx("div",{className:"p-3 bg-orange-500/20 rounded-lg",children:n.jsx(Ee,{className:"w-6 h-6 text-orange-400"})})]})})}),n.jsx("div",{className:"card",children:n.jsx("div",{className:"card-body",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Utilization Rate"}),n.jsxs("p",{className:"text-3xl font-bold text-blue-400 mt-1",children:[Y,"%"]})]}),n.jsx("div",{className:"p-3 bg-blue-500/20 rounded-lg",children:n.jsx($n,{className:"w-6 h-6 text-blue-400"})})]})})})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[n.jsx(Nt,{className:"w-5 h-5 text-neofox-yellow"}),"Daily Activity"]})}),n.jsxs("div",{className:"card-body",children:[n.jsx("div",{className:"flex items-end gap-1 h-48 overflow-x-auto pb-6",children:Object.entries(X).map(([D,v],T)=>n.jsxs("div",{className:"flex flex-col items-center min-w-[24px] flex-1",children:[n.jsxs("div",{className:"flex gap-0.5 items-end h-32 w-full justify-center",children:[n.jsx("div",{className:"w-2 bg-yellow-500 rounded-t transition-all",style:{height:`${v.checkouts/W*100}%`,minHeight:v.checkouts>0?"4px":"0"},title:`Checkouts: ${v.checkouts}`}),n.jsx("div",{className:"w-2 bg-green-500 rounded-t transition-all",style:{height:`${v.checkins/W*100}%`,minHeight:v.checkins>0?"4px":"0"},title:`Check-ins: ${v.checkins}`})]}),(T===0||T===Object.keys(X).length-1||(T+1)%7===0)&&n.jsx("p",{className:"text-[10px] text-gray-500 mt-2 rotate-45 origin-left whitespace-nowrap",children:ye(ge(D),"MMM d")})]},D))}),n.jsxs("div",{className:"flex items-center justify-center gap-6 mt-4 pt-4 border-t border-neofox-gray",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded"}),n.jsx("span",{className:"text-sm text-gray-400",children:"Checkouts"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-3 h-3 bg-green-500 rounded"}),n.jsx("span",{className:"text-sm text-gray-400",children:"Check-ins"})]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[n.jsx(Ee,{className:"w-5 h-5 text-neofox-yellow"}),"Most Used Equipment"]})}),n.jsx("div",{className:"card-body",children:Q.length>0?n.jsx("div",{className:"space-y-3",children:Q.map((D,v)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${v===0?"bg-yellow-500 text-black":v===1?"bg-gray-400 text-black":v===2?"bg-orange-600 text-white":"bg-neofox-gray text-gray-300"}`,children:v+1}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium truncate",children:D.name}),n.jsx("p",{className:"text-xs text-gray-500 font-mono",children:D.id})]}),n.jsx("span",{className:"text-neofox-yellow font-bold",children:D.count})]},D.id))}):n.jsx("p",{className:"text-gray-500 text-center py-4",children:"No data available"})})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[n.jsx(hr,{className:"w-5 h-5 text-neofox-yellow"}),"Most Active Borrowers"]})}),n.jsx("div",{className:"card-body",children:U.length>0?n.jsx("div",{className:"space-y-3",children:U.map((D,v)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${v===0?"bg-yellow-500 text-black":v===1?"bg-gray-400 text-black":v===2?"bg-orange-600 text-white":"bg-neofox-gray text-gray-300"}`,children:v+1}),n.jsx("div",{className:"flex-1 min-w-0",children:n.jsx("p",{className:"font-medium truncate",children:D.name})}),n.jsxs("span",{className:"text-neofox-yellow font-bold",children:[D.count," checkouts"]})]},D.name))}):n.jsx("p",{className:"text-gray-500 text-center py-4",children:"No data available"})})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"card-header",children:n.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[n.jsx($n,{className:"w-5 h-5 text-neofox-yellow"}),"Usage by Category"]})}),n.jsx("div",{className:"card-body",children:se.length>0?n.jsx("div",{className:"space-y-4",children:se.map(D=>{const v=Math.round(D.count/S.totalCheckouts*100);return n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsx("span",{className:"font-medium",children:D.category}),n.jsxs("span",{className:"text-gray-400",children:[D.count," (",v,"%)"]})]}),n.jsx("div",{className:"h-2 bg-neofox-darker rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-gradient-to-r from-neofox-yellow to-yellow-600 rounded-full transition-all",style:{width:`${v}%`}})})]},D.category)})}):n.jsx("p",{className:"text-gray-500 text-center py-4",children:"No data available"})})]})]})}function Rl({children:c}){const{user:h,loading:d}=as();return d?n.jsx("div",{className:"min-h-screen bg-neofox-darker flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-4xl font-bold text-neofox-yellow mb-4",children:"FOXY"}),n.jsx("div",{className:"w-48 h-1 bg-neofox-gray rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-neofox-yellow animate-[loading_1.5s_ease-in-out_infinite]",style:{width:"30%"}})})]})}):h?c:n.jsx(nr,{to:"/login",replace:!0})}function kl({children:c}){const{user:h,loading:d}=as();return d?null:h?n.jsx(nr,{to:"/",replace:!0}):c}function Ll(){return n.jsx(bi,{children:n.jsx(Wi,{children:n.jsx(go,{children:n.jsxs(Ni,{children:[n.jsx(qe,{path:"/login",element:n.jsx(kl,{children:n.jsx(wo,{})})}),n.jsx(qe,{path:"/request",element:n.jsx(Nl,{})}),n.jsxs(qe,{path:"/",element:n.jsx(Rl,{children:n.jsx(yo,{})}),children:[n.jsx(qe,{index:!0,element:n.jsx(Co,{})}),n.jsx(qe,{path:"assets",element:n.jsx(vo,{})}),n.jsx(qe,{path:"assets/add",element:n.jsx(Io,{})}),n.jsx(qe,{path:"assets/:id",element:n.jsx(So,{})}),n.jsx(qe,{path:"checkout",element:n.jsx(To,{})}),n.jsx(qe,{path:"checkout/receipt",element:n.jsx(Dl,{})}),n.jsx(qe,{path:"checkin",element:n.jsx(_o,{})}),n.jsx(qe,{path:"scanner",element:n.jsx(gl,{})}),n.jsx(qe,{path:"crew-checkout",element:n.jsx(pl,{})}),n.jsx(qe,{path:"kits",element:n.jsx(Sl,{})}),n.jsx(qe,{path:"calendar",element:n.jsx(Il,{})}),n.jsx(qe,{path:"requests",element:n.jsx(bl,{})}),n.jsx(qe,{path:"status",element:n.jsx(Ml,{})}),n.jsx(qe,{path:"audit-log",element:n.jsx(_l,{})}),n.jsx(qe,{path:"maintenance",element:n.jsx(Cl,{})}),n.jsx(qe,{path:"reports",element:n.jsx(Al,{})}),n.jsx(qe,{path:"analytics",element:n.jsx(Ol,{})}),n.jsx(qe,{path:"users",element:n.jsx(El,{})}),n.jsx(qe,{path:"settings",element:n.jsx(vl,{})})]}),n.jsx(qe,{path:"*",element:n.jsx(nr,{to:"/",replace:!0})})]})})})})}Jn.createRoot(document.getElementById("root")).render(n.jsx(Ci.StrictMode,{children:n.jsx(Ll,{})}));
